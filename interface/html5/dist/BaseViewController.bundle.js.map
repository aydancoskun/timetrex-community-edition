{"version":3,"sources":["webpack://timetrex/./interface/html5/global/widgets/paging/Paging2.js","webpack://timetrex/./interface/html5/views/BaseViewController.js"],"names":["$","fn","Paging2","options","pager_data","start","last","next","end","paging_selector","left_buttons_div","right_buttons_div","left_buttons_enable","right_buttons_enable","opts","extend","defaults","$this","this","getPagerData","setPagerData","value","css","empty","len","last_page_number","append","i","find","filter","parseInt","attr","current_page","prop","is_last_page","addClass","removeClass","is_first_page","hide","show","each","meta","data","text","i18n","_","click","trigger","change","proxy","page_number","jQuery","window","FormItemType","WidgetNamesDic","BaseViewController","TTBackboneView","real_this","sub_view_mode","edit_only_mode","can_cache_controller","permission_id","api","user_generic_data_api","all_columns","display_columns","default_display_columns","script_name","filter_data","temp_basic_filter_data","temp_adv_filter_data","sortData","select_layout","layout_changed","search_panel","grid","context_menu_name","navigation_label","context_menu_array","t_grid_header_array","column_selector","sort_by_selector","save_search_as_input","previous_saved_layout_selector","previous_saved_layout_div","need_select_layout_name","search_fields","basic_search_field_ui_dic","adv_search_field_ui_dic","edit_view_ui_dic","edit_view_ui_validation_field_dic","edit_view_form_item_dic","edit_view_error_ui_dic","edit_view","edit_view_tab","current_edit_record","refresh_id","navigation","is_mass_editing","is_viewing","is_edit","is_add","unique_columns","linked_fields","mass_edit_record_ids","edit_view_tabs","refresh_sub_view","parent_key","parent_value","parent_edit_record","total_display_span","paging_widget","paging_widget_2","viewId","init_options_complete","no_result_box","table_name_key","sub_log_view_controller","parent_view_controller","ui_id","is_changed","confirm_on_exit","edit_view_tpl","subMenuNavMap","trySetGridSizeWhenTabShow","copied_record_id","other_field_api","last_select_ids","saving_layout_in_layout_tab","need_switch_to_context_menu","show_search_tab","grid_total_width","show_warning_when_validation","pulse_time_dic","edit_view_close_icon","enable_validation","tab_model","grid_parent","super","Debug","Text","Global","setUINotready","initialize","TTPromise","add","wait","setTimeout","preInit","isSet","parent_view","getRandomNum","LocalCacheData","current_open_sub_controller","current_open_primary_controller","root_container","el","new_id","loadViewRequiredJSReady","paging_type","loadWidgetByName","initKeyboardEvent","init","postInit","resolve","unbind","bind","e","keyCode","isCollapsed","onSearch","blur","totalRows","grid_selected_id_array","getGridSelectIdArray","grid_selected_length","length","getLoginUserPreference","items_per_page","total_rows","getData","totalInfo","TopMenuManager","ribbon_view_controller","selected_sub_menu_id","setSelectMenu","setSelectSubMenu","name","context_btn","hasClass","target_type","hasOwnProperty","selector","RightClickMenuType","LISTVIEW","EDITVIEW","NORESULTBOX","ABSENCE_GRID","VIEW_ICON","ContextMenuIconName","view_html","items","getRightClickMenuItems","isEmptyObject","contextMenu","callback","key","onContextMenuClick","onContextMenu","children","eq","html_content","html","label","replaceRightClickLabel","id","icon","disabled","getContextIconByName","htmlDecode","replace","removeViewTab","ProgressBar","showOverlay","initOptions","getAllColumns","initLayout","getAllLayouts","getDefaultDisplayColumns","setSelectLayout","search","default_context_menu_model","sort_order","group","Icons","new_add","view","edit","mass_edit","delete_icon","delete_and_next","copy","copy_as_new","save","save_and_continue","save_and_next","save_and_copy","save_and_new","cancel","export_excel","groups","exclude","include","context_menu_model","getCustomContextMenuModel","menu","RibbonMenu","sub_menu_groups","getDefaultContextMenuModel","final_context_menu_model","x","indexOf","unshift","constructor","Array","include_icon_id","tmp_included_icon_ids","map","item","exclude_icon_id","RibbonSubMenuGroup","String","get","items_to_add","RibbonSubMenu","t","nav","RibbonSubMenuNavItem","sendErrorReport","setFocus","current_open_edit_only_controller","ribbon_menu","ribbon_menu_array","buildContextMenuModels","ribbon_menu_label_node","ribbon_menu_root_node","ribbon_menu_group_array","getSubMenuGroups","ribbon_menu_ui","currentShownContextMenuName","needRemovedContextMenuName","remove","len1","ribbon_menu_group","ribbon_sub_menu_array","getSubMenus","sub_menu_ui_nodes","ribbon_menu_group_ui","len2","y","ribbon_sub_menu","sub_menu_ui_node","push","RibbonSubMenuType","NAVIGATION","debounce","onSubMenuNavClick","calcDebounceWaitTimeBasedOnNetwork","default_tab_label_state","removeContentMenuByName","name_prefix","undefined","attributes","target","sub_menu","openRibbonNaviMenu","close","box","item_node","onReportMenuClick","RibbonSubMenuNavWidget","offset","left","width","bodyWidth","showNavItems","menu_name","clickProcessing","clickProcessingHandle","closeOverlay","onAddClick","onViewClick","onSaveClick","onSaveAndNextClick","onSaveAndContinue","onSaveAndNewClick","onSaveAndCopy","onEditClick","onMassEditClick","onDeleteClick","onDeleteAndNextClick","onCopyClick","onCopyAsNewClick","onCancelClick","onExportClick","key_name","onMapClick","onCustomContextClick","triggerAnalyticsContextMenuClick","state","is_mass_adding","current_doing_context_action","setCurrentEditViewState","openEditView","onResult","result","onAddResult","result_data","getResult","company","current_company","initEditView","TAlertManager","showConfirmAlert","delete_confirm_message","doDeleteClick","retval","slice","remove_ids","getDeleteSelectedRecordId","doDeleteAPICall","current_api","getCurrentAPI","onDeleteResult","isValid","getNextSelectItemId","current_grid_source","type","removeEditView","setDefaultMenu","setSourceData","onRightOrLeftArrowClickCallBack","onDeleteAndNextDone","onDeleteDone","getRecordDetails","valid","showErrorAlert","index","deleteRow","minus","ignoreWarning","record","uniformVariable","clearNavigationData","onSaveAndCopyResult","TTUUID","isUUID","zero_id","not_exist_id","setErrorMenu","setErrorTips","onSaveAndNewResult","saveInsideEditorData","doSaveAPICall","onSaveAndContinueResult","onSaveAndContinueDone","onSaveAndNextResult","onRightArrowClick","onSaveAndNextDone","records","widget","isChecked","getEnabled","isArray","user_id","commonRecord","clone","changed_fields","mass_records","common_record","getChangedFields","buildMassEditSaveRecord","buildMassAddRecord","onSaveResult","on_save_done_result","onSaveDone","removeDeletedRows","result1","linked_columns","isObject","isString","api_args","handleViewAPICallbackResult","apply","processAPICallbackResult","doViewClickResult","showAlert","clearCurrentSelectedRecord","noRefreshUI","record_id","getViewSelectedRecordId","isFalseOrNull","setCurrentSelectedRecord","getAPIFilters","doViewAPICall","current_selected_record","object","object_id","getCurrentSelectedRecord","handleEditAPICallbackResult","doEditClickResult","getEditSelectedRecordId","doEditAPICall","copyIds","modify_alert_message","flag","_continueDoCopy","onCopyResult","total","_continueDoCopyAsNew","copyAsNewResetIds","setEditMenu","setTabStatus","editor","setCurrentEditRecordData","selectedId","getCopyAsNewFilter","onCopyAsNewResult","job","job_item_id_col_name","status_id","job_item_widget","current_job_item_id","getValue","setCheckBox","args","setDefaultArgs","new_arg","job_id","filter_columns","getColumnFilter","job_item_api","getJobItem","task_result","setValue","setDefaultData","default_item_id","job_item_quick_search","job_id_field","job_item_id_field","manual_id","job_api","getJob","setJobItemValueWhenJobChanged","force_no_confirm","cancel_all","doNext","buildContextMenu","current_open_report_controller","setUIInitComplete","clicked_yes","reject","doNotValidate","setIsChanged","setMassEditingFieldsWhenFormChange","getField","validate","field","is_linked_field","is_checked","source","model","tab_labels","setTabLabels","ui","getEditViewTabIndex","editFieldResize","getTabModel","oldTab","prev_tab_name","getAttribute","substring","on_exit_callback","tab_name","sub_view_div","tab_bar","initialized","init_callback","initSubLogView","tab","subAuditValidate","subDocumentValidate","visible_tab_indexes","tab_index","parent","display_on_mass_edit","display_on_add","checkTabPermissions","sort","a","b","tabs","initReport","current_url","location","href","setURLToBrowser","hideErrorTips","hideErrorTip","removeEditViewErrorTip","selectVal","eSetProvince","clearErrorTips","validateResult","clearErrorStyle","key1","clearInterval","show_warning","details","getDetails","first_el","setErrorTipsError","setErrorTipsWarning","getCode","$current_doing_context_action","showWarningAlert","error_list","warning","found_in_current_tab","closest","document","documentElement","show_error","is","setErrorStyle","showErrorStatusOnTab","showEditViewError","isError","parentContainer","startPulse","tab_id","is_warning","cleanTimer","setInterval","result_array","error","error_string","convertValidationErrorToString","qtip","when","ready","events","event","preventDefault","content","style","classes","tip","corner","position","my","at","selected_menu_id","ribbon","initEditViewUI","tab0","setEditViewTabSize","did_clean_dic","column","setEnabled","view_id","edit_view_file_name","loadViewSource","setTabOVisibility","activate","onTabShow","triggerAnalyticsTabs","off","on","onTabIndexChange","contentContainer","initRightClickMenu","buildEditViewUI","setEditViewTabHeight","setURL","clearEditViewData","setEditViewWidgetsMode","setEditViewData","setOtherFields","setFocusToFirstInput","type_id","getOtherFieldTypeId","getOtherField","res_data","buildOtherFieldUI","resetLastWidgetStyle","permission","PermissionManager","getPermissionData","form_item_input","tab0_column1","TTextInput","input_div","addEditFieldToColumn","getOtherFieldReferenceField","insertBefore","setMassEditMode","res","canSetURL","getBaseURL","trackView","UNIT_TEST_MODE","start_time","focus","select","navigation_widget_div","navigation_div","left_click","right_click","initNavigationWidget","getRealImagePath","onCloseIconClick","triggerAnalyticsNavigationOther","widgets","firstOrLastRecord","widgetContainer","saveFormItemDiv","setResizeEvent","saveFormItemDivKey","hasKeyEvent","customLabelWidget","form_item","form_item_label_div","form_item_label","form_item_input_div","height","setValidationDic","onFormItemChange","onFormItemKeyUp","onFormItemKeyDown","getValidationField","tab_div","tab_column_div","tab_column_sub_div","setEditFieldSize","item_label_div_width","setPossibleDisplayColumns","buildDisplayColumnsByColumnModel","getColumnModel","buildDisplayColumns","next_select_item_id","setNavigationArrowsEnabled","triggerAnalyticsEditViewNavigation","isFunction","setEmptyValueAndShowLoading","initEditViewData","initTabData","switchToProperTab","getAllURLArgs","target_node","target_index","grid_current_page_items","needShowNavigation","getSourceData","setRowPerPage","default_args","convertLayoutFilterToAPIFilter","filter_sort","setUIWidgetFieldsToCurrentEditRecord","setNavigationArrowsStatus","SaveAndContinueBox","related_view_controller","columnsArr","force","setCountryValue","collectUIDataToCurrentEditRecord","setEditViewDataDone","left_arrow","right_arrow","onLeftArrowClick","selected_index","getSelectIndex","source_data","current_pager_data","cancel_callback","doLeftArrowClick","next_select_item","getItemByIndex","onADropDownSearch","doRightArrowClick","getRightArrowClickSelectedIndex","clearEditView","setParentContextMenuAfterSubViewClose","reSetURL","sub_document_view_controller","setAllURLArgs","buildArgDic","split","getSelectedRows","pId","addPermissionValidate","editPermissionValidate","editOwnerOrChildPermissionValidate","viewPermissionValidate","viewOwnerOrChildPermissionValidate","copyPermissionValidate","deletePermissionValidate","deleteOwnerOrChildPermissionValidate","copyAsNewPermissionValidate","saveValidate","saveAndContinueValidate","saveAndCopyValidate","saveAndNewValidate","doNotSetFocus","isLocalCacheExists","selectContextMenu","setTotalDisplaySpan","setDefaultMenuAddIcon","setDefaultMenuEditIcon","setDefaultMenuViewIcon","setDefaultMenuMassEditIcon","setDefaultMenuCopyIcon","setDefaultMenuDeleteIcon","setDefaultMenuDeleteAndNextIcon","setDefaultMenuSaveIcon","setDefaultMenuSaveAndNextIcon","setDefaultMenuSaveAndContinueIcon","setDefaultMenuSaveAndAddIcon","setDefaultMenuSaveAndCopyIcon","setDefaultMenuCopyAsNewIcon","login","setDefaultMenuLoginIcon","setDefaultMenuCancelIcon","import_icon","setDefaultMenuImportIcon","permission_wizard","setDefaultMenuPermissionWizardIcon","setDefaultMenuMapIcon","setDefaultMenuExportIcon","setCustomDefaultMenuIcon","setContextMenuGroupVisibility","setEditMenuSaveIcon","setEditMenuAddIcon","setEditMenuEditIcon","setEditMenuViewIcon","setEditMenuMassEditIcon","setEditMenuCopyIcon","setEditMenuDeleteIcon","setEditMenuDeleteAndNextIcon","setEditMenuSaveAndContinueIcon","setEditMenuSaveAndAddIcon","setEditMenuSaveAndNextIcon","setEditMenuSaveAndCopyIcon","setEditMenuCopyAndAddIcon","setEditMenuImportIcon","setEditMenuPermissionWizardIcon","setEditMenuLoginIcon","setEditMenuMapIcon","getProductEdition","selected_items","getSelectedItems","Arr","latitude","longitude","menus","topContainer","li_array","all_invisible","li_len","j","resize","tree_mode","searchPanelWidget","loadWidget","search_panel_w","prepend","SearchPanel","viewController","onSearchTabSelect","buildSearchFields","buildBasicSearchUI","buildAdvancedSearchUI","buildSearchAndLayoutUI","setCurrentViewPosition","current_view_div","saved_layout_li","e1","getLastSelectTabId","getSearchPanelFilter","setSearchPanelFilter","getLastSelectTabIndex","callBack","complete_count","option_result","option_info","initDropDownOption","option_name","field_name","onGetOptionResult","h_box","text_box","TText","array_name","getOptions","buildRecordArray","search_input","getLayoutsArray","default_layout_id","default_layout_name","onSaveNewLayout","layout_name","setGridHeaderStyle","sort_filter","getSearchPanelSortFilter","selected_display_columns","getSearchPanelDisplayColumns","getValidSearchFilter","setUserGenericData","clearViewLayoutCache","clearAwesomeboxLayoutCache","do_update","clearSearchPanel","setSelectGridData","script","is_default","a_layout_name","ALayoutCache","layout_dic","selectId","view_layout_cache","deleteUserGenericData","basic_search_div","column1","column2","column3","already_created_ui","search_field","getFormItemInput","onBuildBasicUIFinished","advSearchDiv","no_adv_ui","hideAdvSearchPanel","onBuildAdvUIFinished","input","form_type","show_search","AComboBox","api_class","allow_multiple_selection","show_search_inputs","set_any","addition_source_function","custom_first_label","search_panel_model","customSearchFilter","TComboBox","TTagInput","object_type_id","TDatePicker","TCheckbox","alert","layout_div","ADropDown","display_show_all","allow_drag_to_order","display_close_btn","display_column_settings","max_height","setColumns","sortable","set_empty","save_btn","update_btn","del_btn","onUpdateLayout","onDeleteLayout","layouts_array","exclude_column","grid_id","column_info_array","layout_data","buildSortSelectorUnSelectColumns","buildSortBySelectColumns","setPreviousSavedSearchSourcesAndValue","view_column_data","inArray","column_info","title","jqGrid","showGridBorders","grid_setup","getGridSetup","TTGrid","setGridColumnsWidth","setGridSize","sub_view_grid_autosize","onPaging","action","onPaging2","bindGridColumnEvents","default_filter_for_next_open_view","container","parents","container_selector","sub_grid_mode","onResizeGrid","onSelectRow","onGridSelectRow","onCellSelect","onSelectAll","onGridSelectAll","ondblClickRow","onGridDblClickRow","onRightClickRow","rowId","resetSelection","setSelection","need_break","column_header","TGridHeader","onColumnHeaderClick","sorting_rows","metaKey","ctrlKey","buildSortCondition","validFilterData","select_items","getSelectItems","getFromTabIndex","save_temp_filter","search_tab_select_index","getSelectTabIndex","target_ui_dic","isAdvTabVisible","autoChangeTab","basic_fields_len","search_input_1","setSelectTabIndex","setSearchFlag","onSetSearchFilterFinished","t_grid_header","cleanSortStyle","sort_array_len","sort_item","sortField","getFirstKeyFromObject","setSortStyle","reset","next_sort","found","set_default_menu","page_action","getFilterColumnsFromDisplayColumns","filter_items_per_page","filter_page","next_page","previous_page","getSubViewFilter","ids","removeNoResultCover","__createRowId","showGridOptionFields","formatGridData","showNoResultCover","grid_source_data","new_record","setRowData","setData","concat","highLightGridRowById","reSelectLastSelectItems","processResultData","setGridCellBackGround","autoOpenEditViewIfNecessary","searchDone","setGridHeight","setGridWidth","grid_select_id_array","edit_id_for_next_open_view","autoOpenEditOnlyViewIfNecessary","sm","IndexViewController","sid","openReport","default_edit_id_for_next_open_edit_view","is_in_use","top_border","bottom_border","header_size","tab_bar_label","tab_width","nav_width","wrap_div","total_tab_width","scrollLeft","setArrowStatus","label_wrap","scrollWidth","column_filter","enable_system_columns","_getFilterColumnsFromDisplayColumns","is_owner","is_child","in_use","first_name","last_name","n","current_select_layout_name","onGetUserGenericDataResult","results","compare","layout","setLayoutsArray","getUserGenericData","deleted","columns_result","columns_result_data","buildColumnArray","setUnselectedGridData","setHeight","sort_by_array","sort_by_select_columns","sort_by_unselect_columns","index1","content1","fina_array","new_content","apiDisplayColumnsArray","colModel","p_id","checkTopLevelPermission","getRecordFromGridById","selected_item","getSelectedItem","permission_name","ownerOrChildPermissionValidate","beforeLoadView","afterLoadView","subViewController","setSubLogViewFilter","initData","loadScript","firstColumn","LogViewController","loadSubView","show_new_btn","ifContextButtonExist","NoResultBox","is_new","scrollTop","place_holder","detach","last_date_stamp","available_balance_value","current_time_value","remaining_balance_value","summary_available_value","attachElement","getTimeUnit","available_balance","current_time","remaining_balance","projected_remaining_balance","getCurrentCurrencySymbol","available_dollar_balance","current_dollar_amount","remaining_dollar_balance","available_balance_info","delay","effect","projected_balance","detachElement","method","post_data","0","1","2","APIFileDownload","className","gridScrollDown","conversion_rate","iso_code","currency_id","my_currencies","getCurrency","async","base_currency_iso_code","round_decimal_places","decimal_places","is_base","removeTrailingZeros","lat","lng","getCurrentCompany","getLoginUser","company_api","country_arr","province_arr","country","APIGlobal","pre_login_data","map_geocode_url","province","query","city","url","registration_key","ajax","responseJSON","lon","L","LatLng","DocumentViewController","document_object_type_id","deleteImage","currently_collapsing_navigation_tree_element","openAwesomeBox","setNavigation","date","dates","resultArray","beginDate","strToDate","endDate","nextDate","getTime","format","Date","setDate","getDate","getDefaultHeightOffset","innerHeight","setup","static_height","verticalResize","getRecordCount","cell_height","edit_view_height","total_number_div_height","footer_height","red_border_height","loadView","accumulated_time","verify","timesheet_verification","secure_login","user_name","password","forgot_your_password","quick_punch","language","search_label","load_more","instance","router","removeCurrentView","template","current_open_view_id"],"mappings":"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","file":"BaseViewController.bundle.js?v=dab82a64c60d05f47375","sourcesContent":["( function( $ ) {\n\n\t$.fn.Paging2 = function( options ) {\n\t\tvar opts = $.extend( {}, $.fn.Paging2.defaults, options );\n\t\tvar $this = this;\n\t\tvar pager_data;\n\t\tvar start;\n\t\tvar last;\n\t\tvar next;\n\t\tvar end;\n\t\tvar paging_selector;\n\t\tvar left_buttons_div;\n\t\tvar right_buttons_div;\n\n\t\tvar left_buttons_enable;\n\t\tvar right_buttons_enable;\n\n\t\tthis.getPagerData = function() {\n\t\t\treturn pager_data;\n\t\t},\n\n\t\t\tthis.setPagerData = function( value ) {\n\n\t\t\t\tpager_data = value;\n\n\t\t\t\tif ( !pager_data ) {\n\t\t\t\t\t$( this.css( 'display', 'none' ) );\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\t$( this.css( 'display', 'block' ) );\n\t\t\t\t}\n\n\t\t\t\t$( paging_selector ).empty();\n\n\t\t\t\tvar len = pager_data.last_page_number;\n\n\t\t\t\tif ( len === -1 ) {\n\t\t\t\t\t$( paging_selector ).append( '<option value=\"' + 1 + '\">' + 1 + '</option>' );\n\t\t\t\t} else {\n\t\t\t\t\tfor ( var i = 1; i <= len; i++ ) {\n\t\t\t\t\t\t$( paging_selector ).append( '<option value=\"' + i + '\">' + i + '</option>' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$( $( paging_selector ).find( 'option' ) ).filter( function() {\n\t\t\t\t\tvar current_value = parseInt( $( this ).attr( 'value' ) );\n\n\t\t\t\t\treturn current_value === pager_data.current_page;\n\t\t\t\t} ).prop( 'selected', true ).prop( 'selected', true );\n\n\t\t\t\tif ( pager_data.is_last_page === true ) {\n\t\t\t\t\tright_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = false;\n\t\t\t\t} else {\n\t\t\t\t\tright_buttons_div.removeClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.removeClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = true;\n\t\t\t\t}\n\n\t\t\t\tif ( pager_data.is_first_page ) {\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = false;\n\n\t\t\t\t} else {\n\t\t\t\t\tleft_buttons_div.removeClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.removeClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = true;\n\t\t\t\t}\n\n\t\t\t\tif ( len === -1 || ( pager_data.is_first_page && pager_data.is_last_page ) ) {\n\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tleft_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tleft_buttons_enable = false;\n\t\t\t\t\tright_buttons_div.addClass( 'disabled' );\n\t\t\t\t\tright_buttons_div.addClass( 'disabled-image' );\n\t\t\t\t\tright_buttons_enable = false;\n\n\t\t\t\t\t$this.hide();\n\t\t\t\t} else {\n\t\t\t\t\t$this.show();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\tthis.each( function() {\n\n\t\t\tvar o = $.meta ? $.extend( {}, opts, $( this ).data() ) : opts;\n\n\t\t\tvar pages_label = $( this ).find( '.page-label-span' );\n\n\t\t\tpages_label.text( $.i18n._( 'Page' ) + ':' );\n\n\t\t\tleft_buttons_div = $( this ).find( '.left-buttons-div' );\n\t\t\tright_buttons_div = $( this ).find( '.right-buttons-div' );\n\n\t\t\tstart = $( this ).find( '.start' );\n\t\t\tlast = $( this ).find( '.last' );\n\t\t\tnext = $( this ).find( '.next' );\n\t\t\tend = $( this ).find( '.end' );\n\t\t\tpaging_selector = $( this ).find( '.paging-selector' );\n\n\t\t\tstart.text( $.i18n._( 'Start' ) );\n\t\t\tlast.text( $.i18n._( 'Previous' ) );\n\n\t\t\tnext.text( $.i18n._( 'Next' ) );\n\t\t\tend.text( $.i18n._( 'End' ) );\n\n\t\t\t$( this ).hide();\n\n\t\t\tstart.click( function() {\n\t\t\t\tif ( left_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['start'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tlast.click( function() {\n\t\t\t\tif ( left_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['last'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tnext.click( function() {\n\t\t\t\tif ( right_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['next'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tend.click( function() {\n\t\t\t\tif ( right_buttons_enable ) {\n\t\t\t\t\t$this.trigger( 'paging', ['end'] );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( paging_selector ).change( $.proxy( function() {\n\n\t\t\t\t$( paging_selector ).find( 'option:selected' ).each( function() {\n\t\t\t\t\tvar page_number = $( this ).attr( 'value' );\n\t\t\t\t\t$this.trigger( 'paging', ['go_to', page_number] );\n\t\t\t\t} );\n\n\t\t\t}, this ) );\n\n\t\t} );\n\n\t\treturn this;\n\n\t};\n\n\t$.fn.Paging2.defaults = {};\n\n} )\n( jQuery );","import { TTBackboneView } from '@/views/TTBackboneView';\nimport { TTAPI } from '@/services/TimeTrexClientAPI';\nimport { FormItemType, WidgetNamesDic } from '@/global/widgets/search_panel/FormItemType'; // TODO: duplicated in merged js files.\nimport '@/global/widgets/paging/Paging2.js';\n\nwindow.FormItemType = FormItemType; // TODO: Eventually refactor to import only where these are used.\nwindow.WidgetNamesDic = WidgetNamesDic; // TODO: Eventually refactor to import only where these are used.\n\n/* jshint ignore:start */\n\n//Don't check this file for now. Too many issues.\nexport class BaseViewController extends TTBackboneView {\n\tconstructor( options = {} ) {\n\t\t_.defaults( options, {\n\t\t\treal_this: null, //For super call in second level sub class\n\n\t\t\tsub_view_mode: false,\n\n\t\t\tedit_only_mode: false,\n\n\t\t\tcan_cache_controller: true, //if allow to cache current controller\n\n\t\t\tpermission_id: '',\n\t\t\tapi: null,\n\t\t\tuser_generic_data_api: null,\n\t\t\tall_columns: [],\n\t\t\tdisplay_columns: [],\n\t\t\tdefault_display_columns: [],\n\t\t\tscript_name: '',\n\t\t\tfilter_data: null, //current Filter data get from Search panel\n\t\t\ttemp_basic_filter_data: null,\n\t\t\ttemp_adv_filter_data: null,\n\t\t\tsortData: null, //Current Sort data get from search panel\n\t\t\tselect_layout: null,\n\t\t\tlayout_changed: false,\n\t\t\tsearch_panel: null,\n\t\t\tgrid: null,\n\t\t\tcontext_menu_name: '',\n\t\t\tnavigation_label: '',\n\t\t\tcontext_menu_array: [],\n\t\t\tt_grid_header_array: [],\n\n\t\t\t//Column Selector in search panel\n\t\t\tcolumn_selector: null,\n\n\t\t\tsort_by_selector: null,\n\n\t\t\tsave_search_as_input: null,\n\n\t\t\tprevious_saved_layout_selector: null,\n\n\t\t\tprevious_saved_layout_div: null,\n\n\t\t\tneed_select_layout_name: '', //Set this when save new layout to choose the new layout\n\n\t\t\tsearch_fields: null,\n\n\t\t\tbasic_search_field_ui_dic: {}, //Save AwesomeBox when they created\n\n\t\t\tadv_search_field_ui_dic: {}, //Save AwesomeBox when they created\n\n\t\t\tedit_view_ui_dic: {},\n\n\t\t\tedit_view_ui_validation_field_dic: {},\n\n\t\t\tedit_view_form_item_dic: {}, //Whole FormItem\n\n\t\t\tedit_view_error_ui_dic: {},\n\n\t\t\tedit_view: null,\n\n\t\t\tedit_view_tab: null,\n\n\t\t\tcurrent_edit_record: null, //Current edit record\n\n\t\t\trefresh_id: null, //Set this to refresh one record in grid view.\n\n\t\t\tnavigation: null, // Navigation widget in edit view\n\n\t\t\tis_mass_editing: false, //Set when mass edit\n\n\t\t\tis_viewing: false,\n\t\t\tis_edit: false,\n\t\t\tis_add: false,\n\n\t\t\tunique_columns: [], //Set when Mass edit, mark which fields need to be disable\n\n\t\t\tlinked_fields: [],\n\n\t\t\tmass_edit_record_ids: [], // Mass edit records\n\n\t\t\tedit_view_tabs: [],\n\n\t\t\trefresh_sub_view: false,\n\n\t\t\tparent_key: null, //default filter when search\n\n\t\t\tparent_value: null, //default filter when search\n\n\t\t\tparent_edit_record: null,\n\n\t\t\ttotal_display_span: null,\n\n\t\t\tpaging_widget: null,\n\n\t\t\tpaging_widget_2: null, //Put in the bottom of data grid\n\n\t\t\tpager_data: null,\n\n\t\t\tviewId: null,\n\n\t\t\tinit_options_complete: false,\n\n\t\t\tno_result_box: null, // No Result Found Black cover when no result in grid\n\n\t\t\ttable_name_key: null,\n\n\t\t\tsub_log_view_controller: null,\n\n\t\t\tparent_view_controller: null, //Add this to call parent_view_controll cancel action when cancel from sub view\n\n\t\t\tui_id: '',\n\n\t\t\tis_changed: false, // Track if modified any fields in edit view\n\n\t\t\tconfirm_on_exit: false, //confirm before leaving the edit view even if no changes have been made\n\n\t\t\tedit_view_tpl: '', //Edit view html name\n\n\t\t\tsubMenuNavMap: null,\n\n\t\t\ttrySetGridSizeWhenTabShow: false, // Set sub view grid size when tab show instead when tab select\n\n\t\t\tcopied_record_id: '', // When copy as new, save copied reord's id\n\n\t\t\tother_field_api: null,\n\n\t\t\tlast_select_ids: null,\n\n\t\t\tsaving_layout_in_layout_tab: false, //Mark if save layout from Saved and layout tab. if so, don't switch tabs when set values to search panel\n\n\t\t\tneed_switch_to_context_menu: false,\n\n\t\t\tshow_search_tab: true,\n\n\t\t\tgrid_total_width: null,\n\n\t\t\tshow_warning_when_validation: false,\n\n\t\t\tpulse_time_dic: false,\n\n\t\t\tedit_view_close_icon: null,\n\n\t\t\tenable_validation: true,\n\n\t\t\t// _required_files: null,\n\n\t\t\ttab_model: null, //Tab definitions and a map to their callbacks.\n\n\t\t\tgrid_parent: null\n\t\t} );\n\t\tsuper( options );\n\t}\n\n\t// getRequiredFiles() {\n\t// \t//override in child class\n\t// \treturn [];\n\t// }\n\n\t/**\n\t * When changing this function, you need to look for all occurences of this function because it was needed in several bases\n\t * BaseViewController, HomeViewController, BaseWizardController, QuickPunchBaseViewControler\n\t *\n\t * @returns {Array}\n\t */\n\t// filterRequiredFiles() {\n\t// \tDebug.Warn( 'Deprecated requirejs function. Replace usage immediately with webpack loaders.', 'BaseViewController.js', 'BaseViewController', 'filterRequiredFiles', 2 );\n\t//\n\t// \tvar retval = [];\n\t// \tvar required_files;\n\t//\n\t// \tif ( typeof this._required_files == 'object' ) {\n\t// \t\trequired_files = this._required_files;\n\t// \t} else {\n\t// \t\trequired_files = this.getRequiredFiles();\n\t// \t}\n\t//\n\t// \tif ( required_files && required_files[0] ) {\n\t// \t\tretval = required_files;\n\t// \t} else {\n\t// \t\tfor ( var edition_id in required_files ) {\n\t// \t\t\tif ( Global.getProductEdition() >= edition_id ) {\n\t// \t\t\t\tretval = retval.concat( required_files[edition_id] );\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tDebug.Arr( retval, 'RETVAL', 'BaseViewController.js', 'BaseViewController', 'filterRequiredFiles', 10 );\n\t// \treturn retval;\n\t// }\n\n\tpreInit() {\n\t\t//override in child class\n\t}\n\n\tinitialize( options ) {\n\t\tDebug.Text( 'INITIALIZE', 'BaseViewController.js', 'BaseViewController', 'initialize', 10 );\n\t\tGlobal.setUINotready();\n\n\t\tsuper.initialize( options );\n\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.add( 'BaseViewController', 'initialize' );\n\t\t//trigger readystate update\n\t\tTTPromise.wait();\n\n\t\tvar $this = this;\n\t\tthis.layout_changed = false;\n\t\t// var required_files = this.filterRequiredFiles();\n\n\t\t// __non_webpack_require__( required_files, function() { // This is to prevent conflict with the Webpack Node require calls.\n\t\t// Debug.Warn( 'Deprecated requirejs function. Replace usage immediately with webpack loaders.', 'BaseViewController.js', 'BaseViewController', 'initialize', 2 );\n\n\t\tsetTimeout(function() { // #2662 This setTimeout is essential in keeping the code flow the same as when this code block has a requirejs callback. Otherwise it causes issues in many areas like Audit logs going blank, as the subview postInit function is called before its set in afterLoadView().\n\n\t\t\t$this.preInit( options );\n\n\t\t\t$this.options = options;\n\t\t\tif ( $this.options && Global.isSet( $this.options.can_cache_controller ) ) {\n\t\t\t\t$this.can_cache_controller = $this.options.can_cache_controller;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.edit_only_mode ) ) {\n\t\t\t\t$this.edit_only_mode = $this.options.edit_only_mode;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.sub_view_mode ) ) {\n\t\t\t\t$this.sub_view_mode = $this.options.sub_view_mode;\n\t\t\t} else {\n\t\t\t\t$this.sub_view_mode = false;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.parent_view ) ) {\n\t\t\t\t$this.parent_view = $this.options.parent_view;\n\t\t\t}\n\n\t\t\tif ( $this.options && Global.isSet( $this.options.parent_view_controller ) ) {\n\t\t\t\t$this.parent_view_controller = $this.options.parent_view_controller;\n\t\t\t}\n\n\t\t\tif ( !$this.edit_only_mode ) {\n\n\t\t\t\tif ( $this.can_cache_controller ) {\n\t\t\t\t\tif ( !$this.sub_view_mode ) {\n\t\t\t\t\t\tLocalCacheData.current_open_primary_controller = $this;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tLocalCacheData.current_open_sub_controller = $this;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//Reset main container id so it won't duplicate when in sub view. Like Audit view.\n\t\t\t\tvar root_container = $( $this.el );\n\t\t\t\tvar new_id = root_container.attr( 'id' ) + '_' + Global.getRandomNum();\n\t\t\t\troot_container.attr( 'id', new_id );\n\t\t\t\t$this.el = '#' + new_id;\n\t\t\t\t$this.ui_id = new_id;\n\n\t\t\t\t$this.user_generic_data_api = TTAPI.APIUserGenericData;\n\n\t\t\t\t$this.total_display_span = $( $( $this.el ).find( '.total-number-span' )[0] );\n\n\t\t\t\t//$this shouldn't be displayed as it caused \"flashing\" of text and it wasn't translated either.\n\t\t\t\t//if ( $this.total_display_span ) {\n\t\t\t\t//$this.total_display_span.text( 'Displaying 0 - 0 of 0 total. Selected: 0' );\n\t\t\t\t//}\n\n\t\t\t\t//JS load Optimize\n\t\t\t\tif ( LocalCacheData.loadViewRequiredJSReady ) {\n\t\t\t\t\t//Init paging widget, next step, add widget to UI and bind events in setSelectLayout\n\t\t\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\t\t\t$this.paging_widget = Global.loadWidgetByName( WidgetNamesDic.PAGING );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.paging_widget = Global.loadWidgetByName( WidgetNamesDic.PAGING_2 );\n\t\t\t\t\t\t$this.paging_widget_2 = Global.loadWidgetByName( WidgetNamesDic.PAGING_2 );\n\t\t\t\t\t\t$this.paging_widget = $this.paging_widget.Paging2();\n\t\t\t\t\t\t$this.paging_widget_2 = $this.paging_widget_2.Paging2();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t$this.ui_id = Global.getRandomNum();\n\t\t\t}\n\n\t\t\t//init all dic or array, or it will extends last viewcontroller's value. Why?\n\t\t\t$this.sub_log_view_controller = null;\n\t\t\t$this.edit_view_ui_dic = {};\n\t\t\t$this.edit_view_ui_validation_field_dic = {};\n\t\t\t$this.basic_search_field_ui_dic = {};\n\t\t\t$this.adv_search_field_ui_dic = {};\n\t\t\t$this.edit_view_tabs = [];\n\t\t\t$this.context_menu_array = [];\n\n\t\t\t$this.other_field_api = TTAPI.APIOtherField;\n\n\t\t\t$this.initKeyboardEvent(); // register keyboard events if it's a main view\n\n\t\t\t$this.init( options );\n\t\t\t$this.postInit( options );\n\n\t\t\tTTPromise.resolve( 'BaseViewController', 'initialize' );\n\t\t\tTTPromise.resolve( 'init', 'init' );\n\t\t}, 1);\n\t}\n\n\tinit() {\n\t\t//override in child class\n\t}\n\n\tpostInit() {\n\t\t//override in child class\n\t}\n\n\tinitKeyboardEvent() {\n\n\t\tvar $this = this;\n\t\tif ( this.sub_view_mode || this.edit_only_mode ) {\n\t\t\treturn;\n\t\t}\n\n//\t\t$( this.el ).unbind( 'keydown' ).bind( 'keydown', function( e ) {\n//\n//\t\t\tif ( e.keyCode === 13 && !$this.search_panel.isCollapsed() ) {\n//\t\t\t\t$this.onSearch();\n//\t\t\t}\n//\n//\t\t} );\n\n\t\t$( this.el ).unbind( 'keyup' ).bind( 'keydown', function( e ) {\n\n\t\t\tif ( e.keyCode === 13 && $this.search_panel && !$this.search_panel.isCollapsed() ) {\n\n\t\t\t\t$this.onSearch();\n\t\t\t\t$( ':focus' ).blur(); //Make focus out of current view. pevent search too much when user keep click enter\n\t\t\t}\n\t\t} );\n\t}\n\n\t//Speical permission check for views, need override\n\tinitPermission() {\n\t}\n\n\t//Set this when setDefault menu\n\tsetTotalDisplaySpan() {\n\t\tif ( !this.total_display_span ) {\n\t\t\treturn;\n\t\t}\n\t\tvar totalRows;\n\t\tvar start;\n\t\tvar end;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = 0;\n\t\t//Uncaught TypeError: Cannot read property 'length' of undefined\n\t\tif ( grid_selected_id_array ) {\n\t\t\tgrid_selected_length = grid_selected_id_array.length;\n\t\t}\n\n\t\tvar items_pre_page = 100;\n\t\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\t\tvar items_per_page = parseInt( LocalCacheData.getLoginUserPreference().items_per_page );\n\t\t}\n\n\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\tif ( this.pager_data ) {\n\t\t\t\ttotalRows = this.pager_data.total_rows;\n\t\t\t\tstart = 1;\n\t\t\t\tend = this.grid.getData().length;\n\t\t\t} else {\n\t\t\t\ttotalRows = 0;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\t\t\t}\n\t\t} else {\n\t\t\tif ( this.pager_data ) {\n\t\t\t\ttotalRows = this.pager_data.total_rows;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\n\t\t\t\tif ( this.pager_data.last_page_number > 1 ) {\n\t\t\t\t\tif ( !this.pager_data.is_last_page ) {\n\n\t\t\t\t\t\tstart = ( this.pager_data.current_page - 1 ) * items_per_page + 1;\n\t\t\t\t\t\tend = start + items_per_page - 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = ( this.pager_data.current_page - 1 ) * items_per_page + 1;\n\t\t\t\t\t\tend = totalRows;\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tstart = 1;\n\t\t\t\t\tend = totalRows;\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttotalRows = 0;\n\t\t\t\tstart = 0;\n\t\t\t\tend = 0;\n\t\t\t}\n\t\t}\n\n\t\t//Counting pages can be disabled, in which case totalRows returns FALSE unless the user is on the last page.\n\t\tvar totalInfo = start + ' - ' + end;\n\t\tif ( totalRows !== false ) {\n\t\t\ttotalInfo = totalInfo + ' ' + $.i18n._( 'of' ) + ' ' + totalRows + ' ' + $.i18n._( 'total' ) + '.';\n\t\t}\n\n\t\tthis.total_display_span.text( $.i18n._( 'Displaying' ) + ' ' + totalInfo + ' [ ' + $.i18n._( 'Selected' ) + ': ' + grid_selected_length + ' ]' );\n\t}\n\n\t//For Browser back/forward to set correct menu\n\tsetSelectRibbonMenuIfNecessary() {\n\t\t//Try to fixed  Cannot read property 'setSelectMenu' of nulladd TopMenuManager.ribbon_view_controlle\n\n\t\tif ( TopMenuManager.ribbon_view_controller && TopMenuManager.selected_sub_menu_id !== this.viewId && !this.sub_view_mode && !this.edit_only_mode ) {\n\n\t\t\tTopMenuManager.ribbon_view_controller.setSelectMenu( this.viewId );\n\t\t\tTopMenuManager.ribbon_view_controller.setSelectSubMenu( this.viewId );\n\t\t}\n\t}\n\n\tgetContextIconByName( name ) {\n\t\tvar len = this.context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tif ( id === name ) {\n\t\t\t\tif ( context_btn.hasClass( 'disable-image' ) || context_btn.hasClass( 'invisible-image' ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t//Set right click menu for list view grid\n\tinitRightClickMenu( target_type ) {\n\t\t//Error: Object doesn't support property or method 'contextMenu' in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-132733 line 393\n\t\tif ( !$.hasOwnProperty( 'contextMenu' ) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar $this = this;\n\n\t\tvar selector = '';\n\n\t\tswitch ( target_type ) {\n\t\t\tcase RightClickMenuType.LISTVIEW:\n\t\t\t\tselector = '#gbox_' + this.ui_id + '_grid';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.EDITVIEW:\n\t\t\t\tselector = '#' + this.ui_id + '_edit_view_tab';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.NORESULTBOX:\n\t\t\t\tselector = '#' + this.ui_id + '_no_result_box';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.ABSENCE_GRID:\n\t\t\t\tselector = '#' + this.ui_id + '_absence_grid';\n\t\t\t\tbreak;\n\t\t\tcase RightClickMenuType.VIEW_ICON:\n\t\t\t\tselector = '#' + ContextMenuIconName.view_html;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tselector = '#gbox_' + this.ui_id + '_grid';\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif ( $( selector ).length == 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar items = this.getRightClickMenuItems();\n\n\t\tif ( !items || $.isEmptyObject( items ) ) {\n\t\t\treturn;\n\t\t}\n\t\t$.contextMenu( 'destroy', selector );\n\t\t$.contextMenu( {\n\t\t\tselector: selector,\n\t\t\tcallback: function( key, options ) {\n\t\t\t\t$this.onContextMenuClick( null, key );\n\t\t\t},\n\n\t\t\tonContextMenu: function() {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\titems: items\n\t\t} );\n\t}\n\n\tgetRightClickMenuItems() {\n\t\tvar $this = this;\n\n\t\tvar items = {};\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\n\t\t\t//Don't add sub menu context icon to right click\n\t\t\tif ( context_btn.children().eq( 0 ).hasClass( 'ribbon-sub-menu-nav-icon' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif ( context_btn.hasClass( 'invisible-image' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar html_content = $( context_btn.html() );\n\t\t\tvar label = this.replaceRightClickLabel( html_content );\n\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\titems[id] = {\n\t\t\t\tname: label,\n\t\t\t\ticon: id,\n\t\t\t\tdisabled: function( key ) {\n\t\t\t\t\treturn $this.getContextIconByName( key );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn items;\n\t}\n\n\treplaceRightClickLabel( html_content ) {\n\t\tvar label = html_content.children().eq( 1 ).html();\n\n\t\tlabel = Global.htmlDecode( label.replace( '<br>', ' ' ) );\n\n\t\treturn label;\n\t}\n\n\t//Don't initOptions if edit_only_mode. Do it in sub views\n\tinitData() {\n\t\tvar $this = this;\n\n\t\t//Work around to init sub view after tab is shown.\n\t\tGlobal.removeViewTab( this.viewId );\n\t\tProgressBar.showOverlay();\n\t\tif ( !$this.edit_only_mode ) {\n\t\t\t$this.initOptions();\n\t\t\t$this.getAllColumns( function() {\n\t\t\t\t$this.initLayout();\n\t\t\t} );\n\t\t}\n\t}\n\n\tinitLayout() {\n\t\tvar $this = this;\n\t\t$this.getAllLayouts( function() {\n\t\t\t$this.getDefaultDisplayColumns( function() {\n\t\t\t\t$this.setSelectLayout();\n\t\t\t\t//$this.setGridColumnsWidth(); //This is done in setSelectLayout() and searchDone(), so no point in doing it multiple times.\n\t\t\t\t$this.search();\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// edit_only_mode call this when open edit view. Not in initData\n\tinitOptions() {\n\t}\n\n\tgetDefaultContextMenuModel() {\n\n\t\tvar default_context_menu_model = {\n\t\t\t'groups': {\n\t\t\t\t'editor': {\n\t\t\t\t\tlabel: $.i18n._( 'Editor' ),\n\t\t\t\t\tid: 'editor',\n\t\t\t\t\tsort_order: 1000\n\t\t\t\t},\n\t\t\t\t'navigation': {\n\t\t\t\t\tlabel: $.i18n._( 'Navigation' ),\n\t\t\t\t\tid: 'navigation',\n\t\t\t\t\tsort_order: 8000\n\t\t\t\t},\n\t\t\t\t'other': {\n\t\t\t\t\tlabel: $.i18n._( 'Other' ),\n\t\t\t\t\tid: 'other',\n\t\t\t\t\tsort_order: 9000\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t'icons': {}\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.add] = {\n\t\t\tlabel: $.i18n._( 'New' ),\n\t\t\tid: ContextMenuIconName.add,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.new_add,\n\t\t\tsort_order: 1000\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.view] = {\n\t\t\tlabel: $.i18n._( 'View' ),\n\t\t\tid: ContextMenuIconName.view,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.view,\n\t\t\tsort_order: 1010\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.edit] = {\n\t\t\tlabel: $.i18n._( 'Edit' ),\n\t\t\tid: ContextMenuIconName.edit,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.edit,\n\t\t\tsort_order: 1020\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.mass_edit] = {\n\t\t\tlabel: $.i18n._( 'Mass<br>Edit' ),\n\t\t\tid: ContextMenuIconName.mass_edit,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.mass_edit,\n\t\t\tsort_order: 1030\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.delete_icon] = {\n\t\t\tlabel: $.i18n._( 'Delete' ),\n\t\t\tid: ContextMenuIconName.delete_icon,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.delete_icon,\n\t\t\tsort_order: 1040\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.delete_and_next] = {\n\t\t\tlabel: $.i18n._( 'Delete<br>& Next' ),\n\t\t\tid: ContextMenuIconName.delete_and_next,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.delete_and_next,\n\t\t\tsort_order: 1050\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.copy] = {\n\t\t\tlabel: $.i18n._( 'Copy' ),\n\t\t\tid: ContextMenuIconName.copy,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.copy_as_new,\n\t\t\tsort_order: 1060\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.copy_as_new] = {\n\t\t\tlabel: $.i18n._( 'Copy<br>as New' ),\n\t\t\tid: ContextMenuIconName.copy_as_new,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.copy,\n\t\t\tsort_order: 1070\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.save] = {\n\t\t\tlabel: $.i18n._( 'Save' ),\n\t\t\tid: ContextMenuIconName.save,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.save,\n\t\t\tsort_order: 1080\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.save_and_continue] = {\n\t\t\tlabel: $.i18n._( 'Save<br>& Continue' ),\n\t\t\tid: ContextMenuIconName.save_and_continue,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.save_and_continue,\n\t\t\tsort_order: 1090\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.save_and_next] = {\n\t\t\tlabel: $.i18n._( 'Save<br>& Next' ),\n\t\t\tid: ContextMenuIconName.save_and_next,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.save_and_next,\n\t\t\tsort_order: 1100\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.save_and_copy] = {\n\t\t\tlabel: $.i18n._( 'Save<br>& Copy' ),\n\t\t\tid: ContextMenuIconName.save_and_copy,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.save_and_copy,\n\t\t\tsort_order: 1110\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.save_and_new] = {\n\t\t\tlabel: $.i18n._( 'Save<br>& New' ),\n\t\t\tid: ContextMenuIconName.save_and_new,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.save_and_new,\n\t\t\tsort_order: 1120\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.cancel] = {\n\t\t\tlabel: $.i18n._( 'Cancel' ),\n\t\t\tid: ContextMenuIconName.cancel,\n\t\t\tgroup: 'editor',\n\t\t\ticon: Icons.cancel,\n\t\t\tsort_order: 1130\n\t\t};\n\n\t\tdefault_context_menu_model['icons'][ContextMenuIconName.export_excel] = {\n\t\t\tlabel: $.i18n._( 'Export' ),\n\t\t\tid: ContextMenuIconName.export_excel,\n\t\t\tgroup: 'other',\n\t\t\ticon: Icons.export_excel,\n\t\t\tsort_order: 9000\n\t\t};\n\n\t\treturn default_context_menu_model;\n\t}\n\n\t// Overriden by ViewControllers with custom context menus.\n\tgetCustomContextMenuModel() {\n\t\tvar context_menu_model = {\n\t\t\tgroups: {},\n\t\t\texclude: [],\n\t\t\tinclude: ['default']\n\t\t};\n\n\t\treturn context_menu_model;\n\t}\n\n\tbuildContextMenuModels() {\n\t\t// Note: Currently icons might still be hidden by the permissions code, due to the 'invisible-image' class, especially with this.edit_only_mode. See BaseViewController.setDefaultMenuAddIcon() as an example.\n\n\t\tvar context_menu_model = this.getCustomContextMenuModel();\n\n\t\tif ( context_menu_model && ( context_menu_model.include || context_menu_model.exclude ) ) {\n\t\t\t//Context Menu\n\t\t\tvar menu = new RibbonMenu( {\n\t\t\t\tlabel: this.context_menu_name,\n\t\t\t\tid: this.viewId + 'ContextMenu',\n\t\t\t\tsub_menu_groups: []\n\t\t\t} );\n\n\t\t\tvar default_context_menu_model = this.getDefaultContextMenuModel();\n\n\t\t\tvar final_context_menu_model = { 'icons': {}, 'groups': {} };\n\n\t\t\tif ( !context_menu_model['groups'] ) {\n\t\t\t\tcontext_menu_model['groups'] = {};\n\t\t\t}\n\n\t\t\t//Default to including all default icons.\n\t\t\tif ( !context_menu_model['include'] ) {\n\t\t\t\tcontext_menu_model['include'] = ['default'];\n\t\t\t}\n\n\t\t\t//If we don't include default, assume we want to include all default icons.\n\t\t\tif ( context_menu_model['include'].indexOf( 'default' ) === -1 ) {\n\t\t\t\tcontext_menu_model['include'].unshift( 'default' ); // Add to front, so custom icons can override a default icon id.\n\t\t\t}\n\n\t\t\t//Assign default groups.\n\t\t\tfor ( var x in default_context_menu_model['groups'] ) {\n\t\t\t\tdefault_context_menu_model['groups'][x]['ribbon_menu'] = menu;\n\t\t\t\tdefault_context_menu_model['groups'][x]['sub_menus'] = [];\n\n\t\t\t\tfinal_context_menu_model['groups'][x] = default_context_menu_model['groups'][x];\n\t\t\t}\n\n\t\t\tfor ( var x in context_menu_model['groups'] ) {\n\t\t\t\tcontext_menu_model['groups'][x]['ribbon_menu'] = menu;\n\t\t\t\tcontext_menu_model['groups'][x]['sub_menus'] = [];\n\n\t\t\t\tfinal_context_menu_model['groups'][x] = context_menu_model['groups'][x];\n\t\t\t}\n\n\t\t\t//Filter groups/icons\n\t\t\tif ( context_menu_model.hasOwnProperty( 'include' ) ) {\n\t\t\t\tif ( context_menu_model.include.constructor !== Array ) {\n\t\t\t\t\tcontext_menu_model.include = Array( context_menu_model.include );\n\t\t\t\t}\n\n\t\t\t\tfor ( var i in context_menu_model.include ) {\n\t\t\t\t\tif ( context_menu_model.include[i] == 'default' ) {\n\t\t\t\t\t\tDebug.Text( 'Including All Default Icons...', 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\n\t\t\t\t\t\tfor ( var x in default_context_menu_model['icons'] ) {\n\t\t\t\t\t\t\tfinal_context_menu_model['icons'][x] = default_context_menu_model['icons'][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar include_icon_id = context_menu_model.include[i];\n\t\t\t\t\t\tif ( typeof include_icon_id !== 'object' && default_context_menu_model['icons'][include_icon_id] ) {\n\t\t\t\t\t\t\tfinal_context_menu_model['icons'][include_icon_id] = default_context_menu_model['icons'][include_icon_id];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfinal_context_menu_model['icons'][context_menu_model.include[i]['id']] = context_menu_model.include[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// #2644 Include array is a mix of icon id strings and objects, this function flattens it to an array of strings for id comparision.\n\t\t\tfunction flattenMixedIdObjectArray( array ) {\n\t\t\t\treturn array.map( function( item ) {\n\t\t\t\t\treturn item.id || item;\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tvar tmp_included_icon_ids = flattenMixedIdObjectArray( context_menu_model.include );\n\n\t\t\t//Must go after include, so they can include a few icons, then exclude all.\n\t\t\tif ( context_menu_model.hasOwnProperty( 'exclude' ) ) {\n\t\t\t\tif ( context_menu_model.exclude.constructor !== Array ) {\n\t\t\t\t\tcontext_menu_model.exclude = Array( context_menu_model.exclude );\n\t\t\t\t}\n\n\t\t\t\tfor ( var i in context_menu_model.exclude ) {\n\t\t\t\t\tif ( context_menu_model.exclude[i] == 'default' ) {\n\t\t\t\t\t\tDebug.Text( 'Excluding All Default Icons...', 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\n\t\t\t\t\t\tfor ( var x in default_context_menu_model['icons'] ) {\n\t\t\t\t\t\t\tif ( tmp_included_icon_ids.indexOf( x ) === -1 ) { //Make sure we don't exclude one that is included. Compare against flattened/extracted include array, otherwise types do not match and all default icons are removed regardless if they exist in include.\n\t\t\t\t\t\t\t\tif ( final_context_menu_model['icons'][x] ) {\n\t\t\t\t\t\t\t\t\tdelete final_context_menu_model['icons'][x];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar exclude_icon_id = context_menu_model.exclude[i];\n\t\t\t\t\t\tif ( final_context_menu_model['icons'][exclude_icon_id] ) {\n\t\t\t\t\t\t\tdelete final_context_menu_model['icons'][exclude_icon_id];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Build Menu\n\t\t\tvar groups = {};\n\t\t\tfor ( var x in final_context_menu_model['groups'] ) {\n\t\t\t\tgroups[x] = new RibbonSubMenuGroup( final_context_menu_model['groups'][x] );\n\t\t\t\tDebug.Text( 'Creating Ribbon Menu Group: ' + final_context_menu_model['groups'][x]['label'], 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\t\t\t}\n\n\t\t\tfor ( var x in final_context_menu_model['icons'] ) {\n\n\t\t\t\t//Replace group string with object.\n\t\t\t\tif ( final_context_menu_model['icons'][x] && final_context_menu_model['icons'][x]['group'] ) {\n\t\t\t\t\tif ( final_context_menu_model['icons'][x]['group'].constructor === String ) {\n\t\t\t\t\t\tfinal_context_menu_model['icons'][x]['group'] = groups[final_context_menu_model['icons'][x]['group']];\n\t\t\t\t\t} else if ( typeof final_context_menu_model['icons'][x]['group'] === 'object' ) {\n\t\t\t\t\t\t//The 2nd time the edit view is opened, icons manually passed in through 'include' already have the groups converted to objects, but the icons don't appear until we re-assign the group object again.\n\t\t\t\t\t\tfinal_context_menu_model['icons'][x]['group'] = groups[final_context_menu_model['icons'][x]['group'].get( 'id' )];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( final_context_menu_model['icons'][x].hasOwnProperty( 'permission_result' ) == false ) {\n\t\t\t\t\tfinal_context_menu_model['icons'][x]['permission_result'] = true;\n\t\t\t\t}\n\t\t\t\tif ( !final_context_menu_model['icons'][x].hasOwnProperty( 'permission' ) == false ) {\n\t\t\t\t\tfinal_context_menu_model['icons'][x]['permission'] = null;\n\t\t\t\t}\n\n\t\t\t\tDebug.Text( 'Creating Ribbon Menu Icon: ' + final_context_menu_model['icons'][x]['label'], 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\n\t\t\t\t// TODO: This not an ideal way to do it, but not worth changing until a bigger refactor of the context menu is done at a later date.\n\t\t\t\tif ( final_context_menu_model['icons'][x].items && final_context_menu_model['icons'][x].items.length > 0 ) {\n\t\t\t\t\t// We use item to store the pre conversion and post conversion data. Therefore we must re-assign to a temp var, and reset.\n\t\t\t\t\tvar items_to_add = final_context_menu_model['icons'][x].items;\n\n\t\t\t\t\t// Reset the items attribute to an empty array, ready for RibbonSubMenuNavItem to use later on.\n\t\t\t\t\tfinal_context_menu_model['icons'][x].items = [];\n\n\t\t\t\t\tvar icon = new RibbonSubMenu( final_context_menu_model['icons'][x] );\n\n\t\t\t\t\tfor ( var t = 0; t < items_to_add.length; t++ ) {\n\t\t\t\t\t\tvar item = items_to_add[t];\n\n\t\t\t\t\t\t// This tells RibbonSubMenuNavItem which main icon this nav icon must be attached to.\n\t\t\t\t\t\titem.nav = icon;\n\n\t\t\t\t\t\t// This adds the converted nav item to the main icon's item attribute.\n\t\t\t\t\t\tnew RibbonSubMenuNavItem( item );\n\t\t\t\t\t\tDebug.Text( 'Added Ribbon Menu Nav Icon: ' + item.label + ' to ' + icon.get( 'label' ), 'BaseViewController.js', 'BaseViewController', 'buildContextMenuModels', 10 );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnew RibbonSubMenu( final_context_menu_model['icons'][x] );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [menu];\n\t\t} else {\n\t\t\t//Legacy fallback when no context menu model is defined.\n\t\t\tGlobal.sendErrorReport( 'ContextMenuModel error. No valid contextmenu model defined.' );\n\t\t}\n\t}\n\n\tbuildContextMenu( setFocus ) {\n\t\tif ( this.current_edit_record && this.edit_only_mode == true && LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.viewId != LocalCacheData.current_open_edit_only_controller.viewId ) { // #2542 - prevent early menu setup for views that have not been loaded into memory yet.\n\t\t\treturn null;\n\t\t}\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( setFocus ) ) {\n\t\t\tsetFocus = true;\n\t\t}\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tLocalCacheData.current_open_sub_controller = null; //Clean sub controller if current view is a main view\n\t\t}\n\n\t\tthis.context_menu_array = [];\n\n\t\tvar ribbon_menu_array = this.buildContextMenuModels();\n\n\t\tvar ribbon_menu_label_node = $( '.ribbonTabLabel' );\n\t\tvar ribbon_menu_root_node = $( '.ribbon' );\n\n\t\tvar len = ribbon_menu_array.length;\n\n\t\tvar ribbon_menu;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tribbon_menu = ribbon_menu_array[i];\n\t\t\tvar ribbon_menu_group_array = ribbon_menu.getSubMenuGroups();\n\n\t\t\tvar ribbon_menu_ui = $( '<div id=\"' + ribbon_menu.get( 'id' ) + '\" class=\"context-ribbon-menu ribbon-tab-out-side ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide\"><div class=\"context-ribbon-tab\"><div class=\"ribbon-sub-menu\"></div></div></div>' );\n\n\t\t\t//make sure only one context menu shown at a time\n\t\t\tif ( Global.isSet( LocalCacheData.currentShownContextMenuName ) && LocalCacheData.currentShownContextMenuName !== ribbon_menu.get( 'id' ) ) {\n\t\t\t\tvar needRemovedContextMenuName = LocalCacheData.currentShownContextMenuName;\n\t\t\t\tthis.context_menu_array = [];\n\n\t\t\t}\n\t\t\t//#2353 - prevent lost context menu for accrual balances\n\t\t\t// else if ( Global.isSet( LocalCacheData.currentShownContextMenuName ) && LocalCacheData.currentShownContextMenuName === ribbon_menu.get( 'id' ) ) {\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\t$( '.context-ribbon-menu' ).remove(); //prevent dupes\n\n\t\t\tthis.subMenuNavMap = {};\n\n\t\t\tLocalCacheData.currentShownContextMenuName = ribbon_menu.get( 'id' );\n\t\t\tvar len1 = ribbon_menu_group_array.length;\n\t\t\tfor ( var x = 0; x < len1; x++ ) {\n\n\t\t\t\tvar ribbon_menu_group = ribbon_menu_group_array[x];\n\t\t\t\tvar ribbon_sub_menu_array = ribbon_menu_group.getSubMenus();\n\t\t\t\tvar sub_menu_ui_nodes = $( '<ul></ul>' );\n\t\t\t\tvar ribbon_menu_group_ui = $( '<div class=\"menu top-ribbon-menu\"></div>' );\n\n\t\t\t\tvar len2 = ribbon_sub_menu_array.length;\n\t\t\t\tfor ( var y = 0; y < len2; y++ ) {\n\n\t\t\t\t\tvar ribbon_sub_menu = ribbon_sub_menu_array[y];\n\n//\t\t\t\t\tvar sub_menu_ui_node = $( '<li ><div class=\"ribbon-sub-menu-icon\" id=\"' + ribbon_sub_menu.get( 'id' ) + '\"><img src=\"' + ribbon_sub_menu.get( 'icon' ) + '\" ><span class=\"ribbon-label\">' + ribbon_sub_menu.get( 'label' ) + '</span></div></li>' );\n\t\t\t\t\tif ( ribbon_sub_menu.get( 'selected' ) ) {\n\n\t\t\t\t\t\tvar sub_menu_ui_node = $( '<li ><div class=\"ribbon-sub-menu-icon selected-menu\" id=\"' + ribbon_sub_menu.get( 'id' ) + '\"><img src=\"' + ribbon_sub_menu.get( 'icon' ) + '\" ><span class=\"ribbon-label\">' + ribbon_sub_menu.get( 'label' ) + '</span></div></li>' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsub_menu_ui_node = $( '<li ><div class=\"ribbon-sub-menu-icon\" id=\"' + ribbon_sub_menu.get( 'id' ) + '\"><img src=\"' + ribbon_sub_menu.get( 'icon' ) + '\" ><span class=\"ribbon-label\">' + ribbon_sub_menu.get( 'label' ) + '</span></div></li>' );\n\t\t\t\t\t}\n\n\t\t\t\t\tsub_menu_ui_node.addClass( 'disable-image' );\n\t\t\t\t\tthis.context_menu_array.push( sub_menu_ui_node );\n\t\t\t\t\tif ( ribbon_sub_menu.get( 'type' ) === RibbonSubMenuType.NAVIGATION ) {\n\t\t\t\t\t\tsub_menu_ui_node.children().eq( 0 ).addClass( 'ribbon-sub-menu-nav-icon' );\n\t\t\t\t\t\t$this.subMenuNavMap[ribbon_sub_menu.get( 'id' )] = ribbon_sub_menu;\n\n\t\t\t\t\t\tsub_menu_ui_node.click( Global.debounce( function SubMenuNavClickEvent( e ) {\n\t\t\t\t\t\t\tvar id = $( this ).find( '.ribbon-sub-menu-icon' ).attr( 'id' );\n\t\t\t\t\t\t\t$this.onSubMenuNavClick( this, id );\n\t\t\t\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//Debounce to help prevent double clicks.\n\t\t\t\t\t\tsub_menu_ui_node.click( Global.debounce( function ContextMenuClickEvent( e ) {\n\t\t\t\t\t\t\tvar id = $( this ).find( '.ribbon-sub-menu-icon' ).attr( 'id' );\n\t\t\t\t\t\t\t$this.onContextMenuClick( this );\n\t\t\t\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork(), true ) ); //333 * 1.5 = 500ms. Debounce on at least 1.5x the round-trip ping time. Because a user on a really slow connection could click Save 1s apart and the packets could arrive close to each other and cause duplicate request errors still.\n\t\t\t\t\t}\n\n\t\t\t\t\tsub_menu_ui_nodes.append( sub_menu_ui_node );\n\t\t\t\t}\n\n\t\t\t\tif ( sub_menu_ui_nodes.children().length > 0 ) {\n\t\t\t\t\tribbon_menu_group_ui.append( sub_menu_ui_nodes );\n\t\t\t\t\tribbon_menu_group_ui.append( $( '<div class=\"menu-bottom\"><span>' + ribbon_menu_group.get( 'label' ) + '</span></div>' ) );\n\t\t\t\t\tribbon_menu_ui.find( '.ribbon-sub-menu' ).append( ribbon_menu_group_ui );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t$( '.ribbonTabLabel .context-menu' ).remove();\n\t\t\t//When added a new context menu tab, make it ui-state-active by default if setFocus=TRUE, since its going to be active soon anyways and this prevents flashing.\n\t\t\tvar default_tab_label_state = 'default';\n\t\t\tif ( setFocus ) {\n\t\t\t\tdefault_tab_label_state = 'active';\n\t\t\t}\n\n\t\t\tribbon_menu_label_node.append( $( '<li class=\"context-menu ui-state-' + default_tab_label_state + ' ui-corner-top\"><a ref=\"' + ribbon_menu.get( 'id' ) + '\" href=\"#' + ribbon_menu.get( 'id' ) + '\">' + ribbon_menu.get( 'label' ) + '</a></li>' ) );\n\t\t\tribbon_menu_root_node.append( ribbon_menu_ui );\n\t\t}\n\n\t\tif ( needRemovedContextMenuName ) {\n\t\t\tthis.removeContentMenuByName( needRemovedContextMenuName );\n\t\t}\n\n\t\tif ( setFocus ) {\n\t\t\tthis.need_switch_to_context_menu = true;\n\n\t\t\t// //#2530 - stop the flashing!!!\n\t\t\t// if ( this.edit_only_mode == true ) {\n\t\t\t// \tthis.setEditMenu(); //prevents some flashing of edit-only view context menus\n\t\t\t// } else {\n\t\t\t// \t//Perform any context menu permission checks and set the default menu icons based on the fact that *no* records are selected in the grid yet.\n\t\t\t// \t// As long as this occurs before selectContextMenu() it helps prevent \"flashing\" of all icons down to just the icons they have permissions to see.\n\t\t\t// \t// Specifically when logged in as a regular employee and going to Payroll -> Pay Stubs, it would show all icons an Administrator would see, then hide most of them.\n\t\t\t// \tthis.setDefaultMenu();\n\t\t\t//\n\t\t\t// \t//Don't select context menu until search complete\n\t\t\t// \t//this.selectContextMenu(); //Moved this is now done in search() when this.need_switch_to_context_menu = true;\n\t\t\t// }\n\t\t}\n\t}\n\n\tgetContextMenuGroupByName( menu, name, name_prefix ) {\n\t\tvar group;\n\t\tif ( name_prefix == undefined ) {\n\t\t\tname_prefix = this.viewId;\n\t\t}\n\n\t\tfor ( var i = 0; i < menu.attributes.sub_menu_groups.length; i++ ) {\n\t\t\tif ( menu.attributes.sub_menu_groups[i].id == name_prefix + name ) {\n\t\t\t\tgroup = menu.attributes.sub_menu_groups[i];\n\t\t\t}\n\t\t}\n\n\t\treturn group;\n\t}\n\n\tonSubMenuNavClick( target, id ) {\n\t\tvar $this = this;\n\t\tvar sub_menu = this.subMenuNavMap[id];\n\n\t\tif ( LocalCacheData.openRibbonNaviMenu ) {\n\n\t\t\tif ( LocalCacheData.openRibbonNaviMenu.attr( 'id' ) === 'sub_nav' + id ) {\n\t\t\t\tLocalCacheData.openRibbonNaviMenu.close();\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tLocalCacheData.openRibbonNaviMenu.close();\n\t\t\t}\n\n\t\t}\n\n\t\tshowNavItems();\n\n\t\tfunction showNavItems() {\n\t\t\tvar items = sub_menu.get( 'items' );\n\t\t\tvar box = $( '<ul id=\\'sub_nav' + id + '\\' class=\\'ribbon-sub-menu-nav\\'> </ul>' );\n\n\t\t\tfor ( var i = 0; i < items.length; i++ ) {\n\t\t\t\tvar item = items[i];\n\t\t\t\tvar item_node = $( '<li class=\\'ribbon-sub-menu-nav-item\\' id=\\'' + item.get( 'id' ) + '\\'><span class=\\'label\\'>' + item.get( 'label' ) + '</span></li>' );\n\t\t\t\tbox.append( item_node );\n\n\t\t\t\titem_node.unbind( 'click' ).click( function() {\n\t\t\t\t\tvar id = $( this ).attr( 'id' );\n\t\t\t\t\t$this.onReportMenuClick( id );\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tbox = box.RibbonSubMenuNavWidget();\n\n\t\t\tLocalCacheData.openRibbonNaviMenu = box;\n\n\t\t\t$( target ).append( box );\n\n\t\t\tif ( box.offset().left + box.width() > Global.bodyWidth() ) {\n\t\t\t\tbox.css( 'left', Global.bodyWidth() - box.width() - 10 );\n\t\t\t}\n\t\t}\n\t}\n\n\tonReportMenuClick( id ) {\n\t}\n\n\t//Overridden in ReportBaseViewController.\n\tonContextMenuClick( context_btn, menu_name ) {\n\t\tvar id;\n\t\tif ( Global.isSet( menu_name ) ) {\n\t\t\tid = menu_name;\n\t\t} else {\n\t\t\tcontext_btn = $( context_btn );\n\n\t\t\tid = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\t//Check if icon is disabled and do nothing.\n\t\t\tif ( context_btn.hasClass( 'disable-image' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tProgressBar.showOverlay();\n\t\t//This flag is turned off in ProgressBarManager::closeOverlay, or 2 seconds whichever happens first. Use 2 seconds as overseas users could see intermittant 2 second latencies and double click Save icons.\n\t\tif ( window.clickProcessing == true ) {\n\t\t\treturn;\n\t\t} else {\n\t\t\twindow.clickProcessing = true;\n\t\t\twindow.clickProcessingHandle = window.setTimeout( function() {\n\t\t\t\t//FIXME: Check to see if the progress bar is visible because a API call is taking a long time, and if so keep the overlay up longer.\n\t\t\t\tif ( window.clickProcessing == true ) {\n\t\t\t\t\twindow.clickProcessing = false;\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t\tTTPromise.wait();\n\t\t\t\t}\n\t\t\t}, Global.calcDebounceWaitTimeBasedOnNetwork( 2000 ) );\n\t\t}\n\n\t\t//Debug.Text( 'Context Menu Click: '+ id, 'BaseViewController.js', 'BaseViewController', 'onContextMenuClick', 10 );\n\n\t\t/**\n\t\t *  Here where you see ProgressBar.showOverlay() it is how we prevent doubleclick from firing two single clicks\n\t\t */\n\n\t\tswitch ( id ) {\n\t\t\tcase ContextMenuIconName.add:\n\t\t\t\tthis.onAddClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.view:\n\t\t\t\tthis.onViewClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.save:\n\t\t\t\tthis.onSaveClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\tthis.onSaveAndNextClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\tthis.onSaveAndContinue();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\tthis.onSaveAndNewClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\tthis.onSaveAndCopy();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\tthis.onEditClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\tthis.onMassEditClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\tthis.onDeleteClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\tthis.onDeleteAndNextClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\tthis.onCopyClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\tthis.onCopyAsNewClick();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\tthis.onCancelClick();\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\tthis.onExportClick( 'export' + this.api.key_name );\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tcase ContextMenuIconName.map:\n\t\t\t\tthis.onMapClick();\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.onCustomContextClick( id, context_btn );\n\t\t\t\tProgressBar.closeOverlay(); //FIXME: This may be closing the overlay too soon, allowing double-clicks to get through. For example when in Request Authorizations and hammer clicking \"Authorize\".\n\t\t\t\t//Debug.Text( 'Context Menu Click: '+ id +' Overlay closing...', 'BaseViewController.js', 'BaseViewController', 'onContextMenuClick', 10 );\n\t\t\t\tbreak;\n\t\t}\n\n\t\tGlobal.triggerAnalyticsContextMenuClick( context_btn, menu_name );\n\t}\n\n\tonCustomContextClick( id ) {\n\t\treturn false; //FALSE tells onContextMenuClick() to keep processing.\n\t}\n\n\tonNavigationClick( id ) {\n\t\tthis.onContextMenuClick( id );\n\t}\n\n\tgetCurrentAPI() {\n\t\treturn this.api;\n\t}\n\n\tsetCurrentEditViewState( state ) {\n\t\tthis.is_viewing = false;\n\t\tthis.is_edit = false;\n\t\tthis.is_add = false;\n\t\tthis.is_mass_editing = false;\n\t\tthis.is_mass_adding = false;\n\t\tswitch ( state ) {\n\t\t\tcase 'view':\n\t\t\t\tthis.is_viewing = true;\n\t\t\t\tbreak;\n\t\t\tcase 'new':\n\t\t\t\tthis.is_add = true;\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\t\tthis.is_edit = true;\n\t\t\t\tbreak;\n\t\t\tcase 'mass_edit':\n\t\t\t\tthis.is_mass_editing = true;\n\t\t\t\tbreak;\n\t\t\t// case 'mass_add':\n\t\t\t// \t//this.is_add = true;\n\t\t\t// \tthis.is_mass_adding = true;\n\t\t\t// \tbreak;\n\n\t\t}\n\n\t\tLocalCacheData.current_doing_context_action = state;\n\t}\n\n\tonAddClick() {\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\t$this.openEditView();\n\t\t//Error: Uncaught TypeError: undefined is not a function in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-111140 line 897\n\t\tif ( $this.api && typeof $this.api['get' + $this.api.key_name + 'DefaultData'] === 'function' ) {\n\t\t\t$this.api['get' + $this.api.key_name + 'DefaultData']( {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onAddResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonAddResult( result ) {\n\t\tvar $this = this;\n\t\tvar result_data = {};\n\n\t\tif ( result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\t\t} else {\n\t\t\t//if not an api result, assume object is already the result of a call to getResult() and we will use it verbatim.\n\t\t\t//useful for passing in default values when adding new records before this function is called.\n\t\t\tresult_data = result;\n\t\t}\n\n\t\tif ( !result_data || result_data === true ) {\n\t\t\tresult_data = [];\n\t\t}\n\n\t\tresult_data.company = LocalCacheData.current_company.name;\n\n\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t}\n\n\t\t$this.current_edit_record = result_data;\n\t\t$this.initEditView();\n\t}\n\n\tonDeleteAndNextClick() {\n\t\tthis.setCurrentEditViewState( 'delete_and_next' );\n\t\tTAlertManager.showConfirmAlert( Global.delete_confirm_message, null, function( result ) {\n\t\t\t// Using an anonymous function instead of reference, to ensure during debugging it is clear this function is called from DeleteAndNext, and not just Delete.\n\t\t\tthis.doDeleteClick( result );\n\t\t}.bind( this ) );\n\t}\n\n\tresetNavigationSourceData() {\n\t}\n\n\tgetDeleteSelectedRecordId() {\n\t\tvar retval = [];\n\t\tif ( this.edit_view && this.current_edit_record ) {\n\t\t\tretval.push( this.current_edit_record.id );\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray().slice(); //Use .slice() to make a copy of the IDs.\n\t\t\tif ( grid_selected_id_array.length ) {\n\t\t\t\tretval = grid_selected_id_array;\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\n\t\t}\n\t\treturn retval;\n\t}\n\n\tdoDeleteClick( result ) {\n\t\tif ( result ) {\n\t\t\tProgressBar.showOverlay();\n\t\t\tvar remove_ids = this.getDeleteSelectedRecordId();\n\t\t\tif ( remove_ids === [] ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn this.doDeleteAPICall( remove_ids );\n\n\t\t} else {\n\t\t\tProgressBar.closeOverlay();\n\t\t}\n\t}\n\n\tdoDeleteAPICall( remove_ids, callback ) {\n\t\tvar current_api = this.getCurrentAPI();\n\n\t\tif ( !callback ) {\n\t\t\tcallback = {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tthis.onDeleteResult( result, remove_ids );\n\t\t\t\t}.bind( this )\n\t\t\t};\n\t\t}\n\t\treturn current_api['delete' + current_api.key_name]( remove_ids, callback );\n\t}\n\n\tonDeleteClick() {\n\t\tthis.setCurrentEditViewState( 'delete' );\n\t\tTAlertManager.showConfirmAlert( Global.delete_confirm_message, null, this.doDeleteClick.bind( this ) );\n\t}\n\n\tonDeleteResult( result, remove_ids ) {\n\t\tvar $this = this;\n\t\tProgressBar.closeOverlay();\n\t\tif ( result.isValid() ) {\n\n\t\t\tif ( LocalCacheData.current_doing_context_action === 'delete_and_next' ) {\n\t\t\t\t// store the index of the current item, before refreshing the search and losing the current context due to the deleted records\n\t\t\t\t$this.refresh_id = this.navigation.getNextSelectItemId();\n\n\t\t\t\t// refresh the grid to get the current dataset now that records have been deleted\n\t\t\t\t$this.search( false, null, null, function( result ) {\n\t\t\t\t\tvar current_grid_source = result.getResult();\n\n\t\t\t\t\tif ( $.type( current_grid_source ) !== 'array' || current_grid_source.length < 1 ) {\n\t\t\t\t\t\t// if after delete, there are no more records in the search, close edit view\n\t\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t\t$this.setDefaultMenu();\n\t\t\t\t\t\t// TODO: Should the above not simulate a cancel click? Could be an area for further refactor.\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// there are still records, load the new data\n\t\t\t\t\t\t$this.navigation.setSourceData( current_grid_source );\n\t\t\t\t\t\t$this.navigation.setPagerData( $this.pager_data );\n\n\t\t\t\t\t\t// if there is a valid id on the next record to load, do it\n\t\t\t\t\t\tif ( $this.refresh_id ) {\n\t\t\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( $this.refresh_id );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// no valid next record, simulate a cancel click.\n\t\t\t\t\t\t\t$this.onCancelClick();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$this.onDeleteAndNextDone( result );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.search();\n\t\t\t\t$this.onDeleteDone( result );\n\t\t\t\tif ( $this.edit_view && LocalCacheData.current_doing_context_action === 'delete' ) {\n\t\t\t\t\t$this.removeEditView();\n\t\t\t\t\t$this.setDefaultMenu();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// If some valid records were deleted, we need to refresh the search grid.\n\t\t\tif ( result.getRecordDetails().valid && result.getRecordDetails().valid > 0 ) {\n\t\t\t\t$this.search();\n\t\t\t}\n\t\t\tTAlertManager.showErrorAlert( result );\n\t\t}\n\t}\n\n\tremoveDeletedRows( remove_ids ) {\n\t\tvar $this = this;\n\t\t$.each( remove_ids, function( index, value ) {\n\t\t\t$this.grid.grid.deleteRow( value );\n\t\t\t$this.paging_widget.minus();\n\n\t\t} );\n//\n//\t\tif ( this.grid.getGridParam( 'data' ).length === 0 ) {\n//\t\t\tthis.search();\n//\t\t}\n\n//\t\tthis.search();\n\n//\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n//\t\tvar grid_selected_length = grid_selected_id_array.length;\n//\n//\t\tif ( grid_selected_length === 0 ) {\n//\t\t\tthis.search();\n//\t\t}\n\t}\n\n\tclearNavigationData() {\n\t\tif ( this.navigation && this.navigation.setSourceData ) {\n\t\t\tthis.navigation.setSourceData( null );\n\t\t}\n\t}\n\n\tonSaveAndCopy( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_add = true;\n\t\tthis.is_changed = false;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_copy';\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.clearNavigationData();\n\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndCopyResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndCopyResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\t\t\t$this.search( false );\n\t\t\t$this.onCopyAsNewClick();\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tonSaveAndNewClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\t\tthis.api['set' + this.api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndNewResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndNewResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) { // as new\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onAddClick( true );\n\t\t\t} );\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tonSaveAndContinue( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_changed = false;\n\t\tthis.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_continue';\n\t\tvar record = this.current_edit_record;\n\t\trecord = this.uniformVariable( record );\n\n\t\tthis.doSaveAPICall( record, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndContinueResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndContinueResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\n\t\t\t} else if ( result_data && TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onEditClick( $this.refresh_id, true );\n\t\t\t\t$this.onSaveAndContinueDone( result );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\tonSaveAndNextClick( ignoreWarning ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\t\tthis.is_add = false;\n\t\tthis.is_changed = false;\n\n\t\tvar current_api = this.getCurrentAPI();\n\t\tvar record = this.current_edit_record;\n\t\tLocalCacheData.current_doing_context_action = 'save_and_next';\n\t\trecord = this.uniformVariable( record );\n\t\tcurrent_api['set' + current_api.key_name]( record, false, ignoreWarning, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onSaveAndNextResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveAndNextResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t} else if ( result_data && TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t$this.refresh_id = result_data;\n\t\t\t}\n\n\t\t\t$this.saveInsideEditorData( function() {\n\t\t\t\t$this.onRightArrowClick();\n\t\t\t\t$this.search( false );\n\t\t\t\t$this.onSaveAndNextDone( result );\n\t\t\t} );\n\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result );\n\n\t\t}\n\t}\n\n\tuniformVariable( records ) {\n\t\treturn records;\n\t}\n\n\tsaveInsideEditorData( callback ) {\n\t\t//override this stub function where neeed. Brought in to consolidate those view controllers that used this.\n\t\t/* Dev Note: #2644 If issues happen, read this:\n\t\t* Functions such as onSaveAndNextResult() had a saveInsideEditorData call, but the base view did not, but the rest of the function was the same.\n\t\t * During refactor of these functions like save and next result into the base view, a stub of saveInsideEditor had to be created as it was not there previously.\n\t\t */\n\n\t\tif ( callback ) {\n\t\t\tcallback();\n\t\t}\n\t}\n\n\tgetChangedFields() {\n\t\tvar retval = {};\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\tretval[key] = this.current_edit_record[key]; // Note: Some view controllers use widget.getValue() instead of current_edit_record[key]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\t// overridden in view controllers where needed\n\t// this base version will simply extract and duplicate current edit record if an array of user_id's exist\n\t// parent function should check to confirm this.is_mass_adding is true\n\tbuildMassAddRecord( record ) {\n\t\tvar retval;\n\t\tif ( Global.isArray( record.user_id ) && record.user_id.length > 0 ) {\n\t\t\tretval = [];\n\t\t\t$.each( this.current_edit_record.user_id, function( index, value ) {\n\n\t\t\t\tvar commonRecord = Global.clone( record );\n\t\t\t\tcommonRecord.user_id = value;\n\t\t\t\tretval.push( commonRecord );\n\n\t\t\t} );\n\t\t} else {\n\t\t\tretval = record;\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tbuildMassEditSaveRecord( mass_edit_record_ids, changed_fields ) {\n\t\tvar $this = this;\n\t\tvar mass_records = [];\n\n\t\t$.each( mass_edit_record_ids, function( index, value ) {\n\t\t\tvar common_record = Global.clone( changed_fields );\n\t\t\tcommon_record.id = value;\n\t\t\tcommon_record = $this.uniformVariable( common_record );\n\t\t\tmass_records.push( common_record );\n\t\t} );\n\n\t\treturn mass_records;\n\t}\n\n\tonSaveClick( ignoreWarning ) {\n\t\tif ( !Global.isSet( ignoreWarning ) ) {\n\t\t\tignoreWarning = false;\n\t\t}\n\n\t\tvar record;\n\t\tthis.is_add = false;\n\t\tLocalCacheData.current_doing_context_action = 'save';\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tvar changed_fields = this.getChangedFields();\n\t\t\trecord = this.buildMassEditSaveRecord( this.mass_edit_record_ids, changed_fields );\n\n\t\t} else if ( this.is_mass_adding ) {\n\t\t\trecord = this.buildMassAddRecord( this.current_edit_record );\n\n\t\t} else {\n\t\t\trecord = this.current_edit_record;\n\t\t\trecord = this.uniformVariable( record );\n\t\t}\n\n\t\tthis.doSaveAPICall( record, ignoreWarning );\n\t}\n\n\tdoSaveAPICall( record, ignoreWarning, callback ) {\n\t\tvar current_api = this.getCurrentAPI();\n\n\t\tif ( !callback ) {\n\t\t\tcallback = {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\tthis.onSaveResult( result );\n\t\t\t\t}.bind( this )\n\t\t\t};\n\t\t}\n\n\t\t//current_api.setIsIdempotent( true ); //Force to idempotent API call to avoid duplicate network requests from causing errors displayed to the user.\n\t\treturn current_api['set' + current_api.key_name]( record, false, ignoreWarning, callback );\n\t}\n\n\tonSaveResult( result ) {\n\t\tvar $this = this;\n\t\tif ( result.isValid() ) {\n\t\t\t$this.is_add = false;\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( !this.edit_only_mode ) {\n\t\t\t\tif ( result_data === true && $this.current_edit_record && $this.current_edit_record.id ) {\n\t\t\t\t\t$this.refresh_id = $this.current_edit_record.id;\n\t\t\t\t} else if ( TTUUID.isUUID( result_data ) && result_data != TTUUID.zero_id && result_data != TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.refresh_id = result_data;\n\t\t\t\t} else {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t}\n\n\t\t\t\t$this.search();\n\t\t\t}\n\n\t\t\tvar on_save_done_result = $this.onSaveDone( result ); //post hook for onSaveResult\n\t\t\tif ( on_save_done_result == undefined || on_save_done_result == true ) {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\t\t} else {\n\t\t\t$this.setErrorTips( result );\n\t\t\t$this.setErrorMenu();\n\t\t}\n\t}\n\n\t//post hook for onSaveResult\n\tonSaveDone( result ) {\n\t\treturn true;\n\t}\n\n\tonSaveAndContinueDone( result ) {\n\t}\n\n\tonSaveAndNextDone( result ) {\n\t}\n\n\tonDeleteDone( result ) {\n\t\tthis.removeDeletedRows();\n\t}\n\n\tonDeleteAndNextDone( result ) {\n\t}\n\n\tonMassEditClick() {\n\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'mass_edit' );\n\t\t$this.openEditView();\n\t\tvar filter = {};\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\t$.each( grid_selected_id_array, function( index, value ) {\n\t\t\t$this.mass_edit_record_ids.push( value );\n\t\t} );\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = this.mass_edit_record_ids;\n\n\t\tthis.api['getCommon' + this.api.key_name + 'Data']( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\tif ( !result_data ) {\n\t\t\t\t\tresult_data = [];\n\t\t\t\t}\n\n\t\t\t\t$this.api['getOptions']( 'unique_columns', {\n\t\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t\t$this.unique_columns = result.getResult();\n\t\t\t\t\t\t$this.api['getOptions']( 'linked_columns', {\n\t\t\t\t\t\t\tonResult: function( result1 ) {\n\t\t\t\t\t\t\t\t$this.linked_columns = result1.getResult();\n\t\t\t\t\t\t\t\tif ( $this.linked_columns === true ) {\n\t\t\t\t\t\t\t\t\t//there are no columns, you should be an empty array.\n\t\t\t\t\t\t\t\t\t$this.linked_columns = [];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( $this.sub_view_mode && $this.parent_key ) {\n\t\t\t\t\t\t\t\t\tresult_data[$this.parent_key] = $this.parent_value;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t$this.current_edit_record = result_data;\n\t\t\t\t\t\t\t\t$this.initEditView();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\t/*\n\t * View Click handlers - Start\n\t */\n\tgetViewSelectedRecordId( record ) {\n\t\tvar retval = false;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tif ( Global.isSet( record ) ) {\n\t\t\t//Handle cases where record object is passed in, so we can extract the string ID.\n\t\t\t//  As well where the string ID is passed in directly as a UUID and accept that too.\n\t\t\t//  This is required to handle MyAccount -> Request Authorization, view any record, then refresh the browser.\n\t\t\tif ( Global.isObject( record ) && record.id ) {\n\t\t\t\tretval = record.id;\n\t\t\t} else if ( Global.isString( record ) && TTUUID.isUUID( record ) ) {\n\t\t\t\tretval = record;\n\t\t\t}\n\t\t} else {\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tretval = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tdoViewAPICall( filter, api_args ) {\n\t\tvar callback = { onResult: this.handleViewAPICallbackResult.bind( this ) };\n\t\tif ( api_args ) {\n\t\t\t// If api_args specified, use api_args.filter, and ignore function filter parameter.\n\t\t\tapi_args.push( callback );\n\t\t\treturn this.api['get' + this.api.key_name].apply( this.api, api_args );\n\t\t} else {\n\t\t\treturn this.api['get' + this.api.key_name]( filter, callback );\n\t\t}\n\t}\n\n\thandleViewAPICallbackResult( result ) {\n\t\tvar result_data;\n\t\tif ( result && result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\n\t\t\t//Do any result manipulation processes here, such as combining IDs together into a composite.\n\t\t\tresult_data = this.processAPICallbackResult( result_data );\n\n\t\t\tif ( !result_data ) {\n\t\t\t\tresult_data = [];\n\t\t\t}\n\n\t\t\tresult_data = result_data[0];\n\t\t} else {\n\t\t\t//Do not call processAPICallbackResult() here as we assume all processing has been completed earlier.\n\t\t\tresult_data = result;\n\t\t}\n\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist.' ) );\n\t\t\treturn this.onCancelClick();\n\t\t} else {\n\t\t\treturn this.doViewClickResult( result_data );\n\t\t}\n\t}\n\n\tdoViewClickResult( result_data ) {\n\t\tthis.current_edit_record = result_data;\n\t\tthis.initEditView();\n\t\treturn this.clearCurrentSelectedRecord();\n\t}\n\n\tonViewClick( record, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'view' );\n\t\tthis.openEditView();\n\n\t\tvar record_id = this.getViewSelectedRecordId( record );\n\t\tif ( Global.isFalseOrNull( record_id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setCurrentSelectedRecord( record_id );\n\n\t\tvar filter = this.getAPIFilters();\n\n\t\treturn this.doViewAPICall( filter );\n\t}\n\n\tsetCurrentSelectedRecord( record ) {\n\t\tif ( record ) {\n\t\t\tthis.current_selected_record = record;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetCurrentSelectedRecord() {\n\t\treturn this.current_selected_record;\n\t}\n\n\tclearCurrentSelectedRecord() {\n\t\tdelete this.current_selected_record;\n\t\treturn true;\n\t}\n\n\t// do we need this, Mike created it but check with him, as it may have just been a potential idea, not used.\n\tgetRecordIdFromRecord( object ) {\n\t\tif ( Global.isObject( object ) ) {\n\t\t\treturn object_id;\n\t\t} else if ( Global.isString( object ) ) {\n\t\t\treturn object;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/*\n\t * View Click handlers - End\n\t */\n\n\t/*\n\t * Common between View and Edit\n\t */\n\tprocessAPICallbackResult( result_data ) {\n\t\treturn result_data;\n\t}\n\n\tgetAPIFilters() {\n\t\t// override this function if view requires more filters\n\t\tvar record_id = this.getCurrentSelectedRecord();\n\t\tvar filter = {};\n\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_data.id = [record_id];\n\n\t\treturn filter;\n\t}\n\n\t/*\n\t * Edit Click handlers - Start\n\t */\n\tgetEditSelectedRecordId( record ) {\n\t\tvar retval = false;\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tif ( Global.isSet( record ) ) {\n\t\t\t//Handle cases where record object is passed in, so we can extract the string ID.\n\t\t\t//  As well where the string ID is passed in directly as a UUID and accept that too.\n\t\t\t//  This is required to handle editing any record, then refresh the browser.\n\t\t\tif ( Global.isObject( record ) && record.id ) {\n\t\t\t\tretval = record.id;\n\t\t\t} else if ( Global.isString( record ) && TTUUID.isUUID( record ) ) {\n\t\t\t\tretval = record;\n\t\t\t}\n\t\t} else {\n\t\t\t//Check for is_viewing and is_edit as the state may have changed from viewing to editing immediately before it got here.\n\t\t\t//  Test this with: Attendance -> TimeSheet, Edit Punch, click Station field to view the station, then click \"Edit\" icon.\n\t\t\tif ( ( this.is_viewing || this.is_edit ) && this.current_edit_record && this.current_edit_record.id ) {\n\t\t\t\tretval = this.current_edit_record.id;\n\t\t\t} else if ( grid_selected_length > 0 ) {\n\t\t\t\tretval = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tretval = null;\n\t\t\t}\n\t\t}\n\t\treturn retval;\n\t}\n\n\tdoEditAPICall( filter, api_args, callback ) {\n\t\tif ( !callback ) {\n\t\t\tcallback = { onResult: this.handleEditAPICallbackResult.bind( this ) };\n\t\t}\n\t\tif ( api_args ) {\n\t\t\t// If api_args specified, use api_args.filter, and ignore function filter parameter.\n\t\t\tapi_args.push( callback );\n\t\t\treturn this.api['get' + this.api.key_name].apply( this.api, api_args );\n\t\t} else {\n\t\t\treturn this.api['get' + this.api.key_name]( filter, callback );\n\t\t}\n\t}\n\n\thandleEditAPICallbackResult( result ) {\n\t\tvar result_data;\n\t\tif ( result.getResult ) {\n\t\t\tresult_data = result.getResult();\n\n\t\t\t//Do any result manipulation processes here, such as combining IDs together into a composite.\n\t\t\tresult_data = this.processAPICallbackResult( result_data );\n\n\t\t\tif ( !result_data ) {\n\t\t\t\tresult_data = [];\n\t\t\t}\n\n\t\t\tresult_data = result_data[0];\n\t\t} else {\n\t\t\t//Do not call processAPICallbackResult() here as we assume all processing has been completed earlier.\n\t\t\tresult_data = result;\n\t\t}\n\t\tif ( !result_data ) {\n\t\t\tTAlertManager.showAlert( $.i18n._( 'Record does not exist.' ) );\n\t\t\treturn this.onCancelClick();\n\t\t}\n\n\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\tresult_data[this.parent_key] = this.parent_value;\n\t\t}\n\t\treturn this.doEditClickResult( result_data );\n\t}\n\n\tdoEditClickResult( result_data ) {\n\t\tthis.current_edit_record = result_data;\n\t\tthis.initEditView();\n\t}\n\n\tonEditClick( record_id, noRefreshUI ) {\n\t\tthis.setCurrentEditViewState( 'edit' );\n\t\tthis.openEditView();\n\n\t\trecord_id = this.getEditSelectedRecordId( record_id );\n\t\tif ( Global.isFalseOrNull( record_id ) ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setCurrentSelectedRecord( record_id );\n\n\t\tvar filter = this.getAPIFilters();\n\n\t\treturn this.doEditAPICall( filter );\n\t}\n\n\t/*\n\t * Edit Click handlers - End\n\t */\n\n\tonCopyClick() {\n\t\tvar $this = this;\n\t\tvar copyIds = [];\n\t\t$this.is_add = false;\n\t\tif ( $this.edit_view ) {\n\t\t\tcopyIds.push( $this.current_edit_record.id );\n\t\t\tif ( this.is_changed ) {\n\t\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\t\t$this._continueDoCopy( copyIds );\n\t\t\t\t\t}\n\t\t\t\t\tProgressBar.closeOverlay();\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this._continueDoCopy( copyIds );\n\t\t\t}\n\t\t} else {\n\t\t\tcopyIds = $this.getGridSelectIdArray().slice();\n\t\t\t$this._continueDoCopy( copyIds );\n\t\t}\n\t}\n\n\t_continueDoCopy( copyIds ) {\n\t\tvar $this = this;\n\t\tProgressBar.showOverlay();\n\n\t\t//$this.api.setIsIdempotent( true ); //Force to idempotent API call to avoid duplicate network requests from causing errors displayed to the user.\n\t\t$this.api['copy' + $this.api.key_name]( copyIds, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onCopyResult( result );\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonCopyResult( result ) {\n\t\tvar $this = this;\n\n\t\tif ( result.isValid() ) {\n\t\t\t$this.search();\n\t\t\tif ( $this.edit_view ) {\n\t\t\t\t$this.removeEditView();\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tTAlertManager.showErrorAlert( result );\n\n\t\t\tif ( result.getRecordDetails().total > 1 ) {\n\t\t\t\t$this.search();\n\t\t\t}\n\t\t}\n\t}\n\n\tonCopyAsNewClick() {\n\t\tvar $this = this;\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this._continueDoCopyAsNew();\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tthis._continueDoCopyAsNew();\n\t\t}\n\t}\n\n\tcopyAsNewResetIds( data ) {\n\t\t//override where needed.\n\t\tdata.id = '';\n\t\treturn data;\n\t}\n\n\tgetCopyAsNewFilter( filter ) {\n\t\t// override where needed.\n\t\treturn filter;\n\t}\n\n\t_continueDoCopyAsNew() {\n\t\tvar $this = this;\n\t\tthis.setCurrentEditViewState( 'new' );\n\t\tLocalCacheData.current_doing_context_action = 'copy_as_new';\n\n\t\tif ( Global.isSet( this.edit_view ) ) {\n\t\t\tthis.current_edit_record = this.copyAsNewResetIds( this.current_edit_record );\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\tthis.setEditMenu();\n\t\t\tthis.setTabStatus(); // Show tabs based on permission. setCurrentEditRecordData has functions to set by record type. See #2687 - setTabStatus() must go before setCurrentEditRecordData(), otherwise Premium Policy Tabs incorrectly shown.\n\t\t\tif ( !this.editor ) {\n\t\t\t\t// #2687 if an editor exists in the view/tabs, we do not want to call setCurrentEditRecordData() as it wipes out the editor data in one of its child functions initInsideEditorData().\n\t\t\t\tthis.setCurrentEditRecordData();\n\t\t\t}\n\t\t\tthis.is_changed = false;\n\t\t\tProgressBar.closeOverlay();\n\t\t} else {\n\t\t\tvar filter = {};\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tvar selectedId = grid_selected_id_array[0];\n\t\t\t} else {\n\t\t\t\tTAlertManager.showAlert( $.i18n._( 'No selected record' ) );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [selectedId];\n\n\t\t\tfilter = this.getCopyAsNewFilter( filter );\n\n\t\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.onCopyAsNewResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tonCopyAsNewResult( result ) {\n\t\tvar result_data = result.getResult();\n\n\t\tif ( typeof result_data != 'object' ) {\n\t\t\tthis.onAddClick();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.openEditView(); // Put it here is to avoid if the selected one is not existed in data or have deleted by other pragram. in this case, the edit view should not be opend.\n\n\t\tresult_data = result_data[0];\n\n\t\tresult_data = this.copyAsNewResetIds( result_data );\n\n\t\tif ( this.sub_view_mode && this.parent_key ) {\n\t\t\tresult_data[this.parent_key] = this.parent_value;\n\t\t}\n\n\t\tthis.current_edit_record = result_data;\n\t\tvar $this = this;\n\n\t\t$( '.PunchesEditView .edit-view-tab-bar' ).css( 'opacity', 1 );\n\t\t$( '.PunchesEditView .edit-view-tab' ).css( 'opacity', 1 );\n\t\t$this.initEditView();\n\t}\n\n\t/*\n\t 1. Job is switched.\n\t 2. If a Task is already selected (and its not Task=0), keep it selected *if its available* in the newly populated Task list.\n\t 3. If the task selected is *not* available in the Task list, or the selected Task=0, then check the default_item_id field from the Job and if its *not* 0 also, select that Task by default.\n\n\t 'job' argument must be an object, or false/null\n\t */\n\tsetJobItemValueWhenJobChanged( job, job_item_id_col_name, filter_data ) {\n\t\tvar $this = this;\n\n\t\t//Error: Uncaught TypeError: Cannot set property 'job_item_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\tif ( !$this.current_edit_record ) {\n\t\t\treturn;\n\t\t}\n\n\t\tTTPromise.add( 'BaseViewController', 'setJobItemValueWhenJobChanged' );\n\n\t\tif ( job_item_id_col_name == undefined ) {\n\t\t\tjob_item_id_col_name = 'job_item_id';\n\t\t}\n\n\t\tif ( filter_data == undefined ) {\n\t\t\tfilter_data = { status_id: 10 };\n\t\t}\n\n\t\tif ( job != undefined && job != false ) {\n\t\t\tfilter_data['job_id'] = job.id; //Always filter by job\n\t\t}\n\n\t\tvar job_item_widget = $this.edit_view_ui_dic[job_item_id_col_name];\n\t\tvar current_job_item_id = job_item_widget.getValue();\n\t\tjob_item_widget.setSourceData( null );\n\t\tjob_item_widget.setCheckBox( true );\n\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\n\t\tvar args = {};\n\t\targs.filter_data = filter_data;\n\t\t$this.edit_view_ui_dic[job_item_id_col_name].setDefaultArgs( args );\n\n\t\t//Make sure if current task is selected, that its still available on the new job.\n\t\tif ( current_job_item_id && current_job_item_id != TTUUID.zero_id ) {\n\t\t\tvar new_arg = Global.clone( args );\n\n\t\t\tnew_arg.filter_data.job_id = job.id;\n\t\t\tnew_arg.filter_columns = $this.edit_view_ui_dic[job_item_id_col_name].getColumnFilter();\n\t\t\t$this.job_item_api.getJobItem( new_arg, {\n\t\t\t\tonResult: function( task_result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot set property 'job_item_id' of null in /interface/html5/#!m=TimeSheet&date=20150126&user_id=54286 line 6785\n\t\t\t\t\tif ( !$this.current_edit_record ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar data = task_result.getResult();\n\n\t\t\t\t\tif ( data.length > 0 ) {\n\t\t\t\t\t\tjob_item_widget.setValue( current_job_item_id );\n\t\t\t\t\t\t$this.current_edit_record[job_item_id_col_name] = current_job_item_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetDefaultData( job_item_id_col_name );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} else {\n\t\t\tsetDefaultData( job_item_id_col_name );\n\t\t}\n\n\t\tfunction setDefaultData( job_item_id_col_name ) {\n\t\t\tif ( job_item_id_col_name == undefined ) {\n\t\t\t\tjob_item_id_col_name = 'job_item_id';\n\t\t\t}\n\t\t\tif ( $this.current_edit_record.hasOwnProperty( job_item_id_col_name ) ) {\n\t\t\t\tjob_item_widget.setValue( job.default_item_id );\n\t\t\t\t$this.current_edit_record[job_item_id_col_name] = job.default_item_id;\n\n\t\t\t\tif ( job.default_item_id === false || job.default_item_id === 0 || job.default_item_id === TTUUID.zero_id || job.default_item_id === TTUUID.not_exist_id ) {\n\t\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tjob_item_widget.setValue( '' );\n\t\t\t\t$this.current_edit_record[job_item_id_col_name] = false;\n\t\t\t\t$this.edit_view_ui_dic.job_item_quick_search.setValue( '' );\n\t\t\t}\n\n\t\t\tTTPromise.resolve( 'BaseViewController', 'setJobItemValueWhenJobChanged' );\n\t\t}\n\t}\n\n\tonJobQuickSearch( key, value, job_id_field, job_item_id_field, filter_data ) {\n\t\tvar $this = this;\n\n\t\tvar args = {};\n\n\t\tTTPromise.add( 'BaseViewController', 'onJobQuickSearch' );\n\n\t\tif ( job_id_field == undefined ) {\n\t\t\tjob_id_field = 'job_id';\n\t\t}\n\t\tif ( job_item_id_field == undefined ) {\n\t\t\tjob_item_id_field = 'job_item_id';\n\t\t}\n\n\t\t//Error: Uncaught TypeErro: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_id_field] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key === 'job_quick_search' ) {\n\t\t\targs.filter_data = { manual_id: value, user_id: this.current_edit_record.user_id, status_id: '10' };\n\n\t\t\tthis.job_api.getJob( args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\t\t\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_id_field] ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result_data = result.getResult();\n\n\t\t\t\t\tif ( result_data.length > 0 ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_id_field].setValue( result_data[0].id );\n\t\t\t\t\t\t$this.current_edit_record[job_id_field] = result_data[0].id;\n\t\t\t\t\t\t$this.setJobItemValueWhenJobChanged( result_data[0], job_item_id_field, filter_data );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_id_field].setValue( '' );\n\t\t\t\t\t\t$this.current_edit_record[job_id_field] = false;\n\t\t\t\t\t\t$this.setJobItemValueWhenJobChanged( false, job_item_id_field, filter_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'BaseViewController', 'onJobQuickSearch' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$this.edit_view_ui_dic['job_quick_search'].setCheckBox( true );\n\t\t\t$this.edit_view_ui_dic[job_id_field].setCheckBox( true );\n\t\t} else if ( key === 'job_item_quick_search' ) {\n\t\t\targs.filter_data = { manual_id: value, job_id: this.current_edit_record[job_id_field], status_id: '10' };\n\n\t\t\tthis.job_item_api.getJobItem( args, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'setValue' of undefined in /interface/html5/#!m=TimeSheet&date=20141222&user_id=13566 line 6686\n\t\t\t\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic[job_item_id_field] ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar result_data = result.getResult();\n\t\t\t\t\tif ( result_data.length > 0 ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_item_id_field].setValue( result_data[0].id );\n\t\t\t\t\t\t$this.current_edit_record[job_item_id_field] = result_data[0].id;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_dic[job_item_id_field].setValue( '' );\n\t\t\t\t\t\t$this.current_edit_record[job_item_id_field] = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tTTPromise.resolve( 'BaseViewController', 'onJobQuickSearch' );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.edit_view_ui_dic['job_item_quick_search'].setCheckBox( true );\n\t\t\tthis.edit_view_ui_dic[job_item_id_field].setCheckBox( true );\n\t\t}\n\t}\n\n\tonCancelClick( force_no_confirm, cancel_all, callback ) {\n\t\tTTPromise.add( 'base', 'onCancelClick' );\n\t\tvar $this = this;\n\t\t//#2342 This logic is also in onSubMenuClick click in RibbonViewController\n\t\tif ( !force_no_confirm\n\t\t\t&&\n\t\t\t(\n\t\t\t\t$this.is_changed == true\n\t\t\t\t|| ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view && LocalCacheData.current_open_primary_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_report_controller && LocalCacheData.current_open_report_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_edit_only_controller && LocalCacheData.current_open_edit_only_controller.is_changed == true )\n\t\t\t\t|| ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view && LocalCacheData.current_open_sub_controller.is_changed == true )\n\n\t\t\t) ) {\n\t\t\tthis.confirm_on_exit = true;\n\t\t}\n\n\t\tLocalCacheData.current_doing_context_action = 'cancel';\n\t\tif ( this.confirm_on_exit == true ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( clicked_yes ) {\n\t\t\t\tif ( clicked_yes === true ) {\n\t\t\t\t\tdoNext( force_no_confirm, cancel_all, callback );\n\t\t\t\t} else {\n\t\t\t\t\tTTPromise.reject( 'base', 'onCancelClick' );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tdoNext( force_no_confirm, cancel_all, callback );\n\t\t}\n\n\t\tfunction doNext( force_no_confirm, cancel_all, callback ) {\n\t\t\tif ( !$this.edit_view && $this.parent_view_controller && $this.sub_view_mode ) {\n\t\t\t\t$this.parent_view_controller.is_changed = false;\n\t\t\t\t$this.parent_view_controller.confirm_on_exit = false;\n\t\t\t\t$this.parent_view_controller.buildContextMenu( true );\n\t\t\t\t$this.parent_view_controller.onCancelClick( true ); //Force no confirm so we don't get two messages when cancelling from Edit Employee -> Wage (tab) -> Edit Wage.\n\t\t\t} else {\n\t\t\t\t$this.removeEditView( true );\n\t\t\t}\n\n\t\t\tif ( cancel_all ) {\n\t\t\t\tif ( LocalCacheData.current_open_edit_only_controller ) {\n\t\t\t\t\tLocalCacheData.current_open_edit_only_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_sub_controller && LocalCacheData.current_open_sub_controller.edit_view ) {\n\t\t\t\t\tLocalCacheData.current_open_sub_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_primary_controller && LocalCacheData.current_open_primary_controller.edit_view ) {\n\t\t\t\t\tLocalCacheData.current_open_primary_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t} else if ( LocalCacheData.current_open_report_controller ) {\n\t\t\t\t\tLocalCacheData.current_open_report_controller.onCancelClick( force_no_confirm, cancel_all );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( callback ) {\n\t\t\t\tcallback();\n\t\t\t}\n\n\t\t\tGlobal.setUIInitComplete();\n\t\t\tTTPromise.resolve( 'base', 'onCancelClick' );\n\t\t}\n\t}\n\n\t//Don't call super if override this function.\n\tonFormItemChange( target, doNotValidate ) {\n\t\t// Error: TypeError: this.current_edit_record is undefined in interface/html5/views/BaseViewController.js?v=9.0.7-20160202-113244 line 1691\n\t\tif ( !this.current_edit_record ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setIsChanged( target );\n\t\tthis.setMassEditingFieldsWhenFormChange( target );\n\t\tvar key = target.getField();\n\t\tthis.current_edit_record[key] = target.getValue();\n\n\t\tif ( !doNotValidate ) {\n\t\t\tthis.validate();\n\t\t}\n\t}\n\n\tsetIsChanged( target ) {\n\t\tvar key = target.getField();\n\t\tif ( this.current_edit_record && this.current_edit_record[key] != target.getValue() ) {\n\t\t\tthis.is_changed = true;\n\t\t}\n\t}\n\n\tonFormItemKeyUp( target ) {\n\t}\n\n\tonFormItemKeyDown( target ) {\n\t}\n\n\tsetMassEditingFieldsWhenFormChange( target ) {\n\t\tvar $this = this;\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tvar field = target.getField();\n\t\t\tvar linked_fields = [];\n\t\t\tvar is_linked_field = false;\n\t\t\t$.each( this.linked_columns, function( index, value ) {\n\t\t\t\tif ( value !== field ) {\n\t\t\t\t\tlinked_fields.push( value );\n\t\t\t\t} else {\n\t\t\t\t\tis_linked_field = true;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( is_linked_field ) {\n\t\t\t\t$.each( linked_fields, function( index, value ) {\n\t\t\t\t\tvar is_checked = $this.edit_view_ui_dic[field].isChecked();\n\t\t\t\t\t$this.edit_view_ui_dic[value].setCheckBox( is_checked );\n\t\t\t\t} );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsetTabLabels( source ) {\n\t\tfor ( var key in source ) {\n\t\t\tthis.edit_view.find( 'a[ref=' + key + ']' ).text( source[key] );\n\t\t}\n\t}\n\n\tgetTabModel() {\n\t\treturn this.tab_model;\n\t}\n\n\tsetTabModel( model ) {\n\t\tvar tab_labels = {};\n\n\t\tfor ( var i in model ) {\n\t\t\t//If the model is \"true\", then use default models for audit/attachment tabs.\n\t\t\tif ( i == 'tab_audit' && model[i] === true ) {\n\t\t\t\tmodel['tab_audit'] = {\n\t\t\t\t\t'label': $.i18n._( 'Audit' ),\n\t\t\t\t\t'init_callback': 'initSubLogView',\n\t\t\t\t\t'display_on_mass_edit': false,\n\t\t\t\t\t'display_on_add': false\n\t\t\t\t};\n\t\t\t} else if ( i == 'tab_attachment' && model[i] === true ) {\n\t\t\t\tmodel['tab_attachment'] = {\n\t\t\t\t\t'label': $.i18n._( 'Attachment' ),\n\t\t\t\t\t'init_callback': 'initSubDocumentView',\n\t\t\t\t\t'display_on_mass_edit': false\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif ( model[i].hasOwnProperty( 'label' ) && model[i].label != '' ) {\n\t\t\t\ttab_labels[i] = model[i].label;\n\t\t\t}\n\t\t}\n\n\t\tthis.tab_model = model;\n\t\tthis.setTabLabels( tab_labels );\n\n\t\treturn true;\n\t}\n\n\tonTabShow( e, ui ) {\n\t\tif ( !this.current_edit_record ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar key = this.getEditViewTabIndex();\n\t\tthis.editFieldResize( key );\n\n\t\tvar tab_model = this.getTabModel();\n\n\t\tif ( tab_model != null ) {\n\t\t\tif ( ui && ui.oldTab ) {\n\t\t\t\tvar prev_tab_name = ui.oldTab.find( 'a' )[0].getAttribute( 'href' ).substring( 1 );\n\t\t\t\tif ( tab_model[prev_tab_name] && tab_model[prev_tab_name].hasOwnProperty( 'on_exit_callback' ) && tab_model[prev_tab_name].on_exit_callback != '' ) {\n\t\t\t\t\tthis[tab_model[prev_tab_name].on_exit_callback]( prev_tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//ReFactored path to handle tabs based on a tab model mapping defined in each view class.\n\t\t\t//This abstracts the entry point for all tabs initializations to help with hiding/showing them and to reduce code duplication.\n\t\t\tvar tab_name = null;\n\t\t\tvar sub_view_div = null;\n\n\t\t\tvar tab_bar = this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).find( 'a' );\n\t\t\tif ( tab_bar.length > 0 ) {\n\t\t\t\ttab_name = tab_bar[0].getAttribute( 'href' ).substring( 1 ); //Remove the '#';\n\t\t\t\tsub_view_div = this.edit_view_tab.find( '#' + tab_name ).find( '.first-column-sub-view' );\n\t\t\t}\n\n\t\t\tif ( sub_view_div && sub_view_div.length > 0 && this.tab_model[tab_name] && !this.tab_model[tab_name].initialized ) { //Only hide grid on first initialization as it has to load all the data. Otherwise the 2nd time the user goes to the tab they will see some minor \"flashing\"\n\t\t\t\tTTPromise.add( 'BaseViewController', 'onTabShow' );\n\t\t\t\tTTPromise.wait( 'BaseViewController', 'onTabShow', function() {\n\t\t\t\t\tsub_view_div.css( 'opacity', '1' );\n\t\t\t\t} );\n\n\t\t\t\tsub_view_div.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\t\t\t\tthis.tab_model[tab_name].initialized = true;\n\t\t\t}\n\n\t\t\tif ( tab_model[tab_name] ) {\n\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t//Call the init_callback even if we are editing an existing record or creating a new one.\n\t\t\t\t// As some views (ie: OverTime Policy) need to control whats shown on each tab regardless of if we are editing or adding.\n\t\t\t\tif ( tab_model[tab_name].hasOwnProperty( 'init_callback' ) && tab_model[tab_name].init_callback != '' ) {\n\t\t\t\t\tthis[tab_model[tab_name].init_callback]( tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t} else {\n\t\t\t\t\t//Assume primary tab and build context menu.\n\t\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\t\tthis.buildContextMenu( true );\n\t\t\t\t\t\tthis.setEditMenu();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'none' ); //This would prevent the grid from showing in Attendance -> TimeSheet, Accumulated Time view.\n\t\t\t\t\t\t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\t\tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'block' );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if ( this.current_edit_record.id ) {\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t// \tif ( tab_model[tab_name].hasOwnProperty('init_callback') && tab_model[tab_name].init_callback != '' ) {\n\t\t\t\t// \t\tthis[tab_model[tab_name].init_callback]( tab_name ); //Call mapped function to initialize the tab.\n\t\t\t\t// \t} else {\n\t\t\t\t// \t\t//Assume primary tab and build context menu.\n\t\t\t\t// \t\tthis.buildContextMenu( true );\n\t\t\t\t// \t\tthis.setEditMenu();\n\t\t\t\t// \t}\n\t\t\t\t// } else {\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'none' ); //This would prevent the grid from showing in Attendance -> TimeSheet, Accumulated Time view.\n\t\t\t\t// \t//this.edit_view_tab.find( '#'+ tab_name ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t// \tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'block' );\n\t\t\t\t// }\n\t\t\t} else {\n\t\t\t\t//Assume primary tab and build context menu.\n\t\t\t\tthis.buildContextMenu( true );\n\t\t\t\tthis.setEditMenu();\n\t\t\t}\n\t\t} else {\n\t\t\t//Handle most cases that one tab and on audit tab\n\t\t\tif ( key === 1 ) {\n\n\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\tthis.initSubLogView( 'tab_audit' );\n\t\t\t\t} else {\n\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'none' );\n\t\t\t\t\tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'block' );\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tthis.buildContextMenu( true );\n\t\t\t\tthis.setEditMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\t//When overriding this function, always call super() so it can handle tab_audit/tab_attachment on its own.\n\tcheckTabPermissions( tab ) {\n\t\tvar retval = true; //Most tabs are shown, so default to true.\n\n\t\tswitch ( tab ) {\n\t\t\tcase 'tab_audit':\n\t\t\t\tretval = this.subAuditValidate();\n\t\t\t\tbreak;\n\t\t\tcase 'tab_attachment':\n\t\t\t\tretval = this.subDocumentValidate();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn retval;\n\t}\n\n\tsetTabStatus() {\n\t\t// exception that edit_view_tab is null\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar tab_model = this.getTabModel();\n\n\t\tif ( tab_model != null ) {\n\t\t\tvar visible_tab_indexes = Array();\n\n\t\t\t//ReFactored path to handle tabs based on a tab model mapping defined in each view class.\n\t\t\t//This abstracts the entry point for all tabs initializations to help with hiding/showing them and to reduce code duplication.\n\t\t\tfor ( var i in tab_model ) {\n\t\t\t\tvar tab_index = $( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().index();\n\n\t\t\t\tif ( ( this.is_mass_editing && tab_model[i].hasOwnProperty( 'display_on_mass_edit' ) && tab_model[i].display_on_mass_edit == false )\n\t\t\t\t\t|| ( ( this.is_add || this.is_mass_adding ) && tab_model[i].hasOwnProperty( 'display_on_add' ) && tab_model[i].display_on_add == false ) ) {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().hide();\n\t\t\t\t} else {\n\t\t\t\t\tif ( this.checkTabPermissions( i ) == true ) {\n\t\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().show();\n\t\t\t\t\t\tvisible_tab_indexes.push( tab_index );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"' + i + '\"]' ) ).parent().hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Always start with the first tab that actually has permissions to be shown. This is important for sub-views like Edit Employee, Tax, New icon, where it shows only a single tab where there are really 5+ tabs just hidden.\n\t\t\tvisible_tab_indexes = visible_tab_indexes.sort( function( a, b ) {\n\t\t\t\treturn a - b;\n\t\t\t} ); //numeric sort.\n\n\t\t\tif ( visible_tab_indexes[0] ) {\n\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', visible_tab_indexes[0] );\n\t\t\t}\n\t\t} else {\n\t\t\t//Handle most cases that one tab and on audit tab\n\t\t\tif ( this.is_mass_editing ) {\n\n\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().hide();\n\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\n\t\t\t} else {\n\n\t\t\t\tif ( this.subAuditValidate() ) {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().show();\n\t\t\t\t} else {\n\t\t\t\t\t$( this.edit_view_tab.find( 'ul li a[ref=\"tab_audit\"]' ) ).parent().hide();\n\t\t\t\t\tthis.edit_view_tab.tabs( 'option', 'active', 0 );\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.editFieldResize( 0 );\n\t}\n\n\tonTabIndexChange( e ) {\n\t\tTTPromise.add( 'BaseViewController', 'onTabIndexChange' );\n\t\tTTPromise.wait();\n\n\t\tif ( ( !this.sub_view_mode && !this.edit_only_mode ) || typeof this.initReport == 'function' ) {\n\t\t\tvar current_url = window.location.href;\n\n\t\t\tif ( current_url.indexOf( '&tab' ) > 0 ) {\n\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&tab' ) );\n\t\t\t}\n\t\t\tvar tab_name = this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().eq( this.getEditViewTabIndex() ).text();\n\t\t\ttab_name = tab_name.replace( /\\/|\\s+/g, '' );\n\t\t\tcurrent_url = current_url + '&tab=' + tab_name;\n\n\t\t\tGlobal.setURLToBrowser( current_url );\n\n\t\t}\n\n\t\tthis.hideErrorTips();\n\t\tTTPromise.resolve( 'BaseViewController', 'onTabIndexChange' );\n\t}\n\n\thideErrorTips() {\n\t\tfor ( var key in this.edit_view_error_ui_dic ) {\n\t\t\t//#2581 - Uncaught TypeError: this.edit_view_error_ui_dic[key].hideErrorTip is not a function\n\t\t\tif ( this.edit_view_error_ui_dic[key] && typeof this.edit_view_error_ui_dic[key].hideErrorTip == 'function' ) {\n\t\t\t\tthis.edit_view_error_ui_dic[key].hideErrorTip();\n\t\t\t}\n\t\t}\n\t\tthis.removeEditViewErrorTip();\n\t}\n\n\t//removed workarounds and comments for qtip1 when upgrading to qtip2.\n\tremoveEditViewErrorTip() {\n\t\tif ( $( '.qtip2-error-tip:visible' ) ) {\n\t\t\t$( '.qtip2-error-tip' ).remove();\n\t\t}\n\t}\n\n\tonCountryChange() {\n\t\tvar selectVal = this.edit_view_ui_dic['country'].getValue();\n\t\tthis.eSetProvince( selectVal, true );\n\t\tthis.clearErrorTips();\n\t\tthis.setEditMenu();\n\t}\n\n\t//Make sure this.current_edit_record is updated before validate\n\tvalidate( api ) {\n\t\tif ( this.enable_validation ) {\n\t\t\t//Allow alternate api to be validated.\n\t\t\tif ( api == undefined ) {\n\t\t\t\tvar api = this.api;\n\t\t\t}\n\n\t\t\tvar $this = this;\n\t\t\tvar record = {};\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\t\t\tif ( Global.isSet( widget.isChecked ) ) {\n\t\t\t\t\t\tif ( widget.isChecked() && widget.getEnabled() ) {\n\t\t\t\t\t\t\trecord[key] = this.current_edit_record[key]; // Note: Some view controllers use widget.getValue() instead of current_edit_record[key]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trecord = this.current_edit_record;\n\t\t\t}\n\t\t\trecord = this.uniformVariable( record );\n\t\t\tapi['validate' + api.key_name]( record, {\n\t\t\t\tonResult: function( result ) {\n\t\t\t\t\t$this.validateResult( result );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tDebug.Text( 'Validation disabled', 'BaseViewController.js', 'BaseViewController', 'validate', 10 );\n\t\t}\n\t}\n\n\tvalidateResult( result ) {\n\t\tvar $this = this;\n\t\t$this.clearErrorTips(); //Always clear error\n\t\tif ( !$this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !result ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( result.isValid() ) {\n\t\t\t$this.edit_view.attr( 'validate_complete', true );\n\t\t\t$this.setEditMenu();\n\t\t} else {\n\t\t\t$this.setErrorMenu();\n\t\t\t$this.setErrorTips( result, this.show_warning_when_validation );\n\n\t\t}\n\t}\n\n\tclearErrorTips() {\n\n\t\tfor ( var key in this.edit_view_error_ui_dic ) {\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'clearErrorStyle' of undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-111140 line 1779\n\t\t\tif ( !this.edit_view_error_ui_dic.hasOwnProperty( key ) || !this.edit_view_error_ui_dic[key] ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.edit_view_error_ui_dic[key].clearErrorStyle();\n\t\t}\n\n\t\t// Error: Uncaught TypeError: Cannot read property 'interfaces' of undefined in interface/html5/framework/jquery.qtip.min.js?v=9.0.0-20150918-221906 line 15\n\t\tthis.removeEditViewErrorTip();\n\t\t$( '.error-tab' ).removeClass( 'error-tab' );\n\t\t$( '.error-tab-hide' ).removeClass( 'error-tab-hide' );\n\t\t$( '.warning-tab' ).removeClass( 'warning-tab' );\n\t\t$( '.warning-tab-hide' ).removeClass( 'warning-tab-hide' );\n\t\t// Clear pulse on tabs\n\t\tif ( this.pulse_time_dic ) {\n\t\t\tfor ( var key1 in this.pulse_time_dic ) {\n\t\t\t\tclearInterval( this.pulse_time_dic[key1] );\n\t\t\t}\n\t\t\tthis.pulse_time_dic = {};\n\t\t}\n\t\tthis.edit_view_error_ui_dic = {};\n\n\t\t$( '.qtip' ).remove();\n\t}\n\n\t//Override this if more than one tab\n\tsetErrorTips( result, show_warning ) {\n\t\tthis.clearErrorTips();\n\t\tif ( !Global.isSet( show_warning ) ) {\n\t\t\tshow_warning = true;\n\t\t}\n\n\t\t//Error: Unable to get property 'find' of undefined or null reference in http://timeclock:8085/interface/html5/views/BaseViewController.js?v=7.4.3-20140926-105827 line 1769\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar details = result.getDetails();\n\t\t// Only check first item\n\t\t// Error: Uncaught TypeError: Cannot call method 'hasOwnProperty' of undefined in /interface/html5/views/BaseViewController.js?v=9.0.0-20150822-134259 line 1879\n\t\t// Zero is not always the first element;\n\t\tvar first_el = 0;\n\t\tfor ( var first_el in details ) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif ( details && details[first_el] && details[first_el].hasOwnProperty( 'error' ) ) {\n\t\t\tthis.setErrorTipsError( result );\n\t\t} else if ( details && details[first_el] && details[first_el].hasOwnProperty( 'warning' ) ) { //Error: TypeError: details[0] is undefined in https://greenacres.timetrex.com/interface/html5/views/BaseViewController.js?v=9.0.0-20150822-105118 line 1883\n\t\t\tif ( show_warning ) {\n\t\t\t\tthis.setErrorTipsWarning( result );\n\t\t\t}\n\t\t\tthis.setEditMenu();\n\t\t} else if ( result.getCode() == 'PERMISSION' ) {\n\t\t\tTAlertManager.showErrorAlert( result );\n\t\t} else {\n\t\t\t// Make sure current codes work.\n\t\t\tthis.setErrorTipsError( result );\n\t\t}\n\t}\n\n\tsetErrorTipsWarning( result ) {\n\t\tvar $this = this;\n\t\tvar widget;\n\t\t// when do validation, only show warning no alert\n\t\tvar $current_doing_context_action = LocalCacheData.current_doing_context_action; //#2474 - LocalCacheData.current_doing_context_action can change to \"validate\" while waiting for user to respond to warning box.\n\t\tif ( $current_doing_context_action != 'validate' ) {\n\t\t\tTAlertManager.showWarningAlert( result, function( flag ) {\n\t\t\t\tif ( flag ) {\n\t\t\t\t\tswitch ( $current_doing_context_action ) {\n\t\t\t\t\t\tcase 'save':\n\t\t\t\t\t\t\t$this.onSaveClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_continue':\n\t\t\t\t\t\t\t$this.onSaveAndContinue( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_next':\n\t\t\t\t\t\t\t$this.onSaveAndNextClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'save_and_copy':\n\t\t\t\t\t\t\t$this.onSaveAndCopy( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'new':\n\t\t\t\t\t\t\t$this.onSaveAndNewClick( true );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.show_warning_when_validation = true;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t//Error: Unable to get property 'warning' of undefined or null reference\n\t\tvar error_list = [];\n\t\tif ( result.getDetails().length == 1 ) {\n\t\t\terror_list = result.getDetails()[0].warning;\n\t\t}\n\t\tvar found_in_current_tab = false;\n\t\tfor ( var key in error_list ) {\n\t\t\tif ( !error_list.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( Global.isSet( this.edit_view_ui_dic[key] ) && this.edit_view_ui_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key];\n\t\t\t} else if ( Global.isSet( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\tif ( Global.isArray( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\t\tvar len = this.edit_view_ui_validation_field_dic[key].length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar item = this.edit_view_ui_validation_field_dic[key][i];\n\t\t\t\t\t\tif ( item.closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\t\t\twidget = item;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( this.edit_view_ui_validation_field_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\twidget = this.edit_view_ui_validation_field_dic[key];\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if ( key.indexOf( '_id' ) < 0 && Global.isSet( this.edit_view_ui_dic[key + '_id'] ) && this.edit_view_ui_dic[key + '_id'].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key + '_id'];\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( error_list[key] ) {\n\t\t\t\tvar show_error = false;\n\t\t\t\tif ( widget.is( ':visible' ) ) {\n\t\t\t\t\tshow_error = true;\n\t\t\t\t\tfound_in_current_tab = true;\n\t\t\t\t}\n\n\t\t\t\tif ( typeof widget.setErrorStyle === 'function' ) { //Fix JS exception: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\t\twidget.setErrorStyle( error_list[key], show_error, true );\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.showErrorStatusOnTab( widget, false );\n\t\t\tthis.edit_view_error_ui_dic[key] = widget;\n\t\t}\n\t\tif ( !found_in_current_tab ) {\n\t\t\tthis.showEditViewError( result );\n\t\t}\n\t}\n\n\tshowErrorStatusOnTab( widget, isError ) {\n\t\tvar parentContainer = widget.parent();\n\t\tvar i = 0;\n\t\twhile ( !parentContainer.hasClass( 'edit-view-tab-outside' ) && i < 5 ) {\n\t\t\ti = i + 1;\n\t\t\tparentContainer = parentContainer.parent();\n\t\t}\n\t\tif ( parentContainer.hasClass( 'edit-view-tab-outside' ) ) {\n\t\t\tvar id = parentContainer.attr( 'id' );\n\t\t\tvar tab = this.edit_view.find( 'a[ref=\"' + id + '\"]' );\n\t\t\tif ( isError ) {\n\t\t\t\ttab.parent().addClass( 'error-tab' );\n\t\t\t\tthis.startPulse( id, tab.parent() );\n\t\t\t} else {\n\t\t\t\ttab.parent().addClass( 'warning-tab' );\n\t\t\t\tthis.startPulse( id, tab.parent(), true );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tstartPulse( tab_id, target, is_warning ) {\n\t\tvar $this = this;\n\t\tif ( !this.pulse_time_dic ) {\n\t\t\tthis.pulse_time_dic = {};\n\t\t}\n\t\tif ( this.pulse_time_dic[tab_id] ) {\n\t\t\tcleanTimer( tab_id );\n\t\t}\n\t\tthis.pulse_time_dic[tab_id] = setInterval( function() {\n\t\t\tif ( is_warning ) {\n\t\t\t\tif ( target.hasClass( 'warning-tab-hide' ) ) {\n\t\t\t\t\ttarget.removeClass( 'warning-tab-hide' );\n\t\t\t\t} else if ( target.hasClass( 'warning-tab' ) ) {\n\t\t\t\t\ttarget.addClass( 'warning-tab-hide' );\n\t\t\t\t} else {\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( target.hasClass( 'error-tab-hide' ) ) {\n\t\t\t\t\ttarget.removeClass( 'error-tab-hide' );\n\t\t\t\t} else if ( target.hasClass( 'error-tab' ) ) {\n\t\t\t\t\ttarget.addClass( 'error-tab-hide' );\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tif ( target.hasClass( 'error-tab-hide' ) ) {\n\t\t\t\t\t\t\ttarget.removeClass( 'error-tab-hide' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$this.startPulse( tab_id, target, is_warning );\n\t\t\t\t\t}, 1700 );\n\t\t\t\t} else {\n\t\t\t\t\tcleanTimer( tab_id );\n\t\t\t\t}\n\t\t\t}\n\t\t}, 2000 );\n\n\t\tfunction cleanTimer( tab_id ) {\n\t\t\tclearInterval( $this.pulse_time_dic[tab_id] );\n\t\t\t$this.pulse_time_dic[tab_id] = null;\n\t\t}\n\t}\n\n\tsetErrorTipsError( result ) {\n\n\t\t//Error: TypeError: details[0] is undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150822-105118 line 1883\n\t\t// Zero is not always the firwst index.\n\t\tvar result_array = result.getDetails() ? result.getDetails() : {};\n\t\tvar first_el = 0;\n\t\tfor ( var first_el in result_array ) {\n\t\t\tbreak;\n\t\t}\n\t\tvar error_list = result_array ? result_array[first_el] : {};\n\t\tvar widget;\n\t\tif ( error_list && error_list.hasOwnProperty( 'error' ) ) {\n\t\t\terror_list = error_list.error;\n\t\t}\n\t\tvar found_in_current_tab = false;\n\t\tfor ( var key in error_list ) {\n\t\t\tif ( !error_list.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( Global.isSet( this.edit_view_ui_dic[key] ) && this.edit_view_ui_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key];\n\t\t\t} else if ( Global.isSet( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\tif ( Global.isArray( this.edit_view_ui_validation_field_dic[key] ) ) {\n\t\t\t\t\tvar len = this.edit_view_ui_validation_field_dic[key].length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar item = this.edit_view_ui_validation_field_dic[key][i];\n\t\t\t\t\t\tif ( item.closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\t\t\twidget = item;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if ( this.edit_view_ui_validation_field_dic[key].closest( document.documentElement ).length > 0 ) {\n\t\t\t\t\twidget = this.edit_view_ui_validation_field_dic[key];\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else if ( key.indexOf( '_id' ) < 0 && Global.isSet( this.edit_view_ui_dic[key + '_id'] ) && this.edit_view_ui_dic[key + '_id'].closest( document.documentElement ).length > 0 ) {\n\t\t\t\twidget = this.edit_view_ui_dic[key + '_id'];\n\t\t\t} else {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( widget.is( ':visible' ) ) {\n\t\t\t\t// Error: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\tif ( widget.setErrorStyle && typeof widget.setErrorStyle == 'function' ) {\n\t\t\t\t\twidget.setErrorStyle( error_list[key], true );\n\t\t\t\t\tfound_in_current_tab = true;\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'ERROR: widget.setErrorStyle is not a function.', 'BaseViewController.js', 'BaseViewController', null, 10 );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Error: Uncaught TypeError: widget.setErrorStyle is not a function\n\t\t\t\tif ( widget.setErrorStyle && typeof widget.setErrorStyle == 'function' ) {\n\t\t\t\t\twidget.setErrorStyle( error_list[key] );\n\t\t\t\t} else {\n\t\t\t\t\tDebug.Text( 'ERROR: widget.setErrorStyle is not a function.', 'BaseViewController.js', 'BaseViewController', null, 10 );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.showErrorStatusOnTab( widget, true );\n\t\t\tthis.edit_view_error_ui_dic[key] = widget;\n\t\t}\n\t\tif ( !found_in_current_tab ) {\n\t\t\tthis.showEditViewError( result );\n\t\t}\n\t}\n\n\tshowEditViewError( result ) {\n\t\tvar details = result.getDetails()[0];\n\t\tvar isError = true;\n\t\t//Error: TypeError: details is undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150908-081451 line 2078\n\t\tif ( !details ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( details.hasOwnProperty( 'error' ) ) {\n\t\t\tdetails = details.error;\n\t\t\tisError = true;\n\t\t} else if ( details.hasOwnProperty( 'warning' ) ) {\n\t\t\tisError = false;\n\t\t\tdetails = details.warning;\n\t\t}\n\t\tvar error_string = '';\n\t\tvar background_color = isError ? '#cb2e2e' : '#ffff00';\n\t\tvar color = isError ? '#fff' : '#000';\n\t\tvar border_color = isError ? '#CB2E2E' : '#e7be00';\n\n\t\terror_string = Global.convertValidationErrorToString( details );\n\n\t\tthis.removeEditViewErrorTip();\n\t\tthis.edit_view.children().eq( 0 ).children().eq( 2 ).qtip( {\n\t\t\tshow: {\n\t\t\t\twhen: false,\n\t\t\t\tready: true\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\thide: function( event, api ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcontent: error_string,\n\t\t\tstyle: {\n\t\t\t\tclasses: isError ? 'qtip2-error-tip' : 'qtip2-warning-tip', //used for styling and removal.\n\t\t\t\ttip: {\n\t\t\t\t\tcorner: 'bottom center'\n\t\t\t\t}\n\t\t\t},\n\t\t\tposition: {\n\t\t\t\tmy: 'bottom left',\n\t\t\t\tat: 'top center'\n\t\t\t}\n\t\t} );\n\t}\n\n\tselectContextMenu() {\n\t\t//This code is also in HomeViewController\n\t\t//Error: Uncaught TypeError: Cannot read property 'el' of null in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-113526 line 1880\n\t\tif ( TopMenuManager.selected_menu_id !== this.viewId + 'ContextMenu' && TopMenuManager.ribbon_view_controller ) {\n\t\t\tvar ribbon = $( TopMenuManager.ribbon_view_controller.el );\n\t\t\t// Error: Object doesn't support property or method 'tabs' in /interface/html5/views/BaseViewController.js?v=8.0.6-20150417-083849 line 2032\n\t\t\tif ( ribbon ) {\n\t\t\t\tribbon.tabs( 'refresh' );\n\t\t\t\tribbon.find( '[aria-controls=' + this.viewId + 'ContextMenu] a' ).trigger( 'click' );\n\t\t\t}\n\t\t}\n\t}\n\n\topenEditView() {\n\t\tif ( !this.edit_view ) {\n\t\t\tthis.initEditViewUI( this.viewId, this.edit_view_tpl );\n\t\t}\n\t}\n\n\tsetTabOVisibility( flag ) {\n\t\tvar tab0 = $( this.edit_view_tab.find( '.edit-view-tab' )[0] );\n\t\tif ( flag ) {\n\t\t\ttab0.css( 'opacity', 1 );\n\t\t\tthis.setEditViewTabSize();\n\t\t\tif ( this.edit_view_close_icon ) {\n\t\t\t\tthis.edit_view_close_icon.show();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.edit_view_tab.find( 'ul li' ).hide();\n\t\t\ttab0.css( 'opacity', 0 );\n\t\t}\n\t}\n\n\t//set widget disablebility if view mode or edit mode\n\tsetEditViewWidgetsMode() {\n\t\tvar did_clean_dic = {};\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\twidget.css( 'opacity', 1 );\n\t\t\tvar column = widget.parent().parent().parent();\n\t\t\tvar tab_id = column.parent().attr( 'id' );\n\t\t\tif ( !column.hasClass( 'v-box' ) ) {\n\t\t\t\tif ( !did_clean_dic[tab_id] ) {\n\t\t\t\t\tdid_clean_dic[tab_id] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.is_viewing ) {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( false );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif ( Global.isSet( widget.setEnabled ) ) {\n\t\t\t\t\twidget.setEnabled( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//Call this when edit view open\n\tinitEditViewUI( view_id, edit_view_file_name ) {\n\t\tGlobal.setUINotready();\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\n\t\tvar $this = this;\n\t\tif ( this.edit_view ) {\n\t\t\tthis.edit_view.remove();\n\t\t}\n\n\t\tthis.edit_view = $( Global.loadViewSource( view_id, edit_view_file_name, null, true ) );\n\n\t\t//#2353 - commented out because it breaks subgrid menus in the employee qualifications tab\n\t\t//calls the context menu click every time that the edit view is clicked.\n\t\t// this.edit_view.unbind( 'click' ).bind( 'click', function() {\n\t\t// \t$this.selectContextMenu();\n\t\t// } );\n\n\t\tthis.edit_view_tab = $( this.edit_view.find( '.edit-view-tab-bar' ) );\n\t\tthis.edit_view_tab.css( 'opacity', 0 );\n\n\t\t//Give edt view tab a id, so we can load it when put right click menu on it\n\t\tthis.edit_view_tab.attr( 'id', this.ui_id + '_edit_view_tab' );\n\n\t\tthis.setTabOVisibility( false );\n\n\t\tthis.edit_view_tab = this.edit_view_tab.tabs( {\n\t\t\tactivate: function( e, ui ) {\n\t\t\t\tif ( !$this.edit_view_tab || !$this.edit_view_tab.is( ':visible' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t$this.onTabShow( e, ui );\n\t\t\t\tGlobal.triggerAnalyticsTabs( e, ui );\n\t\t\t}\n\t\t} );\n\n\t\tthis.edit_view_tab.off( 'click' ).on( 'click', function( e ) {\n\t\t\t$this.onTabIndexChange( e );\n\t\t} );\n\n\t\tGlobal.contentContainer().append( this.edit_view );\n\n\t\tthis.initRightClickMenu( RightClickMenuType.EDITVIEW );\n\n\t\tthis.buildEditViewUI();\n\n\t\t$this.setEditViewTabHeight();\n\t\tTTPromise.wait( 'init', 'init', function() {\n\t\t\t$( '.edit-view-tab-bar' ).css( 'opacity', 1 );\n\t\t} );\n\t}\n\n\tsetEditViewTabHeight() {\n\t\tvar $this = this;\n\t}\n\n\t//Call this after initEditViewUI, usually after current_edit_record is set\n\tinitEditView() {\n\t\tthis.show_warning_when_validation = false;\n\t\t//Uncaught TypeError: Cannot read property 'find' of null in Timehseet Authorization view when quickly click Cancel from replay\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.setURL();\n\n\t\tthis.setEditMenu(); //This is done in onTabeShow() later on, so it can probably be removed from here?\n\t\t//Remove cover once edit menu is set\n\t\tProgressBar.closeOverlay();\n\n\t\t//Error: Unable to get property 'find' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-074127 line 2055\n\t\tif ( this.edit_view_tab ) {\n\t\t\tthis.edit_view_tab.find( 'ul li' ).show(); // All tabs are hidden when initEditView UI, show all of them before set status\n\t\t}\n\t\tthis.setTabStatus();\n\t\tthis.clearEditViewData();\n\t\tthis.setEditViewWidgetsMode();\n\t\tthis.setEditViewData();\n\t\tthis.setOtherFields();\n\t\tthis.setFocusToFirstInput();\n\t}\n\n\tsetOtherFields() {\n\n\t\tvar $this = this;\n\t\tvar type_id = this.getOtherFieldTypeId();\n\n\t\tif ( type_id === 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar filter = { filter_data: { type_id: type_id } };\n\n\t\tvar tab0 = $( this.edit_view_tab.find( '.edit-view-tab-outside' )[0] );\n\t\tvar tab0_column1 = tab0.find( '.first-column' );\n\n\t\tthis.other_field_api.getOtherField( filter, true, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar res_data = result.getResult();\n\t\t\t\tif ( $.type( res_data ) === 'array' && res_data.length > 0 ) {\n\t\t\t\t\tres_data = res_data[0];\n\n\t\t\t\t\tfor ( var i = 1; i < 10; i++ ) {\n\t\t\t\t\t\tif ( res_data['other_id' + i] ) {\n\t\t\t\t\t\t\t$this.buildOtherFieldUI( 'other_id' + i, res_data['other_id' + i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$this.editFieldResize( 0 );\n\t\t\t\t}\n\n\t\t\t\t$this.resetLastWidgetStyle();\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetOtherFieldReferenceField() {\n\t\treturn false;\n\t}\n\n\tbuildOtherFieldUI( field, label ) {\n\t\t//Not all views have other_id# permissions.\n\t\t//Therefore fail open to allow this to be applied on a per-view basis as permissions are added down the road.\n\t\tvar permission = PermissionManager.getPermissionData();\n\t\tif ( Global.isSet( permission[this.permission_id]['edit_' + field] ) ) {\n\t\t\tif ( PermissionManager.validate( this.permission_id, 'edit_' + field ) == false ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif ( !this.edit_view_tab ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar form_item_input;\n\t\tvar $this = this;\n\t\tvar tab0 = $( this.edit_view_tab.find( '.edit-view-tab-outside' )[0] );\n\t\tvar tab0_column1 = tab0.find( '.first-column' );\n\n\t\tif ( $this.edit_view_ui_dic[field] ) {\n\t\t\tform_item_input = $this.edit_view_ui_dic[field];\n\t\t\tform_item_input.setValue( $this.current_edit_record[field] );\n\t\t} else {\n\t\t\tform_item_input = Global.loadWidgetByName( FormItemType.TEXT_INPUT );\n\t\t\tform_item_input.TTextInput( { field: field } );\n\n\t\t\tvar input_div = $this.addEditFieldToColumn( label, form_item_input, tab0_column1 );\n\t\t\tif ( this.getOtherFieldReferenceField() !== false && $this.edit_view_ui_dic[this.getOtherFieldReferenceField()] != undefined ) {\n\t\t\t\tinput_div.insertBefore( $this.edit_view_ui_dic[this.getOtherFieldReferenceField()].parent().parent() );\n\t\t\t}\n\n\t\t\tif ( this.current_edit_record ) {\n\t\t\t\tform_item_input.setValue( this.current_edit_record[field] );\n\t\t\t}\n\t\t}\n\t\tform_item_input.css( 'opacity', 1 );\n\t\tform_item_input.css( 'minWidth', 300 );\n\n\t\tif ( $this.is_viewing ) {\n\t\t\tform_item_input.setEnabled( false );\n\t\t} else {\n\t\t\tform_item_input.setEnabled( true );\n\t\t}\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tform_item_input.setMassEditMode( true );\n\t\t}\n\t}\n\n\tresetLastWidgetStyle() {\n\n\t\tif ( !this.edit_view_tab || !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\tgetOtherFieldTypeId() {\n\t\tvar res = 0;\n\t\tswitch ( this.viewId ) {\n\t\t\tcase 'Employee':\n\t\t\t\tres = 10;\n\t\t\t\tbreak;\n\t\t\tcase 'Document':\n\t\t\t\tres = 80;\n\t\t\t\tbreak;\n\t\t\tcase 'Job':\n\t\t\t\tres = 20;\n\t\t\t\tbreak;\n\t\t\tcase 'JobItem':\n\t\t\t\tres = 30;\n\t\t\t\tbreak;\n\t\t\tcase 'Product':\n\t\t\t\tres = 60;\n\t\t\t\tbreak;\n\t\t\tcase 'Invoice':\n\t\t\t\tres = 70;\n\t\t\t\tbreak;\n\t\t\tcase 'ClientContact':\n\t\t\t\tres = 55;\n\t\t\t\tbreak;\n\t\t\tcase 'Client':\n\t\t\t\tres = 50;\n\t\t\t\tbreak;\n\t\t\tcase 'UserTitle':\n\t\t\t\tres = 12;\n\t\t\t\tbreak;\n\t\t\tcase 'Department':\n\t\t\t\tres = 5;\n\t\t\t\tbreak;\n\t\t\tcase 'Company':\n\t\t\tcase 'Companies':\n\t\t\t\tres = 2;\n\t\t\t\tbreak;\n\t\t\tcase 'Branch':\n\t\t\t\tres = 4;\n\t\t\t\tbreak;\n\t\t\tcase 'Schedule':\n\t\t\tcase 'ScheduleShift':\n\t\t\t\tres = 18;\n\t\t\t\tbreak;\n\t\t\tcase 'TimeSheet':\n\t\t\tcase 'Punches':\n\t\t\tcase 'InOut':\n\t\t\t\tres = 15;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tsetURL() {\n\t\tvar a = '';\n\t\tswitch ( LocalCacheData.current_doing_context_action ) {\n\t\t\tcase 'new':\n\t\t\tcase 'edit':\n\t\t\tcase 'view':\n\t\t\t\ta = LocalCacheData.current_doing_context_action;\n\t\t\t\tbreak;\n\t\t\tcase 'copy_as_new':\n\t\t\t\ta = 'new';\n\t\t\t\tbreak;\n\t\t}\n\t\tif ( this.canSetURL() ) {\n\n\t\t\tvar tab_name = this.edit_view_tab ? this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().eq( this.getEditViewTabIndex() ).text() : '';\n\t\t\ttab_name = tab_name.replace( /\\/|\\s+/g, '' );\n\n\t\t\t//Error: Unable to get property 'id' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-132941 line 2234\n\t\t\tif ( this.current_edit_record && this.current_edit_record.id ) {\n\t\t\t\tif ( a ) {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + a + '&id=' + this.current_edit_record.id + '&tab=' + tab_name );\n\t\t\t\t} else {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&id=' + this.current_edit_record.id );\n\t\t\t\t}\n\n\t\t\t\tGlobal.trackView( this.viewId, LocalCacheData.current_doing_context_action );\n\t\t\t} else {\n\t\t\t\tif ( a ) {\n\n\t\t\t\t\t//Edit a record which don't have id, schedule view Recurring Scedule\n\t\t\t\t\tif ( a === 'edit' ) {\n\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + 'new' +\n\t\t\t\t\t\t\t'&tab=' + tab_name );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId + '&a=' + a +\n\t\t\t\t\t\t\t'&tab=' + tab_name );\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + '#!m=' + this.viewId );\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tcanSetURL() {\n\t\tif ( this.sub_view_mode || this.edit_only_mode ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetFocusToFirstInput() {\n\t\t//Do not set focus to first input in unit test mode as it causes a blink that is inconsistent in screenshots. Also disable on mobile mode so its not a jarring experience with the zoom changes on each page\n\t\tif ( Global.UNIT_TEST_MODE || $( 'body' ).hasClass( 'mobile-device-mode' ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.is_viewing ) {\n\t\t\tif ( this.script_name === 'ScheduleView' ) {\n\t\t\t\tif ( this.edit_view_ui_dic.start_time ) {\n\t\t\t\t\tthis.edit_view_ui_dic.start_time.children().eq( 0 ).focus();\n\t\t\t\t\tthis.edit_view_ui_dic.start_time.children().eq( 0 )[0].select();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t\t\tif ( widget.is( ':visible' ) === true ) {\n\t\t\t\t\t\tif ( widget.hasClass( 't-text-input' ) && !widget.attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.focus();\n\t\t\t\t\t\t\twidget[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else if ( widget.hasClass( 't-time-picker-div' ) && !widget.children().eq( 0 ).attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.children().eq( 0 ).focus();\n\t\t\t\t\t\t\twidget.children().eq( 0 )[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else if ( widget.hasClass( 't-date-picker-div' ) && !widget.children().eq( 0 ).attr( 'readonly' ) ) {\n\t\t\t\t\t\t\twidget.children().eq( 0 ).focus();\n\t\t\t\t\t\t\twidget.children().eq( 0 )[0].select();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tinitNavigationWidget( navigation_widget_div ) {\n\t\tif ( !this.navigation ) {\n\t\t\tthis.navigation = Global.loadWidgetByName( FormItemType.AWESOME_BOX );\n\t\t\tnavigation_widget_div.append( this.navigation );\n\t\t} else {\n\t\t\tnavigation_widget_div.append( this.navigation );\n\t\t}\n\t}\n\n\tbuildEditViewUI() {\n\t\tvar $this = this;\n\n\t\t//No navigation when edit only mode\n\n\t\tif ( this.edit_view ) {\n\t\t\tif ( !this.edit_only_mode ) {\n\t\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\t\t\t\tvar label = navigation_div.find( '.navigation-label' );\n\t\t\t\tvar left_click = navigation_div.find( '.left-click' );\n\t\t\t\tvar right_click = navigation_div.find( '.right-click' );\n\t\t\t\tvar navigation_widget_div = navigation_div.find( '.navigation-widget-div' );\n\t\t\t\tthis.initNavigationWidget( navigation_widget_div );\n\t\t\t\tleft_click.attr( 'src', Global.getRealImagePath( 'images/left_arrow.png' ) );\n\t\t\t\tright_click.attr( 'src', Global.getRealImagePath( 'images/right_arrow.png' ) );\n\t\t\t\tlabel.text( this.navigation_label );\n\n\t\t\t}\n\n\t\t\tthis.edit_view_close_icon = this.edit_view.find( '.close-icon' );\n\t\t\tthis.edit_view_close_icon.hide();\n\n\t\t\tthis.edit_view_close_icon.click( function() {\n\t\t\t\t$this.onCloseIconClick();\n\t\t\t} );\n\t\t}\n\n\t\tthis.edit_view_ui_dic = {};\n\t\tthis.edit_view_ui_validation_field_dic = {};\n\t\tthis.edit_view_form_item_dic = {};\n\t\tthis.edit_view_error_ui_dic = {};\n\t}\n\n\tonCloseIconClick() {\n\t\tif ( LocalCacheData.current_open_sub_controller ) {\n\t\t\tLocalCacheData.current_open_sub_controller.onCancelClick();\n\t\t} else {\n\t\t\tthis.onCancelClick();\n\t\t}\n\t\tGlobal.triggerAnalyticsNavigationOther( 'close-X', 'click', this.viewId );\n\t}\n\n\tsetWidgetVisible( widgets ) {\n\t\tvar widget = widgets;\n\t\tif ( Global.isArray( widgets ) ) {\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\twidget.css( 'opacity', 1 );\n\t\t\t}\n\t\t} else {\n\t\t\twidget.css( 'opacity', 1 );\n\t\t}\n\t}\n\n\t//widgetContainer: add widget to custom container\n\t//saveFormItemDiv: if cache current formItemDiv and use it later\n\taddEditFieldToColumn( label, widgets, column, firstOrLastRecord, widgetContainer, saveFormItemDiv, setResizeEvent, saveFormItemDivKey, hasKeyEvent, customLabelWidget ) {\n\n\t\tvar $this = this;\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_FORM_ITEM ) );\n\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\t\tvar widget = widgets;\n\n\t\tif ( Global.isArray( widgets ) ) {\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\twidget.css( 'opacity', 0 );\n\t\t\t}\n\t\t} else {\n\t\t\twidget.css( 'opacity', 0 );\n\t\t}\n\n\t\tif ( customLabelWidget ) {\n\t\t\tform_item_label.parent().append( customLabelWidget );\n\t\t\tform_item_label.remove();\n\t\t} else {\n\t\t\tform_item_label.text( label + ': ' );\n\t\t\tif ( label && label.indexOf( '\\n' ) !== -1 ) {\n\t\t\t\tform_item_label.html( form_item_label.html().replace( /\\n/g, '<br>' ) ); //Allow newlines (\\n) to be accepted in labels. Used by T4 Report. Use this instead of .html() directly as its introduces XSS\n\t\t\t}\n\t\t}\n\n\t\tif ( Global.isSet( widgetContainer ) ) {\n\n\t\t\tform_item_input_div.append( widgetContainer );\n\n\t\t} else {\n\t\t\tform_item_input_div.append( widget );\n\t\t}\n\n\t\tcolumn.append( form_item );\n\n\t\t//set height to text area\n\t\tif ( form_item.height() > 35 ) {\n\t\t\tform_item_label_div.css( 'height', form_item.height() );\n\t\t} else if ( widget.hasClass( 'a-dropdown' ) ) {\n\t\t\tform_item_label_div.css( 'height', 240 );\n\t\t}\n\n\t\t//these aren't hit uniformly for every field so the vertical resize events will be disabled in unit test mode.\n\t\tif ( setResizeEvent && !Global.UNIT_TEST_MODE ) {\n\t\t\tform_item.unbind( 'resize' ).bind( 'resize', function() {\n\t\t\t\t//When switching tabs, the heights are all -1, which causes \"flashing\" when the user returns back to the original tab and all the heights need to be set again.\n\t\t\t\t//  To prevent this, only change heights if they are > 0.\n\t\t\t\tif ( form_item_label_div.height() !== form_item.height() && form_item.height() > 0 ) {\n\t\t\t\t\tform_item_label_div.css( 'height', form_item.height() );\n\t\t\t\t}\n\t\t\t} );\n\t\t\twidget.unbind( 'setSize' ).bind( 'setSize', function() {\n\t\t\t\tform_item_label_div.css( 'height', widget.height() + 10 );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !label ) {\n\t\t\tform_item_input_div.remove();\n\t\t\tform_item_label_div.remove();\n\n\t\t\tform_item.append( widget );\n\t\t\twidget.css( 'opacity', 1 );\n\n\t\t\tif ( saveFormItemDiv && saveFormItemDivKey ) {\n\t\t\t\tthis.edit_view_form_item_dic[saveFormItemDivKey] = form_item;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif ( saveFormItemDiv ) {\n\n\t\t\tif ( Global.isArray( widgets ) ) {\n\t\t\t\tthis.edit_view_form_item_dic[widgets[0].getField()] = form_item;\n\t\t\t} else {\n\t\t\t\tthis.edit_view_form_item_dic[widget.getField()] = form_item;\n\t\t\t}\n\n\t\t}\n\t\tif ( Global.isArray( widgets ) ) {\n\n\t\t\tfor ( var i = 0; i < widgets.length; i++ ) {\n\t\t\t\twidget = widgets[i];\n\t\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\t\t\t\tsetValidationDic();\n\n\t\t\t\twidget.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t\t} );\n\n\t\t\t\tif ( hasKeyEvent ) {\n\t\t\t\t\twidget.unbind( 'formItemKeyUp' ).bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t\t} );\n\n\t\t\t\t\twidget.unbind( 'formItemKeyDown' ).bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.edit_view_ui_dic[widget.getField()] = widget;\n\t\t\tsetValidationDic();\n\n\t\t\twidget.bind( 'formItemChange', function( e, target, doNotValidate ) {\n\t\t\t\t$this.onFormItemChange( target, doNotValidate );\n\t\t\t} );\n\n\t\t\tif ( hasKeyEvent ) {\n\t\t\t\twidget.bind( 'formItemKeyUp', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyUp( target );\n\t\t\t\t} );\n\n\t\t\t\twidget.bind( 'formItemKeyDown', function( e, target ) {\n\t\t\t\t\t$this.onFormItemKeyDown( target );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tfunction setValidationDic() {\n\t\t\tif ( widget.hasOwnProperty( 'getValidationField' ) && widget.getValidationField() ) {\n\t\t\t\tif ( $this.edit_view_ui_validation_field_dic[widget.getValidationField()] ) {\n\t\t\t\t\tif ( !Global.isArray( $this.edit_view_ui_validation_field_dic[widget.getValidationField()] ) ) {\n\t\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()] = [$this.edit_view_ui_validation_field_dic[widget.getValidationField()], widget];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()].push( widget );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.edit_view_ui_validation_field_dic[widget.getValidationField()] = widget;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\treturn form_item;\n\t}\n\n\t//Set fields label to same size\n\teditFieldResize( index ) {\n\n\t\tif ( Global.isSet( index ) ) {\n\n\t\t} else {\n\t\t\tindex = this.getEditViewTabIndex();\n\t\t}\n\n\t\tif ( Global.isSet( this.edit_view_tabs[index] ) && !Global.isFalseOrNull( this.edit_view_tabs[index] ) && this.edit_view_tabs[index].length > 0 ) {\n\t\t\tvar tab_div = this.edit_view_tabs[index];\n\t\t\tfor ( var i = 0; i < tab_div.length; i++ ) {\n\t\t\t\tvar tab_column_div = tab_div[i].find( '.edit-view-form-item-label-div' );\n\t\t\t\tvar tab_column_sub_div = tab_div[i].find( '.edit-view-form-item-sub-label-div > span' );\n\t\t\t\tif ( Global.isSet( tab_column_sub_div ) && tab_column_sub_div.length > 0 ) {\n\t\t\t\t\tthis.setEditFieldSize( tab_column_sub_div );\n\t\t\t\t}\n\t\t\t\tthis.setEditFieldSize( tab_column_div );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetEditFieldSize( tab_column_div, width ) {\n\n\t\tif ( Global.isSet( width ) ) {\n\n\t\t\ttab_column_div.each( function() {\n\t\t\t\t$( this ).width( width );\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\tvar item_label_div_width = [];\n\t\t\ttab_column_div.each( function() {\n\n\t\t\t\tif ( $( this ).width() === 0 ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\t$( this ).css( 'width', 'auto' );\n\n\t\t\t\titem_label_div_width.push( $( this ).width() );\n\t\t\t} );\n\n\t\t\titem_label_div_width.sort( function( a, b ) {\n\t\t\t\treturn ( b - a );\n\t\t\t} );\n\n\t\t\ttab_column_div.each( function() {\n\t\t\t\tif ( item_label_div_width[0] >= 0 ) { // #2701 - Do not set width if value is negative. Happens when trying to calculate width of something on another tab not currently visible.\n\t\t\t\t\t$( this ).width( item_label_div_width[0] + 1 );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t}\n\n\tsetNavigation() {\n\n\t\tvar $this = this;\n\n\t\t//Error: Unable to get value of the property 'getGridParam': object is null or undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-103725 line 2575\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.navigation.setPossibleDisplayColumns( this.buildDisplayColumnsByColumnModel( this.grid.getColumnModel() ), this.buildDisplayColumns( this.default_display_columns ) );\n\n\t\tthis.navigation.unbind( 'formItemChange' ).bind( 'formItemChange', function( e, target ) {\n\n\t\t\tvar key = target.getField();\n\t\t\tvar next_select_item_id = target.getValue();\n\n\t\t\tif ( !next_select_item_id ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( next_select_item_id !== $this.current_edit_record.id ) {\n\t\t\t\tProgressBar.showOverlay();\n\n\t\t\t\tif ( $this.is_viewing ) {\n\t\t\t\t\t$this.onViewClick( next_select_item_id ); //Dont refresh UI\n\t\t\t\t} else {\n\t\t\t\t\t$this.onEditClick( next_select_item_id ); //Dont refresh UI\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t$this.setNavigationArrowsEnabled();\n\t\t\tGlobal.triggerAnalyticsEditViewNavigation( 'navigation', $this.viewId );\n\n\t\t} );\n\t}\n\n\tclearEditViewData() {\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( _.isFunction( this.edit_view_ui_dic[key].setEmptyValueAndShowLoading ) ) {\n\t\t\t\tthis.edit_view_ui_dic[key].setEmptyValueAndShowLoading();\n\t\t\t} else {\n\t\t\t\tthis.edit_view_ui_dic[key].setValue( null );\n\t\t\t}\n\t\t\tthis.edit_view_ui_dic[key].clearErrorStyle();\n\t\t}\n\t}\n\n\t//Called after set current_edit_record\n\tsetEditViewData() {\n\t\tthis.is_changed = false;\n\t\tthis.initEditViewData();\n\t\tthis.initTabData();\n\t\tthis.switchToProperTab();\n\t}\n\n\tswitchToProperTab() {\n\t\tif ( LocalCacheData.getAllURLArgs() &&\n\t\t\tLocalCacheData.getAllURLArgs().hasOwnProperty( 'tab' ) &&\n\t\t\tLocalCacheData.getAllURLArgs().tab.length > 0 &&\n\t\t\tLocalCacheData.current_open_primary_controller.viewId === this.viewId ) {\n\n\t\t\tvar target_node = this.edit_view_tab.find( '.edit-view-tab-bar-label' ).children().filter( function() {\n\t\t\t\tvar value = $( this ).text().replace( /\\/|\\s+/g, '' );\n\t\t\t\treturn value === LocalCacheData.getAllURLArgs().tab;\n\t\t\t} );\n\n\t\t\tvar target_index = 0;\n\t\t\tif ( target_node.length > 0 ) {\n\t\t\t\ttarget_node = $( target_node[0] );\n\t\t\t\ttarget_index = target_node.index();\n\t\t\t}\n\t\t\tthis.edit_view_tab.tabs( 'option', 'active', target_index );\n\t\t}\n\t}\n\n\t//Call this from setEditViewData\n\t// This is called to initialize data for the first/primary tab, and is called from many views. So it needs to stay even after fully refactored to use tab_model.\n\tinitTabData() {\n\t\tvar tab_model = this.getTabModel();\n\t\tif ( tab_model != null ) {\n\t\t\tthis.onTabShow();\n\t\t} else {\n\t\t\tvar current_tab_index = this.getEditViewTabIndex();\n\t\t\t//Handle most case that one tab and one audit tab\n\t\t\tif ( current_tab_index === 1 ) {\n\t\t\t\tif ( this.current_edit_record.id && this.current_edit_record.id != TTUUID.zero_id ) {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'block' );\n\t\t\t\t\tthis.initSubLogView( 'tab_audit' );\n\t\t\t\t} else {\n\t\t\t\t\tthis.edit_view_tab.find( '#tab_audit' ).find( '.first-column-sub-view' ).css( 'display', 'none' );\n\t\t\t\t\tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'block' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEditViewTabIndex() {\n\t\treturn this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).index();\n\t}\n\n\tgetEditViewActiveTabName() {\n\t\treturn this.edit_view.find( '.edit-view-tab-bar li.ui-tabs-active' ).attr( 'aria-controls' );\n\t}\n\n\tneedShowNavigation() {\n\t\tif ( this.current_edit_record && Global.isSet( this.current_edit_record.id ) && this.current_edit_record.id ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t//Call this from setEditViewData\n\tinitEditViewData() {\n\t\tvar $this = this;\n\n\t\t//add this.grid to fix exception\n\t\t//Error: Unable to get property 'getGridParam' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-090129 line 2523\n\t\tif ( !this.edit_only_mode && this.navigation && this.grid ) {\n\n\t\t\tvar grid_current_page_items = this.grid.getData();\n\n\t\t\tvar navigation_div = this.edit_view.find( '.navigation-div' );\n\n\t\t\t//Error: TypeError: this.current_edit_record is undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-103725 line 2673\n\t\t\tif ( this.needShowNavigation() ) {\n\t\t\t\tnavigation_div.css( 'display', 'block' );\n\t\t\t\t//Set Navigation Awesomebox\n\n\t\t\t\t//#2349 - update source data every time so that it doesn't go unrefreshed in the case of saving a new record or deleting exiting\n\t\t\t\tthis.navigation.setSourceData( grid_current_page_items );\n\t\t\t\tthis.navigation.setPagerData( this.pager_data );\n\t\t\t\t//init navigation only when open edit view\n\t\t\t\tif ( !this.navigation.getSourceData() ) {\n\t\t\t\t\tif ( LocalCacheData.getLoginUserPreference() ) {\n\t\t\t\t\t\tthis.navigation.setRowPerPage( LocalCacheData.getLoginUserPreference().items_per_page );\n\t\t\t\t\t}\n\t\t\t\t\tthis.navigation.setPagerData( this.pager_data );\n\n\t\t\t\t\tvar default_args = {};\n\t\t\t\t\tdefault_args.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t\t\t\tdefault_args.filter_sort = this.select_layout.data.filter_sort;\n\t\t\t\t\tthis.navigation.setDefaultArgs( default_args );\n\t\t\t\t}\n\n\t\t\t\tthis.navigation.setValue( this.current_edit_record );\n\n\t\t\t} else {\n\t\t\t\tnavigation_div.css( 'display', 'none' );\n\t\t\t}\n\t\t}\n\n\t\tthis.setUIWidgetFieldsToCurrentEditRecord();\n\n\t\tif ( this.is_mass_editing ) {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//JS Exception: \"this.unique_columns.indexOf is not a function\"\n\t\t\t\tif ( this.unique_columns && this.unique_columns.length > 0 && this.unique_columns.indexOf( key ) != -1 ) {\n\t\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '0' );\n\t\t\t\t\tif ( $this.edit_view_ui_dic[key].setEnabled ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[key].setEnabled( false );\n\t\t\t\t\t}\n\t\t\t\t\tif ( $this.edit_view_ui_dic[key].setMassEditMode ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[key].setMassEditMode( false );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\t\t\tif ( Global.isSet( widget.setMassEditMode ) ) {\n\t\t\t\t\t\twidget.setMassEditMode( true );\n\t\t\t\t\t}\n\t\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '1' );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\t\t$this.edit_view_ui_dic[key].css( 'opacity', '1' );\n\t\t\t}\n\t\t}\n\n\t\tthis.setNavigationArrowsStatus();\n\n\t\t// Create this function alone because of the column value of view is different from each other, some columns need to be handle specially. and easily to rewrite this function in sub-class.\n\n\t\tthis.setCurrentEditRecordData();\n\n\t\t//Init *Please save this record before modifying any related data* box\n\t\tthis.edit_view.find( '.save-and-continue-div' ).SaveAndContinueBox( { related_view_controller: this } );\n\t\tthis.edit_view.find( '.save-and-continue-div' ).css( 'display', 'none' );\n\t}\n\n\tsetUIWidgetFieldsToCurrentEditRecord() {\n\n\t\tvar $this = this;\n\t\t$this.current_edit_record === true && ( $this.current_edit_record = {} );\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n//\t\t\t//Set all UI field to current edit record, we need validate all UI field when save and validate\n\t\t\t//use != to ingore string or number, value from html is string.\n\t\t\t//Error: TypeError: $this.current_edit_record is undefined in /interface/html5/views/BaseViewController.js?v=8.0.0-20141117-122453 line 2702\n\t\t\tif ( $this.current_edit_record && !Global.isSet( $this.current_edit_record[key] ) ) {\n\t\t\t\t$this.current_edit_record[key] = false;\n\t\t\t}\n\n\t\t}\n\t}\n\n\t/**\n\t * Set default data into current_edit_record\n\t *\n\t * @param columnsArr\n\t * @param force\n\t *\n\t * if force is true set the current_edit_record and populate edit_view_ui_dic\n\t * this is used in view controllers (RequestViewController::setRequestFormDefaultData) where the api call for default values is late\n\t *\n\t */\n\tsetDefaultData( columnsArr, force ) {\n\t\tvar $this = this;\n\t\t$.each( columnsArr, function( field, value ) {\n\t\t\tif ( force != true && Global.isSet( $this.current_edit_record[field] ) ) {\n\t\t\t\t//do nothing\n\t\t\t} else {\n\t\t\t\tif ( force == true ) {\n\t\t\t\t\tif ( $this.edit_view_ui_dic[field] ) {\n\t\t\t\t\t\t$this.edit_view_ui_dic[field].setValue( value );\n\t\t\t\t\t\t$this.current_edit_record[field] = value;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t$this.current_edit_record[field] = value;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tcollectUIDataToCurrentEditRecord() {\n\t\tif ( this.is_mass_editing ) {\n\t\t\treturn;\n\t\t}\n\t\tvar $this = this;\n\t\tfor ( var key in this.edit_view_ui_dic ) {\n\n\t\t\tif ( !this.edit_view_ui_dic.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\n\t\t\t//only check dropdownlist\n\t\t\tif ( !widget.hasClass( 't-select' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar value = widget.getValue();\n\n//\t\t\t//Set all UI field to current edit record, we need validate all UI field when save and validate\n\t\t\t//use != to ingore string or number, value from html is string.\n\t\t\t//is visible make sure the widget is shown on screen of current select type\n\n\t\t\t//Error: TypeError: undefined is not an object (evaluating '$this.current_edit_record[key]') in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-124906 line 2792\n\t\t\tif ( value && $this.current_edit_record && $this.current_edit_record[key] != value ) {\n\n\t\t\t\tif ( !value || value === '0' || ( Global.isArray( value ) && value.length === 0 ) ) {\n\t\t\t\t\t$this.current_edit_record[key] = false;\n\t\t\t\t} else {\n\t\t\t\t\t$this.current_edit_record[key] = value;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsetCurrentEditRecordData() {\n\t\t//Set current edit record data to all widgets\n\t\tfor ( var key in this.current_edit_record ) {\n\n\t\t\tif ( !this.current_edit_record.hasOwnProperty( key ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar widget = this.edit_view_ui_dic[key];\n\t\t\tif ( Global.isSet( widget ) ) {\n\t\t\t\tswitch ( key ) {\n\t\t\t\t\tcase 'country': //popular case\n\t\t\t\t\t\tthis.setCountryValue( widget, key );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\twidget.setValue( this.current_edit_record[key] );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tthis.collectUIDataToCurrentEditRecord();\n\t\tthis.setEditViewDataDone();\n\t}\n\n\tsetCountryValue( widget, key ) {\n\t\tif ( !this.current_edit_record['province'] ) {\n\t\t\tthis.eSetProvince( this.current_edit_record[key], true );\n\t\t} else {\n\t\t\tthis.eSetProvince( this.current_edit_record[key] );\n\t\t}\n\t\twidget.setValue( this.current_edit_record[key] );\n\t}\n\n\tputInputToInsideFormItem( form_item_input, label ) {\n\t\tvar form_item = $( Global.loadWidgetByName( WidgetNamesDic.EDIT_VIEW_SUB_FORM_ITEM ) );\n//\t\tvar form_item_label_div = form_item.find( '.edit-view-form-item-label-div' );\n//\n//\t\tform_item_label_div.attr( 'class', 'edit-view-form-item-sub-label-div' );\n\n\t\tvar form_item_label = form_item.find( '.edit-view-form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.edit-view-form-item-input-div' );\n\t\tform_item.addClass( 'remove-margin' );\n\n\t\tform_item_label.text( $.i18n._( label ) + ': ' );\n\n\t\tform_item_input_div.append( form_item_input );\n\n\t\treturn form_item;\n\t}\n\n\t//set tab 0 visible after all data set done. This be hide when init edit view data\n\tsetEditViewDataDone() {\n\t\t// Remove this on 14.9.14 because adding tab url support, ned set url when tab index change and\n\t\t// need know waht's current doing action. See if this cause any problem\n\t\t//LocalCacheData.current_doing_context_action = '';\n\t\tthis.setTabOVisibility( true );\n\t\tTTPromise.resolve( 'init', 'init' );\n\n\t\t$( '.edit-view-tab-bar' ).css( 'opacity', 1 );\n\t}\n\n\tsetNavigationArrowsStatus() {\n\t\tif ( !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar left_arrow = this.edit_view.find( '.left-click' );\n\t\tvar right_arrow = this.edit_view.find( '.right-click' );\n\t\tvar $this = this;\n\n\t\tleft_arrow.unbind( 'click' ).click( function() {\n\n\t\t\tif ( !left_arrow.hasClass( 'disabled' ) ) {\n\t\t\t\t$this.onLeftArrowClick();\n\t\t\t}\n\n\t\t} );\n\n\t\tright_arrow.unbind( 'click' ).click( function() {\n\n\t\t\tif ( !right_arrow.hasClass( 'disabled' ) ) {\n\t\t\t\t$this.onRightArrowClick();\n\t\t\t}\n\n\t\t} );\n\n\t\tthis.setNavigationArrowsEnabled();\n\t}\n\n\tsetNavigationArrowsEnabled() {\n\t\tif ( !this.edit_view ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar left_arrow = this.edit_view.find( '.left-click' );\n\t\tvar right_arrow = this.edit_view.find( '.right-click' );\n\n\t\tleft_arrow.removeClass( 'disabled' );\n\t\tright_arrow.removeClass( 'disabled' );\n\n\t\t//TypeError: this.navigation.getSelectIndex is not a function\n\t\t//navigation could not be initial in cases, for example in Request new view\n\t\tif ( !this.navigation || !( this.navigation.hasOwnProperty( 'getSelectIndex' ) ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar selected_index = this.navigation.getSelectIndex();\n\t\tvar source_data = this.navigation.getSourceData();\n\n\t\tif ( !source_data ) {\n\t\t\t//No records in navigation box, so make sure arrows are disbled.\n\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\treturn;\n\t\t}\n\n\t\tvar current_pager_data = this.navigation.getPagerData();\n\n\t\t// It's possible the navigation don't have a pager data, like Timesheet edit view, so it's become a no page navigation.\n\t\tif ( !current_pager_data ) {\n\t\t\tif ( selected_index === 0 ) {\n\t\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\t}\n\n\t\t\tif ( selected_index === source_data.length - 1 ) {\n\t\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( selected_index === 0 && current_pager_data.current_page === 1 ) {\n\t\t\t\tleft_arrow.addClass( 'disabled' );\n\t\t\t}\n\n\t\t\tif ( selected_index === source_data.length - 1 && current_pager_data.current_page === current_pager_data.last_page_number ) {\n\t\t\t\tright_arrow.addClass( 'disabled' );\n\t\t\t}\n\t\t}\n\t}\n\n\tonLeftArrowClick( cancel_callback ) {\n\t\tvar $this = this;\n\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\tdoLeftArrowClick();\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tdoLeftArrowClick();\n\t\t}\n\n\t\tGlobal.triggerAnalyticsEditViewNavigation( 'left-arrow', this.viewId );\n\n\t\tfunction doLeftArrowClick() {\n\t\t\tvar selected_index = $this.navigation.getSelectIndex();\n\t\t\tvar source_data = $this.navigation.getSourceData();\n\t\t\tvar current_pager_data = $this.navigation.getPagerData();\n\t\t\tvar next_select_item;\n\t\t\tif ( selected_index > 0 ) {\n\t\t\t\tnext_select_item = $this.navigation.getItemByIndex( selected_index - 1 );\n\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t} else if ( selected_index === 0 && current_pager_data && current_pager_data.current_page > 1 ) {\n\t\t\t\t$this.navigation.onADropDownSearch( 'unselect_grid', current_pager_data.current_page - 1, 'last', function( result ) {\n\t\t\t\t\tnext_select_item = result;\n\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.onCancelClick( null, null, cancel_callback );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\trefreshCurrentRecord() {\n\t\tvar next_select_item = this.navigation.getItemByIndex( this.navigation.getSelectIndex() );\n\t\tProgressBar.showOverlay();\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.onViewClick( next_select_item.id ); //Dont refresh UI\n\t\t} else {\n\t\t\tthis.onEditClick( next_select_item.id ); //Dont refresh UI\n\t\t}\n\n\t\tthis.setNavigationArrowsEnabled();\n\t}\n\n\t//exists for RecurringScheduleControlView due to the unique way we handle the ids there.\n\tgetRightArrowClickSelectedIndex( selected_index ) {\n\t\treturn selected_index;\n\t}\n\n\tonRightArrowClick( cancel_callback ) {\n\t\tvar $this = this;\n\t\tif ( this.is_changed ) {\n\t\t\tTAlertManager.showConfirmAlert( Global.modify_alert_message, null, function( flag ) {\n\t\t\t\tif ( flag === true ) {\n\t\t\t\t\t$this.is_changed = false;\n\t\t\t\t\tdoRightArrowClick();\n\t\t\t\t}\n\t\t\t\tProgressBar.closeOverlay();\n\t\t\t} );\n\t\t} else {\n\t\t\tdoRightArrowClick();\n\t\t}\n\n\t\tGlobal.triggerAnalyticsEditViewNavigation( 'right-arrow', this.viewId );\n\n\t\tfunction doRightArrowClick() {\n\t\t\tvar selected_index = $this.getRightArrowClickSelectedIndex( $this.navigation.getSelectIndex() );\n\t\t\tvar source_data = $this.navigation.getSourceData();\n\t\t\tvar current_pager_data = $this.navigation.getPagerData();\n\t\t\tvar next_select_item;\n\t\t\t//Error: Uncaught TypeError: Cannot read property 'length' of null in /interface/html5/views/BaseViewController.js?v=8.0.0-20141230-125919 line 2956\n\t\t\tif ( !source_data ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( selected_index < ( source_data.length - 1 ) ) {\n\t\t\t\t// next_select_item = $this.navigation.getItemByIndex( (selected_index + 1) );\n\t\t\t\tnext_select_item = $this.navigation.getItemByIndex( $this.navigation.getSelectIndex() + 1 );\n\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\n\t\t\t\t//Error: Unable to get property 'current_page' of undefined or null reference in interface/html5/views/BaseViewController.js?v=9.0.0-20151016-102254 line 3204\n\t\t\t} else if ( selected_index === ( source_data.length - 1 ) && current_pager_data && current_pager_data.current_page < current_pager_data.last_page_number ) {\n\t\t\t\t$this.navigation.onADropDownSearch( 'unselect_grid', current_pager_data.current_page + 1, 'first', function( result ) {\n\t\t\t\t\tnext_select_item = result;\n\t\t\t\t\t$this.onRightOrLeftArrowClickCallBack( next_select_item );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\t$this.onCancelClick( null, null, cancel_callback );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tonRightOrLeftArrowClickCallBack( next_select_item ) {\n\t\tProgressBar.showOverlay();\n\t\tif ( this.is_viewing ) {\n\t\t\tthis.onViewClick( next_select_item ); //Dont refresh UI\n\t\t} else {\n\t\t\tthis.onEditClick( next_select_item.id ); //Dont refresh UI\n\t\t}\n\t\tthis.setNavigationArrowsEnabled();\n\t\tif ( this.sub_log_view_controller ) {\n\t\t\tthis.sub_log_view_controller.search();\n\t\t}\n\t}\n\n\tsetParentContextMenuAfterSubViewClose() {\n\t\t//Error: Uncaught TypeError: Cannot read property 'buildContextMenu' of null in /interface/html5/views/BaseViewController.js?v=7.4.6-20141027-085016 line 2887\n\t\tif ( !this.parent_view_controller ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.parent_view_controller.buildContextMenu();\n\n\t\tif ( this.parent_view_controller.edit_view ) {\n\t\t\tthis.parent_view_controller.setEditMenu();\n\t\t} else {\n\t\t\tthis.parent_view_controller.setDefaultMenu();\n\t\t}\n\t}\n\n\t//This should only be used on its own if removeEditView is causing flashing.\n\t//This function should only really be called from onViewClick (see RequestViewCommonController.js)\n\tclearEditView() {\n\t\tif ( this.edit_view ) {\n\t\t\tthis.clearErrorTips();\n\t\t\tthis.edit_view.remove();\n\t\t}\n\t\tthis.edit_view = null;\n\t\tthis.edit_view_tab = null;\n\t}\n\n\tremoveEditView() {\n\t\tthis.clearEditView();\n\t\tthis.setCurrentEditViewState( '' );\n\t\tthis.is_changed = false;\n\t\tthis.confirm_on_exit = false;\n\t\tthis.mass_edit_record_ids = [];\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tvar current_url = window.location.href;\n\t\t\tif ( current_url.indexOf( '&sm' ) > 0 ) {\n\t\t\t\tcurrent_url = current_url.substring( 0, current_url.indexOf( '&sm' ) );\n\t\t\t\tGlobal.setURLToBrowser( current_url );\n\t\t\t}\n\n\t\t\tLocalCacheData.current_open_edit_only_controller = null;\n\t\t}\n\n\t\t// reset parent context menu if edit only mode\n\n\t\tif ( !this.edit_only_mode ) {\n\t\t\t//#2777 - If the user goes to Employee -> Employees, click on Wage tab, then goes to Employee -> Employees again, the Context Menu will be incorrect and still be for the \"Wage\" record and not the proper \"Employee\" record.\n\t\t\t//This tries to detect when the context menu doesn't match the view and forces it to be rebuilt completely.\n\t\t\tif ( TopMenuManager.selected_menu_id + 'ContextMenu' != LocalCacheData.currentShownContextMenuName ) {\n\t\t\t\tthis.buildContextMenu( true );\n\t\t\t}\n\t\t\tthis.setDefaultMenu();\n\t\t} else {\n\t\t\tthis.setParentContextMenuAfterSubViewClose();\n\t\t}\n\t\tthis.reSetURL();\n\t\t//If there is a action in url, add it back. So we have correct url when set tabs urls\n\t\t//This caused a bug where whenever saving a punch on Attendance ->TimeSheet, it would re-open the edit view, same with navigating between weeks, or even deleting punches in some cases.\n\t\t//This need to put under reSetUrl and need clean url_agrs until it set from onViewChange in router again\n\t\tif ( LocalCacheData.getAllURLArgs() && LocalCacheData.getAllURLArgs().a ) {\n\t\t\tLocalCacheData.current_doing_context_action = LocalCacheData.getAllURLArgs().a;\n\t\t}\n\n\t\tthis.sub_log_view_controller = null;\n\t\tthis.edit_view_ui_dic = {};\n\t\tthis.edit_view_ui_validation_field_dic = {};\n\t\tthis.edit_view_form_item_dic = {};\n\t\tthis.edit_view_error_ui_dic = {};\n\t\tthis.current_edit_record = null;\n\n\t\tif ( this.sub_document_view_controller ) {\n\t\t\tthis.sub_document_view_controller = null;\n\t\t}\n\t}\n\n\treSetURL() {\n\t\tif ( this.canSetURL() ) {\n\t\t\tvar args = '#!m=' + this.viewId;\n\t\t\tGlobal.setURLToBrowser( Global.getBaseURL() + args );\n\t\t\tLocalCacheData.setAllURLArgs( Global.buildArgDic( args.split( '&' ) ) );\n\t\t}\n\t}\n\n\tgetGridSelectIdArray() {\n\t\tif ( !this.grid ) {\n\t\t\treturn []; //Return empty array so .length on the result doesn't fail with Cannot read property 'length' of undefined\n\t\t}\n\n\t\treturn this.grid.getSelectedRows();\n\t}\n\n\tsetDefaultMenuAddIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 && this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuViewIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 && this.viewOwnerOrChildPermissionValidate() ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuMassEditIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length > 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuCopyIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.copyPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length >= 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuDeleteIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length >= 1 && this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuSaveIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.addPermissionValidate( pId ) && !this.editPermissionValidate( pId ) ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.addPermissionValidate( pId ) && !this.editPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.addPermissionValidate( pId ) && !this.editPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.addPermissionValidate( pId ) && !this.editPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.addPermissionValidate( pId ) && !this.editPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( ( !this.copyAsNewPermissionValidate( pId ) ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( grid_selected_length === 1 ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuLoginIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !PermissionManager.validate( 'company', 'login_other_user' ) ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.getGridSelectIdArray().length !== 1 ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuCancelIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuExportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t} else if ( grid_selected_length == 0 || this.is_add || this.is_viewing || this.is_mass_adding || this.is_edit || this.grid == undefined ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuImportIcon( context_btn, grid_selected_length, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetDefaultMenuPermissionWizardIcon( context_btn, pId ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetEditMenuPermissionWizardIcon( context_btn, pId ) {\n\t}\n\n\tsetEditMenuImportIcon( context_btn, pId ) {\n\t\tif ( this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetEditMenuAddIcon( context_btn, pId ) {\n\t\tif ( !this.addPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( this.is_add == true ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( !this.is_viewing || !this.editOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuNavEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetEditMenuNavViewIcon( context_btn, pId ) {\n\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetEditMenuViewIcon( context_btn, pId ) {\n\t\tif ( !this.viewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetEditMenuMassEditIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\tsetEditMenuDeleteIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || !this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuDeleteAndNextIcon( context_btn, pId ) {\n\t\tif ( !this.deletePermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || !this.deleteOwnerOrChildPermissionValidate( pId ) ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuCopyIcon( context_btn, pId ) {\n\t\tif ( !this.copyPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( !this.current_edit_record || !this.current_edit_record.id ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuCopyAndAddIcon( context_btn, pId ) {\n\t\tif ( !this.copyAsNewPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuSaveIcon( context_btn, pId ) {\n\n\t\tthis.saveValidate( context_btn, pId );\n\n\t\tif ( this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndContinueIcon( context_btn, pId ) {\n\t\tthis.saveAndContinueValidate( context_btn, pId );\n\n\t\tif ( this.is_mass_adding || this.is_mass_editing || this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndCopyIcon( context_btn, pId ) {\n\t\tthis.saveAndCopyValidate( context_btn, pId );\n\n\t\tif ( this.is_mass_editing || this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndNextIcon( context_btn, pId ) {\n\t\tif ( !this.editPermissionValidate( pId ) || this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) || this.is_viewing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuSaveAndAddIcon( context_btn, pId ) {\n\t\tthis.saveAndNewValidate( context_btn, pId );\n\n\t\tif ( this.is_viewing || this.is_mass_editing ) {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuCancelIcon( context_btn, pId ) {\n\t}\n\n\tifContextButtonExist( value ) {\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tif ( id === value && !context_btn.hasClass( 'invisible-image' ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t//Call this when select grid row\n\t//Call this when setLayout\n\tsetDefaultMenu( doNotSetFocus ) {\n\t\t//Check if there is a current_company object at all.\n\t\tif ( LocalCacheData.isLocalCacheExists( 'current_company' ) == false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( !Global.isSet( doNotSetFocus ) || !doNotSetFocus ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\t//Error: Uncaught TypeError: Cannot read property 'length' of undefined in /interface/html5/#!m=Client line 308\n\t\tif ( !this.context_menu_array ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tvar len = this.context_menu_array.length;\n\n\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\n\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setDefaultMenuAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setDefaultMenuEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setDefaultMenuViewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setDefaultMenuMassEditIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setDefaultMenuCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setDefaultMenuDeleteIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setDefaultMenuDeleteAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setDefaultMenuSaveIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setDefaultMenuSaveAndNextIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setDefaultMenuSaveAndContinueIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setDefaultMenuSaveAndAddIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setDefaultMenuSaveAndCopyIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setDefaultMenuCopyAsNewIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.login:\n\t\t\t\t\tthis.setDefaultMenuLoginIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tthis.setDefaultMenuCancelIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\t\tthis.setDefaultMenuImportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.permission_wizard:\n\t\t\t\t\tthis.setDefaultMenuPermissionWizardIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.map:\n\t\t\t\t\tthis.setDefaultMenuMapIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.setCustomDefaultMenuIcon( id, context_btn, grid_selected_length );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetCustomDefaultMenuIcon( id, context_btn, grid_selected_length ) {\n\t\treturn false; //FALSE tells setCustomDefaultMenuIcon() to keep processing.\n\t}\n\n\tsetEditMenu() {\n\t\t//this.selectContextMenu(); //This is done in setContextMenuGroupVisibility() at the bottom of this function instead, which makes more sense since thats after the permission checks are done.\n\t\tvar len = this.context_menu_array.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t\tcontext_btn.removeClass( 'invisible-image' );\n\n\t\t\tif ( this.is_mass_editing ) {\n\t\t\t\tswitch ( id ) {\n\t\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tthis.setEditMenuAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tthis.setEditMenuEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tthis.setEditMenuViewIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.mass_edit:\n\t\t\t\t\tthis.setEditMenuMassEditIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy:\n\t\t\t\t\tthis.setEditMenuCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_icon:\n\t\t\t\t\tthis.setEditMenuDeleteIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.delete_and_next:\n\t\t\t\t\tthis.setEditMenuDeleteAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save:\n\t\t\t\t\tthis.setEditMenuSaveIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_continue:\n\t\t\t\t\tthis.setEditMenuSaveAndContinueIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_new:\n\t\t\t\t\tthis.setEditMenuSaveAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_next:\n\t\t\t\t\tthis.setEditMenuSaveAndNextIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.save_and_copy:\n\t\t\t\t\tthis.setEditMenuSaveAndCopyIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.copy_as_new:\n\t\t\t\t\tthis.setEditMenuCopyAndAddIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.import_icon:\n\t\t\t\t\tthis.setEditMenuImportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.permission_wizard:\n\t\t\t\t\tthis.setEditMenuPermissionWizardIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.login:\n\t\t\t\t\tthis.setEditMenuLoginIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.map:\n\t\t\t\t\tthis.setEditMenuMapIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t\tcase ContextMenuIconName.export_excel:\n\t\t\t\t\tthis.setDefaultMenuExportIcon( context_btn );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tthis.setContextMenuGroupVisibility();\n\t}\n\n\tsetDefaultMenuMapIcon( context_btn ) {\n\t\tif ( Global.getProductEdition() <= 10 ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\n\t\tvar show = false;\n\t\tif ( this.grid ) {\n\t\t\tvar selected_items = this.getSelectedItems();\n\t\t\tDebug.Arr( selected_items, 'selected items', 'BaseViewController.js', 'BaseViewController', 'setDefaultMenuMapIcon', 10 );\n\t\t\tif ( selected_items.length > 0 ) {\n\t\t\t\tfor ( var x = 0; x < selected_items.length; x++ ) {\n\t\t\t\t\tif ( selected_items[x] && selected_items[x].latitude && selected_items[x].longitude ) {\n\t\t\t\t\t\tshow = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( show ) {\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\t\t} else {\n\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t}\n\t}\n\n\tsetEditMenuMapIcon( context_btn ) {\n\t\tthis.setDefaultMenuMapIcon( context_btn );\n\t}\n\n\tsetEditMenuLoginIcon( context_btn ) {\n\t\tcontext_btn.addClass( 'disable-image' );\n\t}\n\n\t//Disable context menu if no visible item\n\tsetContextMenuGroupVisibility() {\n\n\t\tvar ribbon_menu = Global.topContainer().find( '#' + this.viewId + 'ContextMenu' );\n\t\tvar menus = ribbon_menu.find( '.menu' );\n\n\t\tvar len = menus.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar menu = $( menus[i] );\n\t\t\tvar li_array = menu.find( 'li' );\n\n\t\t\tvar all_invisible = true;\n\n\t\t\tvar li_len = li_array.length;\n\n\t\t\tfor ( var j = 0; j < li_len; j++ ) {\n\t\t\t\tvar li = $( li_array[j] );\n\t\t\t\tif ( !li.hasClass( 'invisible-image' ) ) {\n\t\t\t\t\tall_invisible = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( all_invisible ) {\n\t\t\t\tmenu.addClass( 'invisible-image' );\n\t\t\t} else {\n\t\t\t\tmenu.removeClass( 'invisible-image' );\n\t\t\t}\n\n\t\t}\n\n\t\t//go context menu after everything set done\n\t\tif ( this.need_switch_to_context_menu ) {\n\t\t\tthis.selectContextMenu();\n\t\t}\n\n\t\t//set right click menu to list view grid\n\t\tthis.initRightClickMenu();\n\t}\n\n\tsetErrorMenu() {\n\t\tvar len = this.context_menu_array.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).attr( 'id' );\n\t\t\tcontext_btn.removeClass( 'disable-image' );\n\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.cancel:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tcontext_btn.addClass( 'disable-image' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\t}\n\n\trender() {\n\t\tvar $this = this;\n\n\t\t$( window ).resize( function() {\n\t\t\tif ( $this.edit_view ) {\n\t\t\t\t$this.setEditViewTabSize();\n\t\t\t}\n\t\t} );\n\n\t\t//Create search panel only when show as a main view\n\n\t\tif ( !this.sub_view_mode && !this.edit_only_mode && !this.tree_mode ) {\n\t\t\tvar searchPanelWidget = Global.loadWidget( 'global/widgets/search_panel/SearchPanel.html' );\n\t\t\tvar search_panel_w = $( searchPanelWidget );\n\n\t\t\t$( this.el ).prepend( search_panel_w );\n\n\t\t\tif ( !this.show_search_tab ) {\n\t\t\t\tsearch_panel_w.hide();\n\t\t\t}\n\n\t\t\tthis.search_panel = search_panel_w.SearchPanel( { viewController: this } );\n\n\t\t\tthis.search_panel.on( 'searchTabSelect', function() {\n\t\t\t\t$this.onSearchTabSelect;\n\t\t\t} );\n\n\t\t\tthis.buildSearchFields();\n\n\t\t\tthis.buildBasicSearchUI();\n\n\t\t\tthis.buildAdvancedSearchUI();\n\n\t\t\tthis.buildSearchAndLayoutUI();\n\n\t\t\t//Work around that the li offset is empty in chrome\n\t\t\tsetTimeout( function() {\n\t\t\t\t$this.setCurrentViewPosition();\n\n\t\t\t}, 500 );\n\n\t\t}\n\t}\n\n\tsetCurrentViewPosition() {\n\t\tvar current_view_div = this.search_panel.find( '.layout-selector-div' );\n\t\tvar saved_layout_li = this.search_panel.find( 'a[ref=\\'saved_layout\\']' ).parent();\n\t\t// Error: Unable to get property 'left' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.6-20150417-083849 line 3691\n\t\tif ( !current_view_div || !saved_layout_li || !saved_layout_li.offset() ) {\n\t\t\treturn;\n\t\t}\n\t\tcurrent_view_div.css( 'left', saved_layout_li.offset().left + saved_layout_li.width() + 20 );\n\t}\n\n\t//Build fields when search tab change\n\tonSearchTabSelect( e, e1, ui ) {\n\t\tvar tab_id = $( ui ).prop( 'id' );\n\n\t\tswitch ( tab_id ) {\n\t\t\tcase 'basic_search':\n\n\t\t\t\tif ( this.search_panel.getLastSelectTabId() !== 'saved_layout' ) {\n\t\t\t\t\tthis.getSearchPanelFilter( 1, true );\n\t\t\t\t\tthis.buildBasicSearchUI();\n\t\t\t\t\tthis.setSearchPanelFilter( false, 0 );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'adv_search':\n\t\t\t\tif ( this.search_panel.getLastSelectTabId() !== 'saved_layout' ) {\n\t\t\t\t\tthis.getSearchPanelFilter( 0, true );\n\t\t\t\t\tthis.buildAdvancedSearchUI();\n\t\t\t\t\tthis.setSearchPanelFilter( false, 1 );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'saved_layout':\n\t\t\t\tthis.getSearchPanelFilter( this.search_panel.getLastSelectTabIndex() );\n\t\t}\n\t}\n\n\tinitDropDownOptions( options, callBack ) {\n\t\tvar len = options.length;\n\t\tvar complete_count = 0;\n\t\tvar option_result = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar option_info = options[i];\n\n\t\t\tthis.initDropDownOption( option_info.option_name, option_info.field_name, option_info.api, onGetOptionResult );\n\n\t\t}\n\n\t\tfunction onGetOptionResult( result ) {\n\n\t\t\toption_result.push( result );\n\n\t\t\tcomplete_count = complete_count + 1;\n\n\t\t\tif ( complete_count === len ) {\n\n\t\t\t\tcallBack( option_result );\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildWidgetContainerWithTextTip( widget, tip ) {\n\t\tvar h_box = $( '<div class=\\'h-box\\'></div>' );\n\n\t\tvar text_box = Global.loadWidgetByName( FormItemType.TEXT );\n\t\ttext_box.css( 'margin-left', '10px' );\n\t\ttext_box.TText();\n\t\ttext_box.setValue( tip );\n\n\t\th_box.append( widget );\n\t\th_box.append( text_box );\n\n\t\treturn h_box;\n\t}\n\n\t//Set option list for search panel and edit view\n\tinitDropDownOption( option_name, field_name, api, callBack, array_name ) {\n\t\tvar $this = this;\n\t\tif ( !Global.isSet( api ) ) {\n\t\t\tapi = this.api;\n\t\t}\n\n\t\tif ( !Global.isSet( field_name ) || !field_name ) {\n\t\t\tfield_name = option_name + '_id';\n\t\t}\n\t\tapi.getOptions( option_name, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tvar result = res.getResult();\n\n\t\t\t\tif ( array_name ) {\n\t\t\t\t\t$this[array_name] = Global.buildRecordArray( result );\n\t\t\t\t} else {\n\n\t\t\t\t\t$this[option_name + '_array'] = Global.buildRecordArray( result );\n\t\t\t\t}\n\n\t\t\t\tif ( !$this.sub_view_mode ) {\n\n\t\t\t\t\tif ( Global.isSet( $this.basic_search_field_ui_dic[field_name] ) ) {\n\t\t\t\t\t\t$this.basic_search_field_ui_dic[field_name].setSourceData( Global.buildRecordArray( result ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Global.isSet( $this.adv_search_field_ui_dic[field_name] ) ) {\n\t\t\t\t\t\t$this.adv_search_field_ui_dic[field_name].setSourceData( Global.buildRecordArray( result ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( Global.isSet( callBack ) ) {\n\t\t\t\t\tcallBack( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tclearSearchPanel() {\n\n\t\tfor ( var key in this.basic_search_field_ui_dic ) {\n\t\t\tvar search_input = this.basic_search_field_ui_dic[key];\n\t\t\tsearch_input.setValue( null );\n\t\t}\n\n\t\tfor ( var key in this.adv_search_field_ui_dic ) {\n\t\t\tsearch_input = this.adv_search_field_ui_dic[key];\n\t\t\tsearch_input.setValue( null );\n\t\t}\n\t}\n\n\tonSearch() {\n\t\tTTPromise.add( 'init', 'init' );\n\t\tTTPromise.wait();\n\n\t\tvar do_update = false;\n\n\t\t//don't keep temp filter any more, set them when change tab\n\t\tthis.temp_adv_filter_data = null;\n\t\tthis.temp_basic_filter_data = null;\n\t\tthis.getSearchPanelFilter();\n\t\tif ( this.search_panel.getLayoutsArray() && this.search_panel.getLayoutsArray().length > 0 ) {\n\t\t\tvar default_layout_id = $( this.previous_saved_layout_selector ).children( 'option:contains(\\'' + BaseViewController.default_layout_name + '\\')' ).attr( 'value' );\n\n\t\t\tif ( !default_layout_id ) {\n\t\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar layout_name = BaseViewController.default_layout_name;\n\n\t\t} else if ( this.show_search_tab ) {\n\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\treturn;\n\t\t} else if ( !this.show_search_tab ) {\n\t\t\tthis.search();\n\t\t\tthis.setGridHeaderStyle();\n\t\t\treturn;\n\t\t}\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\n\t\tvar filter_data = this.getValidSearchFilter();\n\n\t\tvar args = {};\n\t\targs.id = default_layout_id;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tProgressBar.showOverlay();\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t}\n\n\tonClearSearch() {\n\t\tvar do_update = false;\n\t\tif ( this.search_panel.getLayoutsArray() && this.search_panel.getLayoutsArray().length > 0 ) {\n\t\t\tvar default_layout_id = $( this.previous_saved_layout_selector ).children( 'option:contains(\\'' + BaseViewController.default_layout_name + '\\')' ).attr( 'value' );\n\n\t\t\tif ( !default_layout_id ) {\n\t\t\t\tthis.clearSearchPanel();\n\t\t\t\tthis.filter_data = null;\n\t\t\t\tthis.temp_adv_filter_data = null;\n\t\t\t\tthis.temp_basic_filter_data = null;\n\t\t\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\t\t\t\tthis.sort_by_selector.setValue( null );\n\n\t\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar layout_name = BaseViewController.default_layout_name;\n\t\t\tthis.clearSearchPanel();\n\t\t\tthis.filter_data = null;\n\t\t\tthis.temp_adv_filter_data = null;\n\t\t\tthis.temp_basic_filter_data = null;\n\t\t\tdo_update = true;\n\n\t\t} else {\n\n\t\t\tthis.clearSearchPanel();\n\t\t\tthis.filter_data = null;\n\t\t\tthis.temp_adv_filter_data = null;\n\t\t\tthis.temp_basic_filter_data = null;\n\t\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\t\t\tthis.sort_by_selector.setValue( null );\n\n\t\t\tthis.onSaveNewLayout( BaseViewController.default_layout_name );\n\t\t\treturn;\n\n\t\t}\n\n//\t\tthis.column_selector.setSelectGridData( this.default_display_columns );\n\n\t\tthis.sort_by_selector.setValue( null );\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = this.getValidSearchFilter();\n\n\t\tif ( do_update ) {\n\t\t\tvar args = {};\n\t\t\targs.id = default_layout_id;\n\t\t\targs.data = {};\n\t\t\targs.data.display_columns = selected_display_columns;\n\t\t\targs.data.filter_data = filter_data;\n\t\t\targs.data.filter_sort = sort_filter;\n\n\t\t}\n\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonSaveNewLayout( default_layout_name ) {\n\n\t\tif ( Global.isSet( default_layout_name ) ) {\n\t\t\tvar layout_name = default_layout_name;\n\t\t} else {\n\t\t\tlayout_name = this.save_search_as_input.getValue();\n\t\t}\n\n\t\tif ( !layout_name || layout_name.length < 1 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = this.getValidSearchFilter();\n\n\t\tvar args = {};\n\t\targs.script = this.script_name;\n\t\targs.name = layout_name;\n\t\targs.is_default = false;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tvar $this = this;\n\n\t\tvar a_layout_name = ALayoutCache.layout_dic[this.script_name];\n\t\tif ( a_layout_name && ALayoutCache.layout_dic[a_layout_name] ) {\n\t\t\tALayoutCache.layout_dic[a_layout_name] = null;\n\t\t}\n\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\n\t\t\t\t} else {\n\t\t\t\t\tTAlertManager.showErrorAlert( res );\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tonUpdateLayout() {\n\n\t\tvar selectId = $( this.previous_saved_layout_selector ).children( 'option:selected' ).attr( 'value' );\n\t\tvar layout_name = $( this.previous_saved_layout_selector ).children( 'option:selected' ).text();\n\n\t\tvar sort_filter = this.getSearchPanelSortFilter();\n\t\tvar selected_display_columns = this.getSearchPanelDisplayColumns();\n\t\tvar filter_data = this.getValidSearchFilter();\n\n\t\tvar args = {};\n\t\targs.id = selectId;\n\t\targs.data = {};\n\t\targs.data.display_columns = selected_display_columns;\n\t\targs.data.filter_data = filter_data;\n\t\targs.data.filter_sort = sort_filter;\n\n\t\tvar $this = this;\n\n\t\tvar a_layout_name = ALayoutCache.layout_dic[this.script_name];\n\t\tif ( a_layout_name && ALayoutCache.layout_dic[a_layout_name] ) {\n\t\t\tALayoutCache.layout_dic[a_layout_name] = null;\n\t\t}\n\n\t\tthis.user_generic_data_api.setUserGenericData( args, {\n\t\t\tonResult: function( res ) {\n\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = layout_name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tclearViewLayoutCache() {\n\t\tif ( LocalCacheData.view_layout_cache && LocalCacheData.view_layout_cache[this.script_name] ) {\n\t\t\tLocalCacheData.view_layout_cache[this.script_name] = null;\n\t\t}\n\t}\n\n\tclearAwesomeboxLayoutCache() {\n\t\t// Removed saved view layout for awesomebox if it existed.\n\t\tif ( ALayoutCache.layout_dic && ALayoutCache.layout_dic[this.script_name] ) {\n\t\t\tALayoutCache.layout_dic[ALayoutCache.layout_dic[this.script_name]] = null;\n\t\t}\n\t}\n\n\tonDeleteLayout() {\n\t\tvar selectId = $( this.previous_saved_layout_selector ).children( 'option:selected' ).attr( 'value' );\n\n\t\tvar $this = this;\n\t\tthis.user_generic_data_api.deleteUserGenericData( selectId, {\n\t\t\tonResult: function( res ) {\n\t\t\t\tif ( res.isValid() ) {\n\t\t\t\t\t$this.clearAwesomeboxLayoutCache();\n\t\t\t\t\t$this.clearViewLayoutCache();\n\t\t\t\t\t$this.need_select_layout_name = $this.select_layout.name;\n\t\t\t\t\t$this.initLayout();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildSearchFields() {\n\t\t//Override in all subview\n\t}\n\n\tbuildBasicSearchUI() {\n\t\tif ( !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar basic_search_div = this.search_panel.find( 'div #basic_search_content_div' );\n\n\t\tvar len = this.search_fields.length;\n\t\tvar $this = this;\n\n\t\tvar column1 = basic_search_div.find( '.first-column' );\n\t\tvar column2 = basic_search_div.find( '.second-column' );\n\t\tvar column3 = basic_search_div.find( '.third-column' );\n\n\t\tvar already_created_ui = false;\n\t\t$.each( this.search_fields, function( index, search_field ) {\n\t\t\tif ( Global.isSet( $this.basic_search_field_ui_dic[search_field.get( 'field' )] ) ) {\n\t\t\t\talready_created_ui = true;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( !search_field.get( 'basic_search' ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) );\n\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\tvar form_item_input = $this.getFormItemInput( search_field );\n\t\t\tform_item_label.text( search_field.get( 'label' ) + ': ' );\n\t\t\tform_item_input_div.append( form_item_input );\n\n\t\t\tswitch ( search_field.get( 'in_column' ) ) {\n\t\t\t\tcase 1:\n\t\t\t\t\tcolumn1.append( form_item );\n\t\t\t\t\tcolumn1.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcolumn2.append( form_item );\n\t\t\t\t\tcolumn2.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcolumn3.append( form_item );\n\t\t\t\t\tcolumn3.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t$this.basic_search_field_ui_dic[search_field.get( 'field' )] = form_item_input;\n\t\t} );\n\n\t\tif ( !already_created_ui ) {\n\t\t\tthis.onBuildBasicUIFinished();\n\t\t}\n\t}\n\n\tbuildAdvancedSearchUI() {\n\t\tif ( !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar advSearchDiv = this.search_panel.find( 'div #adv_search_content_div' );\n\n\t\tvar $this = this;\n\n\t\tvar column1 = advSearchDiv.find( '.first-column' );\n\t\tvar column2 = advSearchDiv.find( '.second-column' );\n\t\tvar column3 = advSearchDiv.find( '.third-column' );\n\n\t\tvar already_created_ui = false;\n\t\tvar no_adv_ui = true;\n\n\t\t$.each( this.search_fields, function( index, search_field ) {\n\n\t\t\tif ( Global.isSet( $this.adv_search_field_ui_dic[search_field.get( 'field' )] ) ) {\n\t\t\t\talready_created_ui = true;\n\t\t\t\tno_adv_ui = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ( !search_field.get( 'adv_search' ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tvar form_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) );\n\t\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\t\t\tvar form_item_input = $this.getFormItemInput( search_field );\n\t\t\tform_item_label.text( search_field.get( 'label' ) + ': ' );\n\t\t\tform_item_input_div.append( form_item_input );\n\n\t\t\tswitch ( search_field.get( 'in_column' ) ) {\n\t\t\t\tcase 1:\n\t\t\t\t\tcolumn1.append( form_item );\n\t\t\t\t\tcolumn1.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tcolumn2.append( form_item );\n\t\t\t\t\tcolumn2.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tcolumn3.append( form_item );\n\t\t\t\t\tcolumn3.append( '<div class=\\'clear-both-div\\'></div>' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t$this.adv_search_field_ui_dic[search_field.get( 'field' )] = form_item_input;\n\t\t\tno_adv_ui = false;\n\t\t} );\n\n\t\tif ( no_adv_ui ) {\n\n\t\t\tthis.search_panel.hideAdvSearchPanel();\n\t\t}\n\n\t\tif ( !already_created_ui ) {\n\t\t\tthis.onBuildAdvUIFinished();\n\t\t}\n\t}\n\n\tonSetSearchFilterFinished() {\n\t}\n\n\tonBuildAdvUIFinished() {\n\t\t//Always override in sub class\n\t}\n\n\tonBuildBasicUIFinished() {\n\t\t//Always override in sub class\n\t}\n\n\tgetFormItemInput( search_field ) {\n\t\tvar input;\n\t\tvar form_type = search_field.get( 'form_item_type' );\n\n\t\tswitch ( form_type ) {\n\t\t\tcase FormItemType.AWESOME_BOX:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/awesomebox/AComboBox.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tvar show_search = false;\n\t\t\t\tvar key;\n\n\t\t\t\tif ( search_field.get( 'layout_name' ) !== 'global_option_column' && search_field.get( 'layout_name' ) !== 'global_tree_column' ) {\n\t\t\t\t\tshow_search = true;\n\t\t\t\t\tkey = 'id';\n\t\t\t\t} else {\n\n\t\t\t\t\tif ( search_field.get( 'layout_name' ) === 'global_tree_column' ) {\n\t\t\t\t\t\tkey = 'id';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = 'value';\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tinput.AComboBox( {\n\t\t\t\t\tapi_class: search_field.get( 'api_class' ),\n\t\t\t\t\tallow_multiple_selection: search_field.get( 'multiple' ),\n\t\t\t\t\tlayout_name: search_field.get( 'layout_name' ),\n\t\t\t\t\ttree_mode: search_field.get( 'tree_mode' ),\n\t\t\t\t\tdefault_args: search_field.get( 'default_args' ),\n\t\t\t\t\tshow_search_inputs: show_search,\n\t\t\t\t\tset_any: search_field.get( 'set_any' ),\n\t\t\t\t\taddition_source_function: search_field.get( 'addition_source_function' ),\n\t\t\t\t\tscript_name: search_field.get( 'script_name' ),\n\t\t\t\t\tcustom_first_label: search_field.get( 'custom_first_label' ),\n\t\t\t\t\tkey: key,\n\t\t\t\t\tsearch_panel_model: true,\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\n\t\t\t\tif ( search_field.get( 'customSearchFilter' ) ) {\n\t\t\t\t\tinput.customSearchFilter = search_field.get( 'customSearchFilter' );\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.TEXT_INPUT:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/text_input/TTextInput.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TTextInput( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.PASSWORD_INPUT:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/text_input/TPasswordInput.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TTextInput( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.COMBO_BOX:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/combobox/TComboBox.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TComboBox( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tset_any: true\n\t\t\t\t} );\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.TAG_INPUT:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/tag_input/TTagInput.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TTagInput( {\n\t\t\t\t\tfield: search_field.get( 'field' ),\n\t\t\t\t\tobject_type_id: search_field.get( 'object_type_id' )\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.DATE_PICKER:\n\t\t\t\tinput = Global.loadWidgetByName( form_type );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TDatePicker( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tcase FormItemType.CHECKBOX:\n\t\t\t\tinput = Global.loadWidget( 'global/widgets/checkbox/TCheckbox.html' );\n\t\t\t\tinput = $( input );\n\t\t\t\tinput.TCheckbox( {\n\t\t\t\t\tfield: search_field.get( 'field' )\n\t\t\t\t} );\n\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\talert('ERROR: Form type does not exist: '+ form_type);\n\t\t\t\tdebugger;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn input;\n\t}\n\n\tbuildSearchAndLayoutUI() {\n\t\tvar layout_div = this.search_panel.find( 'div #saved_layout_content_div' );\n\n\t\t//Display Columns\n\n\t\tvar form_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) );\n\t\tvar form_item_label = form_item.find( '.form-item-label' );\n\t\tvar form_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\tvar column_selector = Global.loadWidget( 'global/widgets/awesomebox/ADropDown.html' );\n\n\t\tthis.column_selector = $( column_selector );\n\n\t\tthis.column_selector = this.column_selector.ADropDown( {\n\t\t\tdisplay_show_all: false,\n\t\t\tid: this.ui_id + '_column_selector',\n\t\t\tkey: 'value',\n\t\t\tallow_drag_to_order: true,\n\t\t\tdisplay_close_btn: false,\n\t\t\tdisplay_column_settings: false,\n\t\t\tmax_height: 150\n\t\t} );\n\t\tthis.column_selector.on( 'formItemChange', function() {\n\t\t\t$this.layout_changed = true;\n\t\t} );\n\n\t\tform_item_label.text( $.i18n._( 'Display Columns' ) + ':' );\n\t\tform_item_label.addClass( 'SearchPanel-displayColumns-label' );\n\t\tform_item_input_div.append( this.column_selector );\n\n\t\tlayout_div.append( form_item );\n\n\t\tlayout_div.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\tthis.column_selector.setColumns( [\n\t\t\t{ name: 'label', index: 'label', label: $.i18n._( 'Column Name' ), width: 100, sortable: false }\n\t\t] );\n\n\t\t//Sort By\n\t\tform_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) );\n\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\t\tthis.sort_by_selector = $( Global.loadWidget( 'global/widgets/awesomebox/AComboBox.html' ) );\n\t\tthis.sort_by_selector = this.sort_by_selector.AComboBox( {\n\t\t\tallow_drag_to_order: true,\n\t\t\tallow_multiple_selection: true,\n\t\t\tset_empty: true,\n\t\t\tlayout_name: 'global_sort_columns'\n\t\t} );\n\n\t\tform_item_label.text( $.i18n._( 'Sort By' ) + ':' );\n\t\tform_item_input_div.append( this.sort_by_selector );\n\n\t\tlayout_div.append( form_item );\n\n\t\tlayout_div.append( '<div class=\\'clear-both-div\\'></div>' );\n\n\t\t//Save and update layout\n\n\t\tform_item = $( Global.loadWidget( 'global/widgets/search_panel/FormItem.html' ) );\n\t\tform_item_label = form_item.find( '.form-item-label' );\n\t\tform_item_input_div = form_item.find( '.form-item-input-div' );\n\n\t\tform_item_label.text( $.i18n._( 'Save Search As' ) + ':' );\n\n\t\tthis.save_search_as_input = Global.loadWidget( 'global/widgets/text_input/TTextInput.html' );\n\t\tthis.save_search_as_input = $( this.save_search_as_input );\n\t\tthis.save_search_as_input.TTextInput();\n\n\t\tvar save_btn = $( '<input class=\\'t-button\\' style=\\'margin-left: 5px\\' type=\\'button\\' value=\\'' + $.i18n._( 'Save' ) + '\\'></input>' );\n\n\t\tform_item_input_div.append( this.save_search_as_input );\n\t\tform_item_input_div.append( save_btn );\n\n\t\tvar $this = this;\n\t\tsave_btn.click( function() {\n\t\t\t$this.saving_layout_in_layout_tab = true;\n\t\t\t$this.onSaveNewLayout();\n\t\t\t$this.search();\n\t\t} );\n\n\t\t//Previous Saved Layout\n\n\t\tthis.previous_saved_layout_div = $( '<div class=\\'previous-saved-layout-div\\'></div>' );\n\n\t\tform_item_input_div.append( this.previous_saved_layout_div );\n\n\t\tform_item_label = $( '<span style=\\'margin-left: 5px\\' >' + $.i18n._( 'Previous Saved Searches' ) + ':</span>' );\n\t\tthis.previous_saved_layout_div.append( form_item_label );\n\n\t\tthis.previous_saved_layout_selector = $( '<select style=\\'margin-left: 5px\\' class=\\'t-select\\'>' );\n\t\tvar update_btn = $( '<input class=\\'t-button\\' style=\\'margin-left: 5px\\' type=\\'button\\' value=\\'' + $.i18n._( 'Update' ) + '\\'></input>' );\n\t\tvar del_btn = $( '<input class=\\'t-button\\' style=\\'margin-left: 5px\\' type=\\'button\\' value=\\'' + $.i18n._( 'Delete' ) + '\\'></input>' );\n\n\t\tupdate_btn.click( function() {\n\t\t\t$this.onUpdateLayout();\n\t\t\t$this.onSearch();\n\t\t} );\n\n\t\tdel_btn.click( function() {\n\t\t\t$this.onDeleteLayout();\n\t\t\t$this.onSearch();\n\t\t} );\n\n\t\tthis.previous_saved_layout_div.append( this.previous_saved_layout_selector );\n\t\tthis.previous_saved_layout_div.append( update_btn );\n\t\tthis.previous_saved_layout_div.append( del_btn );\n\n\t\tlayout_div.append( form_item );\n\n\t\tthis.previous_saved_layout_div.css( 'display', 'none' );\n\t}\n\n\tonGridSelectRow() {\n\t\t$( '#ribbon_view_container .context-menu:visible a' ).click();\n\t\tthis.setDefaultMenu();\n\t}\n\n\tsetPreviousSavedSearchSourcesAndValue( layouts_array ) {\n\t\tvar $this = this;\n\n\t\tif ( this.previous_saved_layout_selector ) {\n\t\t\tthis.previous_saved_layout_selector.empty();\n\n\t\t\tif ( layouts_array && layouts_array.length > 0 ) {\n\t\t\t\tthis.previous_saved_layout_div.css( 'display', 'inline' );\n\n\t\t\t\tvar len = layouts_array.length;\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tvar item = layouts_array[i];\n\t\t\t\t\tthis.previous_saved_layout_selector.append( $( '<option value=\"' + item.id + '\"></option>' ).text( item.name ) );\n\t\t\t\t}\n\n\t\t\t\t$( this.previous_saved_layout_selector.find( 'option' ) ).filter( function() {\n\t\t\t\t\treturn parseInt( $( this ).attr( 'value' ) ) === $this.select_layout.id;\n\t\t\t\t} ).prop( 'selected', true ).attr( 'selected', true );\n\n\t\t\t} else {\n\t\t\t\tthis.previous_saved_layout_div.css( 'display', 'none' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsetSelectLayout( exclude_column ) {\n\t\tvar $this = this;\n\t\tvar grid;\n\n\t\tvar grid_id = 'grid';\n\t\tif ( !Global.isSet( this.grid ) ) {\n\t\t\tgrid = $( this.el ).find( '#grid' );\n\n\t\t\tgrid.attr( 'id', this.ui_id + '_grid' );  //Grid's id is ScriptName + _grid\n\n\t\t\tgrid_id = this.ui_id + '_grid';\n\t\t}\n\n\t\tvar column_info_array = [];\n\n\t\tif ( !this.select_layout ) { //Set to default layout if no layout at all\n\t\t\tthis.select_layout = { id: '' };\n\t\t\tthis.select_layout.data = { filter_data: {}, filter_sort: {} };\n\t\t\tthis.select_layout.data.display_columns = this.default_display_columns;\n\t\t}\n\n\t\tvar layout_data = this.select_layout.data;\n\n\t\tif ( !layout_data.display_columns || layout_data.display_columns.length == 0 ) {\n\t\t\tlayout_data.display_columns = this.default_display_columns;\n\t\t}\n\n\t\tvar display_columns = this.buildDisplayColumns( layout_data.display_columns );\n\n\t\tif ( !this.sub_view_mode && this.search_panel ) {\n\n\t\t\t//Set Display Column in layout panel\n\t\t\t//Error: TypeError: null is not an object (evaluating 'this.column_selector.setSelectGridData')\n\t\t\tif ( this.column_selector ) {\n\t\t\t\tthis.column_selector.setSelectGridData( display_columns );\n\t\t\t\t//this.column_selector.setGridColumnsWidths(); //This is called in SearchPanel.setGridSize() on expand instead, as browsers seem to optimize out scrollbar calculations until the DOM element is visible.\n\t\t\t}\n\n\t\t\t//Set Sort by awesomebox in layout panel\n\t\t\t//Error: TypeError: null is not an object (evaluating 'this.sort_by_selector.setSourceData')\n\t\t\tif ( this.sort_by_selector ) {\n\t\t\t\tthis.sort_by_selector.setSourceData( this.buildSortSelectorUnSelectColumns( display_columns ) );\n\t\t\t\tthis.sort_by_selector.setValue( this.buildSortBySelectColumns() );\n\t\t\t}\n\n\t\t\t//Set Previoous Saved layout combobox in layout panel\n\t\t\tvar layouts_array = this.search_panel.getLayoutsArray();\n\n\t\t\tthis.setPreviousSavedSearchSourcesAndValue( layouts_array );\n\n\t\t}\n\n\t\t//Set Data Grid on List view\n\t\tvar len = display_columns.length;\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar view_column_data = display_columns[i];\n\n\t\t\tif ( $.inArray( view_column_data.value, exclude_column ) !== -1 ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar column_info = {\n\t\t\t\tname: view_column_data.value,\n\t\t\t\tindex: view_column_data.value,\n\t\t\t\tlabel: view_column_data.label,\n\t\t\t\twidth: 100,\n\t\t\t\tsortable: false,\n\t\t\t\ttitle: false\n\t\t\t};\n\t\t\tcolumn_info_array.push( column_info );\n\t\t}\n\n\t\tvar grid_needs_reload = false;\n\t\tif ( this.grid ) {\n\t\t\tgrid_id = this.ui_id + '_grid';\n\n\t\t\tif ( this.layout_changed == true ) {\n\t\t\t\t$this.layout_changed = false;\n\t\t\t\tthis.grid.grid.jqGrid( 'GridUnload' );\n\t\t\t\tthis.grid = null;\n\t\t\t} else {\n\t\t\t\t//This is done in BaseViewControler->search() right before the data is set, which prevents \"flashing\".\n\t\t\t\t//  However some views override this function and need to be fixed manually.\n\t\t\t\t//this.grid.clearGridData();\n\t\t\t}\n\t\t}\n\n\t\tthis.showGridBorders();\n\n\t\tif ( !this.grid ) {\n\t\t\tvar grid_setup = this.getGridSetup();\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\tgrid_setup.height = 1;\n\t\t\t}\n\t\t\tthis.grid = new TTGrid( grid_id, grid_setup, column_info_array );\n\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\tthis.grid.grid.hide();\n\t\t\t}\n\n\t\t\tthis.setGridColumnsWidth(); //Helps makes changing layouts \"flash\" less, especially when going from only a few columns to many.\n\t\t\tthis.setGridSize( this.ui_id, this.sub_view_mode, this.sub_view_grid_autosize, this.pager_data );\n\t\t}\n\n\t\tif ( this.grid && grid_needs_reload ) {\n\t\t\tthis.grid.reloadGrid();\n\t\t}\n\n\t\t//Add widget on UI and bind events. Next set data in it in search result\n\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\tif ( this.paging_widget.parent().length > 0 ) {\n\t\t\t\tthis.paging_widget.remove();\n\t\t\t}\n\n\t\t\tthis.paging_widget.css( 'width', this.grid.grid.width() );\n\t\t\tthis.grid.grid.append( this.paging_widget );\n\n\t\t\tthis.paging_widget.click( $this.onPaging() );\n\n\t\t} else {\n\t\t\t$( this.el ).find( '.total-number-div' ).append( this.paging_widget );\n\t\t\t$( this.el ).find( '.bottom-div' ).append( this.paging_widget_2 );\n\n\t\t\tthis.paging_widget.on( 'paging', function( e, action, page_number ) {\n\t\t\t\t$this.onPaging2( e, action, page_number );\n\t\t\t} );\n\t\t\tthis.paging_widget_2.bind( 'paging', function( e, action, page_number ) {\n\t\t\t\t$this.onPaging2( e, action, page_number );\n\t\t\t} );\n\t\t}\n\n\t\tthis.bindGridColumnEvents();\n\n\t\tthis.setGridHeaderStyle(); //Set Sort Style\n\t\t//replace select layout filter_data to filter set in onNavigation function when goto view from navigation context group\n\t\tif ( LocalCacheData.default_filter_for_next_open_view ) {\n\t\t\tthis.select_layout.data.filter_data = LocalCacheData.default_filter_for_next_open_view.filter_data;\n\t\t\tLocalCacheData.default_filter_for_next_open_view = null;\n\t\t}\n\n\t\tthis.filter_data = this.select_layout.data.filter_data;\n\n\t\tif ( !this.sub_view_mode ) {\n\t\t\tthis.setSearchPanelFilter( true ); //Auto change to property tab when set value to search fields.\n\t\t}\n\t}\n\n\tgetGridSetup() {\n\t\tvar $this = this;\n\n\t\tvar container = this.grid_parent ? this.grid_parent : '.grid-div';\n\t\tif ( !this.grid_parent && this.sub_view_mode ) {\n\t\t\tif ( $( '#' + this.ui_id + '_grid' ).parents( '.sub-view' ).length > 0 ) {\n\t\t\t\tcontainer = '.sub-grid-view-div';\n\t\t\t} else {\n\t\t\t\tcontainer = '.edit-view-tab-bar';\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcontainer_selector: container,\n\t\t\tsub_grid_mode: this.sub_view_mode,\n\t\t\tonResizeGrid: true,\n\t\t\tonSelectRow: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonCellSelect: function() {\n\t\t\t\t$this.onGridSelectRow();\n\t\t\t},\n\t\t\tonSelectAll: function() {\n\t\t\t\t$this.onGridSelectAll();\n\t\t\t},\n\t\t\tondblClickRow: function( e ) {\n\t\t\t\t$this.onGridDblClickRow( e );\n\t\t\t},\n\t\t\tonRightClickRow: function( rowId ) {\n\t\t\t\tvar id_array = $this.getGridSelectIdArray();\n\t\t\t\tif ( id_array.indexOf( rowId ) < 0 ) {\n\t\t\t\t\t$this.grid.grid.resetSelection();\n\t\t\t\t\t$this.grid.grid.setSelection( rowId );\n\t\t\t\t\t$this.onGridSelectRow();\n\t\t\t\t}\n\t\t\t},\n\t\t\theight: 1, //Start really small to reduce flashing, as height is changed with setGridSize() shortly after anyways.\n\t\t};\n\t}\n\n\tonGridSelectAll() {\n\t\tthis.setDefaultMenu();\n\t}\n\n\tunSelectAll() {\n\t\tthis.grid.grid.resetSelection();\n\t}\n\n\tonGridDblClickRow( e ) {\n\t\tthis.grid.grid.resetSelection();\n\t\tthis.grid.setSelection( e, false );\n\t\tthis.setDefaultMenu( true );\n\t\tvar len = this.context_menu_array.length;\n\t\tvar need_break = false;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tif ( need_break ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar context_btn = $( this.context_menu_array[i] );\n\t\t\tvar id = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).prop( 'id' );\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.edit:\n\t\t\t\t\tif ( context_btn.is( ':visible' ) && !context_btn.hasClass( 'disable-image' ) ) {\n\t\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t\tthis.onEditClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tif ( need_break ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcontext_btn = $( this.context_menu_array[i] );\n\t\t\tid = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).prop( 'id' );\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.view:\n\t\t\t\t\tneed_break = true;\n\t\t\t\t\tif ( context_btn.is( ':visible' ) && !context_btn.hasClass( 'disable-image' ) ) {\n\t\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t\tthis.onViewClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tcontext_btn = $( this.context_menu_array[i] );\n\t\t\tid = $( context_btn.find( '.ribbon-sub-menu-icon' ) ).prop( 'id' );\n\t\t\tswitch ( id ) {\n\t\t\t\tcase ContextMenuIconName.add:\n\t\t\t\t\tif ( context_btn.is( ':visible' ) && !context_btn.hasClass( 'disable-image' ) ) {\n\t\t\t\t\t\tProgressBar.showOverlay();\n\t\t\t\t\t\tthis.onAddClick();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tonPaging() {\n\t\tthis.search( true, 'next' );\n\t}\n\n\tonPaging2( e, action, page_number ) {\n\t\tthis.search( true, action, page_number );\n\t}\n\n\t//Bind column click event to change sort type and save columns to t_grid_header_array to use to set column style (asc or desc)\n\tbindGridColumnEvents() {\n\t\tvar display_columns = this.grid.getColumnModel();\n\n\t\tif ( !display_columns ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = display_columns.length;\n\n\t\tthis.t_grid_header_array = [];\n\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar column_info = display_columns[i];\n\t\t\tvar column_header = $( $( this.el ).find( '#gbox_' + this.ui_id + '_grid' ).find( 'div #jqgh_' + this.ui_id + '_grid_' + column_info.name ) );\n\n\t\t\tthis.t_grid_header_array.push( column_header.TGridHeader() );\n\t\t\tif ( this.search_panel ) {\n\t\t\t\tcolumn_header.on( 'click', onColumnHeaderClick );\n\t\t\t}\n\t\t}\n\n\t\tvar $this = this;\n\n\t\tfunction onColumnHeaderClick( e ) {\n\t\t\tvar field = $( this ).attr( 'id' );\n\t\t\tfield = field.substring( 10 + $this.ui_id.length + 1, field.length );\n\n\t\t\tif ( field === 'cb' ) { //first column, check box column.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\te.preventDefault(); //can't be cancelled before cb is detected as we need the default event in that case.\n\n\t\t\tif ( !$this.sorting_rows ) {\n\t\t\t\t$this.sorting_rows = true;\n\t\t\t\tTTPromise.add( 'init', 'init' );\n\t\t\t\tTTPromise.wait( null, null, function() {\n\t\t\t\t\t$this.sorting_rows = false; //prevent doubling up events ( which loops forever )\n\t\t\t\t} );\n\n\t\t\t\tif ( e.metaKey || e.ctrlKey ) {\n\t\t\t\t\t$this.buildSortCondition( false, field );\n\t\t\t\t} else {\n\t\t\t\t\t$this.buildSortCondition( true, field );\n\n\t\t\t\t}\n\n\t\t\t\tif ( $this.sub_view_mode ) {\n\t\t\t\t\t$this.search();\n\t\t\t\t\t$this.setGridHeaderStyle();\n\t\t\t\t} else {\n\t\t\t\t\tif ( $this.sort_by_selector ) {\n\t\t\t\t\t\t$this.sort_by_selector.setValue( $this.buildSortBySelectColumns() );\n\t\t\t\t\t}\n\t\t\t\t\t$this.onSearch();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Skipping column sort call ', '', 'BaseViewController', 'onColumnHeaderClick', 10 );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetValidSearchFilter() {\n\t\tvar validFilterData = {};\n\t\tfor ( var key in this.filter_data ) {\n\t\t\t// Error: Unable to get property 'value' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=8.0.6-20150417-143734 line 4727\n\t\t\tif ( Global.isSet( this.filter_data[key] ) && Global.isSet( this.filter_data[key].value ) && this.filter_data[key].value !== '' ) {\n\t\t\t\tvalidFilterData[key] = this.filter_data[key];\n\t\t\t}\n\t\t}\n\n\t\treturn validFilterData;\n\t}\n\n\tgetSearchPanelDisplayColumns() {\n\t\tvar display_columns = [];\n\n\t\tvar select_items = this.column_selector.getSelectItems();\n\n\t\tif ( select_items && select_items.length > 0 ) {\n\t\t\t$.each( select_items, function( index, content ) {\n\t\t\t\tdisplay_columns.push( content.value );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !display_columns || display_columns.length == 0 ) {\n\t\t\tdisplay_columns = this.default_display_columns;\n\t\t}\n\n\t\treturn display_columns;\n\t}\n\n\tgetSearchPanelSortFilter() {\n\t\tvar sort_filter = [];\n\t\tvar select_items = this.sort_by_selector.getValue( true );\n\n\t\tif ( select_items && select_items.length > 0 ) {\n\t\t\t$.each( select_items, function( index, content ) {\n\t\t\t\tvar sort = {};\n\t\t\t\tsort[content.value] = content.sort;\n\t\t\t\tsort_filter.push( sort );\n\t\t\t} );\n\t\t}\n\n\t\treturn sort_filter;\n\t}\n\n\tgetSearchPanelFilter( getFromTabIndex, save_temp_filter ) {\n\t\tif ( !this.search_panel ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( Global.isSet( getFromTabIndex ) ) {\n\t\t\tvar search_tab_select_index = getFromTabIndex;\n\t\t} else {\n\t\t\tsearch_tab_select_index = this.search_panel.getSelectTabIndex();\n\t\t}\n\n//\t\tvar basic_fields_len = this.search_fields.length;\n\t\tvar target_ui_dic = null;\n\n\t\tif ( search_tab_select_index === 0 ) {\n\t\t\tthis.filter_data = [];\n\t\t\ttarget_ui_dic = this.basic_search_field_ui_dic;\n\t\t} else if ( search_tab_select_index === 1 && this.search_panel.isAdvTabVisible() ) {\n\t\t\tthis.filter_data = [];\n\t\t\ttarget_ui_dic = this.adv_search_field_ui_dic;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tvar $this = this;\n\t\t$.each( target_ui_dic, function( key, content ) {\n\t\t\t$this.filter_data[key] = { field: key, id: '', value: target_ui_dic[key].getValue( true ) };\n\n\t\t\tif ( $this.temp_basic_filter_data ) {\n\t\t\t\t$this.temp_basic_filter_data[key] = $this.filter_data[key];\n\t\t\t}\n\n\t\t\tif ( $this.temp_adv_filter_data ) {\n\t\t\t\t$this.temp_adv_filter_data[key] = $this.filter_data[key];\n\t\t\t}\n\t\t} );\n\n\t\tif ( save_temp_filter ) {\n\t\t\tif ( search_tab_select_index === 0 ) {\n\t\t\t\t$this.temp_basic_filter_data = Global.clone( $this.filter_data );\n\t\t\t} else if ( search_tab_select_index === 1 ) {\n\t\t\t\t$this.temp_adv_filter_data = Global.clone( $this.filter_data );\n\t\t\t}\n\n\t\t}\n\t}\n\n\t//Set value to field UI in search tab\n\tsetSearchPanelFilter( autoChangeTab, tab_index ) {\n\n\t\tthis.clearSearchPanel();\n\n\t\tif ( !Global.isSet( autoChangeTab ) ) {\n\t\t\tautoChangeTab = false;\n\t\t}\n\n\t\tvar filter = this.filter_data;\n\n\t\tif ( Global.isSet( tab_index ) ) {\n\t\t\tif ( tab_index === 0 && this.temp_basic_filter_data ) {\n\t\t\t\tfilter = this.temp_basic_filter_data;\n\t\t\t} else if ( tab_index === 1 && this.temp_adv_filter_data ) {\n\t\t\t\tfilter = this.temp_adv_filter_data;\n\t\t\t}\n\t\t}\n\n\t\tif ( !Global.isSet( filter ) || !this.search_fields ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar basic_fields_len = this.search_fields.length;\n\n\t\tfor ( var i = 0; i < basic_fields_len; i++ ) {\n\t\t\tvar field = this.search_fields[i];\n\t\t\tvar field_name = field.get( 'field' );\n\n\t\t\tvar search_input = this.basic_search_field_ui_dic[field_name];\n\t\t\tvar search_input_1 = this.adv_search_field_ui_dic[field_name];\n\n\t\t\tif ( Global.isSet( filter[field_name] ) ) {\n\n\t\t\t\tif ( Global.isSet( search_input ) ) {\n\n\t\t\t\t\tif ( $.type( filter[field_name] ) === 'string' || $.type( filter[field_name] ) === 'number' ) {\n\t\t\t\t\t\tsearch_input.setValue( filter[field_name] );\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tif ( filter[field_name].hasOwnProperty( 'value' ) ) { // when set default filter don't have 'value' in it, For example Invoice edit view\n\t\t\t\t\t\t\tsearch_input.setValue( filter[field_name].value );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsearch_input.setValue( filter[field_name] );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( autoChangeTab && !this.saving_layout_in_layout_tab ) {\n\t\t\t\t\tif ( this.search_panel.getSelectTabIndex() !== 1 ) {\n\t\t\t\t\t\tthis.search_panel.setSelectTabIndex( 1, false );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( Global.isSet( search_input_1 ) ) {\n\n\t\t\t\t\tif ( $.type( filter[field_name] ) === 'string' || $.type( filter[field_name] ) === 'number' ) {\n\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name] );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( filter[field_name].hasOwnProperty( 'value' ) ) { // when set default filter don't have 'value' in it, For example Invoice edit view\n\t\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name].value );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsearch_input_1.setValue( filter[field_name] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tsearch_input_1.setValue( filter[field_name].value );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.getSearchPanelFilter(); //Make sure filter only has fields on current display ab\n\n\t\tthis.search_panel.setSearchFlag( this.getValidSearchFilter() ); // Add ! to tab which has search condition in it\n\n\t\tthis.onSetSearchFilterFinished();\n\t}\n\n\t//Set Grid header style for asc or desc\n\tsetGridHeaderStyle() {\n\t\tfor ( var i = 0; i < this.t_grid_header_array.length; i++ ) {\n\t\t\tvar t_grid_header = this.t_grid_header_array[i];\n\n\t\t\tvar field = t_grid_header.attr( 'id' );\n\t\t\tif ( typeof field === 'string' || field instanceof String ) {\n\t\t\t\tfield = field.substring( 10 + this.ui_id.length + 1, field.length );\n\n\t\t\t\tt_grid_header.cleanSortStyle();\n\n\t\t\t\tif ( this.select_layout.data.filter_sort ) {\n\t\t\t\t\tvar sort_array_len = this.select_layout.data.filter_sort.length;\n\n\t\t\t\t\tfor ( var j = 0; j < sort_array_len; j++ ) {\n\t\t\t\t\t\tvar sort_item = this.select_layout.data.filter_sort[j];\n\t\t\t\t\t\tvar sortField = Global.getFirstKeyFromObject( sort_item );\n\t\t\t\t\t\tif ( sortField === field ) {\n\t\t\t\t\t\t\tif ( sort_array_len > 1 ) {\n\t\t\t\t\t\t\t\tt_grid_header.setSortStyle( sort_item[sortField], j + 1 );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tt_grid_header.setSortStyle( sort_item[sortField], 0 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildSortCondition( reset, field ) {\n\t\tvar next_sort = 'desc';\n\n\t\tif ( reset ) {\n\n\t\t\tif ( this.select_layout.data.filter_sort && this.select_layout.data.filter_sort.length > 0 ) {\n\t\t\t\tvar len = this.select_layout.data.filter_sort.length;\n\t\t\t\tvar found = false;\n\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tvar sort_item = this.select_layout.data.filter_sort[i];\n\t\t\t\t\tfor ( var key in sort_item ) {\n\n\t\t\t\t\t\tif ( !sort_item.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( key === field ) {\n\t\t\t\t\t\t\tif ( sort_item[key] === 'asc' ) {\n\t\t\t\t\t\t\t\tnext_sort = 'desc';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnext_sort = 'asc';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( found ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.select_layout.data.filter_sort = [\n\t\t\t\t{}\n\t\t\t];\n\t\t\tthis.select_layout.data.filter_sort[0][field] = next_sort;\n\n\t\t} else {\n\t\t\tif ( !this.select_layout.data.filter_sort ) {\n\t\t\t\tthis.select_layout.data.filter_sort = [\n\t\t\t\t\t{}\n\t\t\t\t];\n\t\t\t\tthis.select_layout.data.filter_sort[0][field] = 'asc';\n\t\t\t} else {\n\t\t\t\tlen = this.select_layout.data.filter_sort.length;\n\t\t\t\tfound = false;\n\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\tsort_item = this.select_layout.data.filter_sort[i];\n\t\t\t\t\tfor ( var key in sort_item ) {\n\n\t\t\t\t\t\tif ( !sort_item.hasOwnProperty( key ) ) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( key === field ) {\n\t\t\t\t\t\t\tif ( sort_item[key] === 'asc' ) {\n\t\t\t\t\t\t\t\tsort_item[key] = 'desc';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsort_item[key] = 'asc';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( found ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif ( !found ) {\n\t\t\t\t\tthis.select_layout.data.filter_sort.push( {} );\n\t\t\t\t\tthis.select_layout.data.filter_sort[len][field] = 'asc';\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsearch( set_default_menu, page_action, page_number, callBack ) {\n\t\tif ( !Global.isSet( set_default_menu ) ) {\n\t\t\tset_default_menu = true;\n\t\t}\n\n\t\tvar filter = {};\n\t\tfilter.filter_data = {};\n\t\tfilter.filter_sort = {};\n\t\tfilter.filter_columns = this.getFilterColumnsFromDisplayColumns();\n\t\tfilter.filter_items_per_page = 0; // Default to 0 to load user preference defined\n\t\tif ( this.pager_data ) {\n\n\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\tif ( page_action === 'next' ) {\n\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t} else {\n\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch ( page_action ) {\n\t\t\t\t\tcase 'next':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.next_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'last':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.previous_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'start':\n\t\t\t\t\t\tfilter.filter_page = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'end':\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.last_page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'go_to':\n\t\t\t\t\t\tfilter.filter_page = page_number;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfilter.filter_page = this.pager_data.current_page;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfilter.filter_page = 1;\n\t\t}\n\t\t//Error: Uncaught TypeError: Cannot read property 'data' of null\n\t\tif ( typeof this.select_layout != 'undefined' && this.sub_view_mode && this.parent_key ) {\n\t\t\tthis.select_layout.data.filter_data[this.parent_key] = this.parent_value;\n\t\t}\n\t\t//Error: Uncaught TypeError: Cannot read property 'data' of null\n\t\t//If sub view controller set custom filters, get it\n\t\tif ( typeof this.select_layout != 'undefined' && Global.isSet( this.getSubViewFilter ) ) {\n\t\t\tthis.select_layout.data.filter_data = this.getSubViewFilter( this.select_layout.data.filter_data );\n\t\t}\n\n\t\t//select_layout will not be null, it's set in setSelectLayout function\n\t\tfilter.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\t//Error: Uncaught TypeError: Cannot read property 'data' of null\n\t\tif ( this.select_layout && this.select_layout.data ) {\n\t\t\tfilter.filter_sort = this.select_layout.data.filter_sort;\n\t\t}\n\n\t\tif ( TTUUID.isUUID( this.refresh_id ) ) {\n\t\t\tfilter.filter_data = {};\n\t\t\tfilter.filter_data.id = [this.refresh_id];\n\n\t\t\tthis.last_select_ids = filter.filter_data.id;\n\n\t\t} else {\n\t\t\tthis.last_select_ids = [];\n\t\t\tvar ids = this.getGridSelectIdArray();\n\t\t\t//ensure detached reference to value source or lose this.last_select_ids when grid is cleared.\n\t\t\tfor ( var i = 0; i < ids.length; i++ ) {\n\t\t\t\tthis.last_select_ids.push( ids[i] );\n\t\t\t}\n\t\t}\n\n\t\tvar $this = this;\n\t\tthis.api['get' + this.api.key_name]( filter, {\n\t\t\tonResult: function( result ) {\n\t\t\t\tvar result_data = result.getResult();\n\t\t\t\tvar len;\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.setDefaultMenu( true );\n\t\t\t\t}\n\t\t\t\tif ( !Global.isArray( result_data ) && ( !TTUUID.isUUID( $this.refresh_id ) || $this.refresh_id == TTUUID.zero_id || $this.refresh_id == TTUUID.not_exist_id ) ) {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t\t$this.showNoResultCover();\n\t\t\t\t} else {\n\t\t\t\t\t$this.removeNoResultCover();\n\t\t\t\t\tif ( Global.isSet( $this.__createRowId ) ) {\n\t\t\t\t\t\tresult_data = $this.__createRowId( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( Global.isSet( $this.showGridOptionFields ) ) {\n\t\t\t\t\t\tresult_data = $this.showGridOptionFields( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\tresult_data = Global.formatGridData( result_data, $this.api.key_name );\n\t\t\t\t\tlen = result_data.length;\n\t\t\t\t}\n\n\t\t\t\tif ( TTUUID.isUUID( $this.refresh_id ) ) {\n\t\t\t\t\t$this.refresh_id = null;\n\t\t\t\t\tvar grid_source_data = $this.grid.getData();\n\t\t\t\t\tlen = grid_source_data.length;\n\t\t\t\t\tif ( $.type( grid_source_data ) !== 'array' ) {\n\t\t\t\t\t\tgrid_source_data = [];\n\t\t\t\t\t}\n\t\t\t\t\tvar found = false;\n\t\t\t\t\tvar new_record = result_data[0];\n\t\t\t\t\t//Error: Uncaught TypeError: Cannot read property 'id' of undefined in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-084605 line 4851\n\t\t\t\t\tif ( new_record ) {\n\t\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\t\tvar record = grid_source_data[i];\n\t\t\t\t\t\t\t//Fixed === issue. The id set by jQGrid is string type.\n\t\t\t\t\t\t\t//Commented out as we now expect the variable type of the ids to be UUID (string in javascript)\n\t\t\t\t\t\t\t//if ( !isNaN( parseInt( record.id ) ) ) {\n\t\t\t\t\t\t\t//\trecord.id = parseInt( record.id );\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t\tif ( record.id == new_record.id ) {\n\t\t\t\t\t\t\t\t$this.grid.setRowData( new_record.id, new_record );\n\t\t\t\t\t\t\t\tgrid_source_data[i] = new_record;\n\t\t\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !found ) {\n\t\t\t\t\t\t\t$this.grid.setData( grid_source_data.concat( new_record ) );\n\t\t\t\t\t\t\t// $this.setGridColumnsWidth();\n\t\t\t\t\t\t\t// if ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t\t// \tlen = Global.isSet( len ) ? len : 0;\n\t\t\t\t\t\t\t// \t$this.resizeSubGrid( len + 1 );\n\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t$this.highLightGridRowById( new_record.id );\n\t\t\t\t\t\t\t$this.reSelectLastSelectItems();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//Set Page data to widget, next show display info when setDefault Menu\n\t\t\t\t\t$this.pager_data = result.getPagerData();\n\t\t\t\t\t//CLick to show more mode no need this step\n\t\t\t\t\tif ( LocalCacheData.paging_type !== 0 && $this.paging_widget && $this.paging_widget_2 ) {\n\t\t\t\t\t\t$this.paging_widget.setPagerData( $this.pager_data );\n\t\t\t\t\t\t$this.paging_widget_2.setPagerData( $this.pager_data );\n\t\t\t\t\t}\n\t\t\t\t\tif ( LocalCacheData.paging_type === 0 && page_action === 'next' ) {\n\t\t\t\t\t\tvar current_data = $this.grid.getData();\n\t\t\t\t\t\tresult_data = current_data.concat( result_data );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Process result_data if necessary, this always needs override.\n\t\t\t\t\tresult_data = $this.processResultData( result_data );\n\n\t\t\t\t\tif ( $this.grid ) {\n\t\t\t\t\t\t$this.grid.setData( result_data ); //This calls clearGridData and reloadGrid.\n\n\t\t\t\t\t\t//$this.setGridColumnsWidth(); //Handle in searchDone() instead.\n\t\t\t\t\t\t// if ( $this.sub_view_mode && Global.isSet( $this.resizeSubGrid ) ) {\n\t\t\t\t\t\t// \t$this.resizeSubGrid( len );\n\t\t\t\t\t\t// }\n\t\t\t\t\t\t$this.reSelectLastSelectItems();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t$this.setGridCellBackGround(); //Set cell background for some views\n\t\t\t\tProgressBar.closeOverlay(); //Add this in initData\n\t\t\t\tif ( LocalCacheData.paging_type === 0 ) {\n\t\t\t\t\tif ( !$this.pager_data || $this.pager_data.is_last_page ) {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'none' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$this.paging_widget.css( 'display', 'block' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack( result );\n\t\t\t\t}\n\t\t\t\t// when call this from save and new result, we don't call auto open, because this will call onAddClick twice\n\t\t\t\tif ( set_default_menu ) {\n\t\t\t\t\t$this.autoOpenEditViewIfNecessary();\n\t\t\t\t}\n\t\t\t\t$this.searchDone();\n\t\t\t}\n\t\t} );\n\t}\n\n\t//This shouldn't be called anymore, in favor of: baseViewSubTabGridResize()\n\tresizeSubGrid( length ) {\n\t\tvar height = ( length * 26 >= 200 ) ? 200 : length * 26;\n\t\tif ( $( '.edit-view-tab:visible .grid-div' ).length > 1 ) {\n\t\t\tif ( height < 100 ) {\n\t\t\t\theight = 100;\n\t\t\t}\n\t\t} else {\n\t\t\theight = ( $( '.edit-view-tab:visible' ).parent().height() - 85 );\n\t\t}\n\t\tthis.setGridColumnsWidth();\n\t\tthis.setGridHeight( height );\n\t}\n\n\tsetGridColumnsWidth() {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridColumnsWidth();\n\t\t}\n\t}\n\n\tsetGridHeight( height ) {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridHeight( height );\n\t\t}\n\t}\n\n\tsetGridWidth( width ) {\n\t\tif ( this.grid ) {\n\t\t\tthis.grid.setGridWidth( width );\n\t\t}\n\t}\n\n\tprocessResultData( result_data ) {\n\t\t//Always needs override\n\t\treturn result_data;\n\t}\n\n\tsearchDone() {\n\t\t//the rotate icon from search panel\n\t\tvar $this = this;\n\t\t$( '.button-rotate' ).removeClass( 'button-rotate' );\n\n\t\tthis.setTotalDisplaySpan();\n\n\t\tthis.setGridColumnsWidth();\n\t\tthis.setGridSize( this.ui_id, this.sub_view_mode, this.sub_view_grid_autosize, this.pager_data );\n\n\t\tif ( this.sub_view_mode && this.grid ) {\n\t\t\tthis.grid.grid.show();\n\t\t}\n\n\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' );\n\t\tTTPromise.resolve( 'init', 'init' );\n\t}\n\n\treSelectLastSelectItems() {\n\t\tvar $this = this;\n\t\tif ( this.last_select_ids && this.last_select_ids.length > 0 ) {\n\t\t\t$.each( this.last_select_ids, function( index, content ) {\n\t\t\t\t$this.grid.grid.setSelection( content, false );\n\n\t\t\t\tif ( $this.grid_select_id_array ) {\n\t\t\t\t\t$this.grid_select_id_array.push( content );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\tthis.last_select_ids = [];\n\t\t\tif ( !this.edit_view ) {\n\t\t\t\tthis.setDefaultMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tautoOpenEditViewIfNecessary() {\n\t\t//Auto open edit view. Should set in IndexController\n\n\t\tswitch ( LocalCacheData.current_doing_context_action ) {\n\t\t\tcase 'edit':\n\t\t\t\tif ( LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\t\t\tthis.onEditClick( LocalCacheData.edit_id_for_next_open_view );\n\t\t\t\t\tLocalCacheData.edit_id_for_next_open_view = null;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase 'view':\n\t\t\t\tif ( LocalCacheData.edit_id_for_next_open_view ) {\n\t\t\t\t\tthis.onViewClick( LocalCacheData.edit_id_for_next_open_view );\n\t\t\t\t\tLocalCacheData.edit_id_for_next_open_view = null;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'new':\n\t\t\t\tif ( !this.edit_view ) {\n\t\t\t\t\tthis.onAddClick();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.autoOpenEditOnlyViewIfNecessary();\n\t}\n\n\tautoOpenEditOnlyViewIfNecessary() {\n\n\t\t//Don't try to open anything if current loading a sub view\n\t\tif ( this.sub_view_mode ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( LocalCacheData.getAllURLArgs() && LocalCacheData.getAllURLArgs().sm && !LocalCacheData.current_open_edit_only_controller ) {\n\n\t\t\tif ( LocalCacheData.getAllURLArgs().sm.indexOf( 'Report' ) < 0 ) {\n\t\t\t\tIndexViewController.openEditView( this, LocalCacheData.getAllURLArgs().sm, LocalCacheData.getAllURLArgs().sid );\n\t\t\t} else {\n\t\t\t\tIndexViewController.openReport( this, LocalCacheData.getAllURLArgs().sm );\n\n\t\t\t\tif ( LocalCacheData.getAllURLArgs().sid ) {\n\t\t\t\t\tLocalCacheData.default_edit_id_for_next_open_edit_view = LocalCacheData.getAllURLArgs().sid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tsetGridCellBackGround() {\n\t\t//Set background color for in_use=false rows for all policy view and RecurringScheduleTemplateControlView\n\t\tif ( this.grid\n\t\t\t&&\n\t\t\t(\n\t\t\t\tthis.script_name.indexOf( 'Policy' ) >= 0 ||\n\t\t\t\tthis.script_name === 'RecurringScheduleTemplateControlView' ||\n\t\t\t\tthis.script_name === 'PayCodeView' ||\n\t\t\t\tthis.script_name === 'RecurringHolidayView' ||\n\t\t\t\tthis.script_name === 'LegalEntityView' ||\n\t\t\t\tthis.script_name === 'RemittanceSourceAccountView' ||\n\t\t\t\tthis.script_name === 'PayrollRemittanceAgencyView' ||\n\t\t\t\tthis.script_name === 'RemittanceDestinationAccountView'\n\t\t\t)\n\t\t) {\n\t\t\tvar data = this.grid.getData();\n\n\t\t\t//Error: TypeError: data is undefined in /interface/html5/framework/jquery.min.js?v=7.4.6-20141027-074127 line 2 > eval line 70\n\t\t\tif ( !data ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar len = data.length;\n\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tvar item = data[i];\n\n\t\t\t\tif ( item.is_in_use === false ) {\n\t\t\t\t\t$( 'tr[id=\\'' + item.id + '\\']' ).addClass( 'policy-not-in-use' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tshowGridBorders() {\n\t\tvar top_border = $( this.el ).find( '.grid-top-border' );\n\t\tvar bottom_border = $( this.el ).find( '.grid-bottom-border' );\n\n\t\ttop_border.css( 'display', 'block' );\n\t\tbottom_border.css( 'display', 'block' );\n\t}\n\n\t_setGridSizeGroupheight( header_size ) {\n\t\tthis.grid.grid.setGridHeight( ( $( this.el ).height() - ( this.search_panel && this.search_panel.is( ':visible' ) ? this.search_panel.height() : 0 ) - 43 - header_size ) );\n\t}\n\n\tsetEditViewTabSize() {\n\t\tvar $this = this;\n\t\tvar tab_bar_label = this.edit_view_tab.find( '.edit-view-tab-bar-label' );\n\t\tvar tab_width = this.edit_view_tab.width();\n\t\tvar nav_width = this.edit_view_tab.find( '.navigation-div' ).width();\n\t\tvar wrap_div = this.edit_view.find( '.tab-label-wrap' );\n\n\t\tvar total_tab_width = 0;\n\t\ttab_bar_label.children().each( function() {\n\t\t\ttotal_tab_width += $( this ).width();\n\t\t} );\n\n\t\tif ( total_tab_width > ( tab_width - nav_width - 25 ) ) {\n\n\t\t\ttab_bar_label.width( total_tab_width + 10 );\n\n\t\t\tif ( wrap_div.length === 0 ) {\n\t\t\t\tvar right_arrow = $( '<img class=\"tab-arrow tab-right-arrow\" style=\"display: none\" src=\"theme/default/images/right_big_arrow.png\" >' );\n\t\t\t\tvar left_arrow = $( '<img class=\"tab-arrow tab-left-arrow\" style=\"display: none\" src=\"theme/default/images/left_big_arrow.png\" >' );\n\t\t\t\twrap_div = $( '<div class=\"tab-label-wrap\"><div class=\"label-wrap\"></div><div class=\"btn-wrap\"></div></div>' );\n\t\t\t\twrap_div.insertBefore( tab_bar_label );\n\t\t\t\twrap_div.width( tab_width - nav_width - 25 );\n\t\t\t\twrap_div.children().eq( 0 ).width( tab_width - nav_width - 100 );\n\t\t\t\twrap_div.children().eq( 0 ).append( tab_bar_label );\n\t\t\t\twrap_div.children().eq( 1 ).append( left_arrow );\n\t\t\t\twrap_div.children().eq( 1 ).append( right_arrow );\n\n\t\t\t\tright_arrow.bind( 'click', function() {\n\t\t\t\t\twrap_div.children().eq( 0 ).scrollLeft( wrap_div.children().eq( 0 ).scrollLeft() + 500 );\n\t\t\t\t\tsetArrowStatus();\n\t\t\t\t} );\n\t\t\t\tleft_arrow.bind( 'click', function() {\n\t\t\t\t\twrap_div.children().eq( 0 ).scrollLeft( wrap_div.children().eq( 0 ).scrollLeft() - 500 );\n\t\t\t\t\tsetArrowStatus();\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\twrap_div.width( tab_width - nav_width - 25 );\n\t\t\t\twrap_div.children().eq( 0 ).width( tab_width - nav_width - 100 );\n\t\t\t}\n\n\t\t\tif ( tab_bar_label.children().eq( 0 ).is( ':visible' ) && !this.is_mass_editing ) {\n\t\t\t\tthis.edit_view_tab.find( '.tab-arrow' ).show();\n\t\t\t} else {\n\t\t\t\tthis.edit_view_tab.find( '.tab-arrow' ).hide();\n\t\t\t}\n\n\t\t\tsetArrowStatus();\n\n\t\t} else {\n\t\t\ttab_bar_label.width( 'auto' );\n\t\t\tif ( wrap_div.length > 0 ) {\n\t\t\t\ttab_bar_label.insertBefore( wrap_div );\n\t\t\t\twrap_div.remove();\n\n\t\t\t}\n\t\t}\n\n\t\tfunction setArrowStatus() {\n\t\t\tvar left_arrow = $this.edit_view_tab.find( '.tab-left-arrow' );\n\t\t\tvar right_arrow = $this.edit_view_tab.find( '.tab-right-arrow' );\n\t\t\tvar label_wrap = wrap_div.children().eq( 0 );\n\n\t\t\tleft_arrow.removeClass( 'disable-image' );\n\t\t\tright_arrow.removeClass( 'disable-image' );\n\n\t\t\tif ( label_wrap.scrollLeft() === 0 ) {\n\t\t\t\tleft_arrow.addClass( 'disable-image' );\n\t\t\t}\n\n\t\t\tif ( label_wrap.scrollLeft() === label_wrap[0].scrollWidth - label_wrap.width() ) {\n\t\t\t\tright_arrow.addClass( 'disable-image' );\n\t\t\t}\n\n\t\t}\n\t}\n\n\tgetFilterColumnsFromDisplayColumns( column_filter, enable_system_columns ) {\n\t\treturn this._getFilterColumnsFromDisplayColumns( column_filter, enable_system_columns );\n\t}\n\n\t/**\n\t * super for getFilterColumnsFromDisplayColumns\n\t * used when function is overridden by child class.\n\t *\n\t * @param column_filter\n\t * @param enable_system_columns TRUE\n\t * @returns {*}\n\t * @private\n\t */\n\t_getFilterColumnsFromDisplayColumns( column_filter, enable_system_columns ) {\n\t\tif ( !column_filter ) {\n\t\t\tcolumn_filter = {};\n\t\t}\n\n\t\tif ( enable_system_columns == undefined || enable_system_columns == true ) {\n\t\t\tcolumn_filter.is_owner = true;\n\t\t\tcolumn_filter.id = true;\n\t\t\tcolumn_filter.is_child = true;\n\t\t\tcolumn_filter.in_use = true;\n\t\t\tcolumn_filter.first_name = true;\n\t\t\tcolumn_filter.last_name = true;\n\t\t}\n\n\t\tvar display_columns = {};\n\n\t\tif ( Global.isSet( LocalCacheData.view_layout_cache[this.script_name] ) ) {\n\t\t\tvar result = LocalCacheData.view_layout_cache[this.script_name].getResult();\n\t\t\tif ( result != undefined && result.length > 0 ) {\n\t\t\t\tdisplay_columns = result[0].data.display_columns;\n\t\t\t}\n\t\t}\n\n\t\tif ( this.select_layout && this.select_layout.data && this.select_layout.data.display_columns ) {\n\t\t\tfor ( var n in this.select_layout.data.display_columns ) {\n\t\t\t\tdisplay_columns[n] = this.select_layout.data.display_columns[n];\n\t\t\t}\n\t\t}\n\n\t\t//get the default display columns if no columns have been defined.\n\t\tif ( display_columns.length == undefined || ( display_columns.length == 0 && Global.isSet( this.default_display_columns ) ) ) {\n\t\t\tdisplay_columns = this.default_display_columns;\n\t\t}\n\n\t\t//Fixed possible exception -- Error: Unable to get property 'length' of undefined or null reference in /interface/html5/views/BaseViewController.js?v=7.4.3-20140924-090129 line 5031\n\t\tif ( display_columns.length != undefined && display_columns.length > 0 ) {\n\t\t\tvar len = display_columns.length;\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tcolumn_filter[display_columns[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\treturn column_filter;\n\t}\n\n\tgetAllLayouts( callBack ) {\n\n\t\tvar $this = this;\n\n\t\tvar current_select_layout_name;\n\n\t\tif ( this.need_select_layout_name ) {\n\t\t\tcurrent_select_layout_name = this.need_select_layout_name;\n\t\t\tthis.need_select_layout_name = '';\n\t\t} else {\n\t\t\tcurrent_select_layout_name = BaseViewController.default_layout_name;\n\t\t}\n\n\t\tif ( this.sub_view_mode || !this.show_search_tab ) {\n\t\t\t$this.select_layout = null;\n\t\t\tif ( callBack ) {\n\t\t\t\tcallBack();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Check view layout cache.\n\t\tif ( LocalCacheData.view_layout_cache[this.script_name] ) {\n\t\t\t//Make this async way\n\t\t\tsetTimeout( function() {\n\t\t\t\tonGetUserGenericDataResult( LocalCacheData.view_layout_cache[$this.script_name] );\n\t\t\t}, 0 );\n\t\t} else {\n\t\t\tif ( !this.user_generic_data_api ) {\n\t\t\t\tthis.user_generic_data_api = TTAPI.APIUserGenericData;\n\t\t\t}\n\t\t\tthis.user_generic_data_api.getUserGenericData( {\n\t\t\t\tfilter_data: {\n\t\t\t\t\tscript: this.script_name,\n\t\t\t\t\tdeleted: false\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tonResult: function( results ) {\n\t\t\t\t\tonGetUserGenericDataResult( results );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction onGetUserGenericDataResult( results ) {\n\t\t\tif ( results ) {\n\t\t\t\tvar result_data = results.getResult();\n\t\t\t\t$this.select_layout = null; //Reset select layout;\n\t\t\t\tLocalCacheData.view_layout_cache[$this.script_name] = results;\n\t\t\t\tif ( result_data && result_data.length > 0 ) {\n\t\t\t\t\tresult_data.sort( function( a, b ) {\n\t\t\t\t\t\t\treturn Global.compare( a, b, 'name' );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tvar len = result_data.length;\n\t\t\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\t\t\tvar layout = result_data[i];\n\t\t\t\t\t\tif ( layout.name === current_select_layout_name ) {\n\t\t\t\t\t\t\t$this.select_layout = layout;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( !$this.select_layout ) {\n\t\t\t\t\t\t$this.select_layout = result_data[0];\n\t\t\t\t\t}\n\t\t\t\t\t$this.search_panel.setLayoutsArray( result_data );\n\t\t\t\t} else {\n\t\t\t\t\t$this.select_layout = null;\n\t\t\t\t\tif ( $this.search_panel ) {\n\t\t\t\t\t\t$this.search_panel.setLayoutsArray( null );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAllColumns( callBack ) {\n\t\tvar $this = this;\n\t\tthis.api.getOptions( 'columns', {\n\t\t\tonResult: function( columns_result ) {\n\t\t\t\tvar columns_result_data = columns_result.getResult();\n\n\t\t\t\t$this.all_columns = Global.buildColumnArray( columns_result_data );\n\t\t\t\tif ( !$this.sub_view_mode && $this.column_selector ) {\n\t\t\t\t\t$this.column_selector.setUnselectedGridData( $this.all_columns );\n\t\t\t\t\t$this.column_selector.setHeight( $this.all_columns.length * 32 );\n\t\t\t\t}\n\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tgetDefaultDisplayColumns( callBack ) {\n\n\t\tvar $this = this;\n\t\tthis.api.getOptions( 'default_display_columns', {\n\t\t\tonResult: function( columns_result ) {\n\n\t\t\t\tvar columns_result_data = columns_result.getResult();\n\n\t\t\t\t$this.default_display_columns = columns_result_data;\n\n\t\t\t\tif ( callBack ) {\n\t\t\t\t\tcallBack();\n\t\t\t\t}\n\n\t\t\t}\n\t\t} );\n\t}\n\n\tbuildSortBySelectColumns() {\n\t\tvar sort_by_array = this.select_layout.data.filter_sort;\n\t\tvar sort_by_select_columns = [];\n\t\tvar sort_by_unselect_columns = this.sort_by_selector.getSourceData();\n\n\t\tif ( sort_by_array ) {\n\t\t\t$.each( sort_by_array, function( index, content ) {\n\n\t\t\t\tfor ( var key in content ) {\n\n\t\t\t\t\t$.each( sort_by_unselect_columns, function( index1, content1 ) {\n\t\t\t\t\t\tif ( content1.value === key ) {\n\t\t\t\t\t\t\tcontent1.sort = content[key];\n\t\t\t\t\t\t\tsort_by_select_columns.push( content1 );\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t} );\n\t\t}\n\n\t\treturn sort_by_select_columns;\n\t}\n\n\tbuildSortSelectorUnSelectColumns( display_columns ) {\n\t\tvar fina_array = [];\n\t\tvar i = 100;\n\t\t$.each( display_columns, function( index, content ) {\n\t\t\tvar new_content = $.extend( {}, content );\n\t\t\tnew_content.id = i; //Need\n\t\t\tnew_content.sort = 'asc';\n\t\t\tfina_array.push( new_content );\n\t\t\ti = i + 1;\n\t\t} );\n\n\t\treturn fina_array;\n\t}\n\n\tbuildDisplayColumns( apiDisplayColumnsArray ) {\n\n\t\tvar len = this.all_columns.length;\n\t\tvar len1 = apiDisplayColumnsArray.length;\n\t\tvar display_columns = [];\n\n\t\tfor ( var j = 0; j < len1; j++ ) {\n\t\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\t\tif ( apiDisplayColumnsArray[j] === this.all_columns[i].value ) {\n\t\t\t\t\tdisplay_columns.push( this.all_columns[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn display_columns;\n\t}\n\n\tbuildDisplayColumnsByColumnModel( colModel ) {\n\n\t\tif ( !colModel ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar len = colModel.length;\n\t\tvar display_columns = [];\n\t\tvar id = 2000; // Makse sure the id not duplicate with all_columns, this wiil be used in acombox, set possible columns in navigation mode\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar column = colModel[i];\n\t\t\tif ( column.name === 'cb' ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tdisplay_columns.push( { label: column.label, value: column.name, id: id } );\n\t\t\tid = id + 1;\n\t\t}\n\n\t\treturn display_columns;\n\t}\n\n\tremoveContentMenuByName( name ) {\n\t\tif ( !LocalCacheData.current_open_primary_controller ) {\n\t\t\treturn;\n\t\t}\n\t\tvar primary_view_id = LocalCacheData.current_open_primary_controller.viewId;\n\t\t//var select_menu_id = TopMenuManager.menus_quick_map[primary_view_id];\n\t\t//if ( TopMenuManager.ribbon_view_controller && TopMenuManager.selected_menu_id && TopMenuManager.selected_menu_id.indexOf( 'ContextMenu' ) !== -1 ) {\n\t\t//\tTopMenuManager.ribbon_view_controller.setSelectMenu( select_menu_id );\n\t\t//}\n\n\t\tif ( !Global.isSet( name ) ) {\n\t\t\tname = this.context_menu_name;\n\t\t}\n\n\t\tvar tab = $( '#ribbon ul a' ).filter( function() {\n\t\t\treturn $( this ).attr( 'ref' ) === name;\n\t\t} ).parent();\n\n\t\tvar index = $( 'li', $( '#ribbon' ) ).index( tab );\n\t\tif ( index >= 0 ) {\n\t\t\t// $( '#ribbon_view_container' ).tabs( {'remove': index} );\n\t\t\t$( '#ribbon_view_container' ).tabs( 'refresh' );\n\t\t}\n\t}\n\n\tmovePermissionValidate( p_id ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.addPermissionValidate( p_id ) && this.deletePermissionValidate( p_id ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsubAuditValidate() {\n\t\tif ( this.editPermissionValidate() ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsubDocumentValidate() {\n\t\tif ( ( Global.getProductEdition() >= 20 ) && PermissionManager.checkTopLevelPermission( 'Document' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\taddPermissionValidate( p_id ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'add' ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetRecordFromGridById( id ) {\n\n\t\tvar data = this.grid.getData();\n\t\tvar result = null;\n\t\t/* jshint ignore:start */\n\t\t//id could be string or number.\n\t\t$.each( data, function( index, value ) {\n\n\t\t\tif ( value.id == id ) {\n\t\t\t\tresult = Global.clone( value );\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t} );\n\t\t/* jshint ignore:end */\n\t\treturn result;\n\t}\n\n\tgetSelectedItems() {\n\t\tvar $this = this;\n\t\tvar selected_items = [];\n\t\tif ( this.edit_view ) {\n\t\t\tselected_items = [this.current_edit_record];\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\t\t\tselected_items = _.map( grid_selected_id_array, function( id ) {\n\t\t\t\treturn $this.getRecordFromGridById( id );\n\t\t\t} );\n\t\t}\n\t\treturn selected_items;\n\t}\n\n\tgetSelectedItem() {\n\n\t\tvar selected_item = null;\n\t\tif ( this.edit_view ) {\n\t\t\tselected_item = this.current_edit_record;\n\t\t} else {\n\t\t\tvar grid_selected_id_array = this.getGridSelectIdArray();\n\t\t\tvar grid_selected_length = grid_selected_id_array.length;\n\n\t\t\tif ( grid_selected_length > 0 ) {\n\t\t\t\tselected_item = this.getRecordFromGridById( grid_selected_id_array[0] );\n\t\t\t}\n\n\t\t}\n\n\t\tif ( selected_item ) {\n\t\t\treturn Global.clone( selected_item );\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tdeleteOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'delete' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'delete_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'delete_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tviewOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'view' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'view_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'view_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditOwnerOrChildPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !p_id ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !selected_item ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\tPermissionManager.validate( p_id, 'edit' ) ||\n\t\t\t( selected_item && selected_item.is_owner && PermissionManager.validate( p_id, 'edit_own' ) ) ||\n\t\t\t( selected_item && selected_item.is_child && PermissionManager.validate( p_id, 'edit_child' ) ) ) {\n\n\t\t\treturn true;\n\n\t\t}\n\n\t\treturn false;\n\t}\n\n\townerOrChildPermissionValidate( p_id, permission_name, selected_item ) {\n\n\t\tvar field;\n\t\tif ( permission_name.indexOf( 'child' ) > -1 ) {\n\t\t\tfield = 'is_child';\n\t\t} else {\n\t\t\tfield = 'is_owner';\n\t\t}\n//\n//\t\tif ( PermissionManager.validate( p_id, permission_name ) &&\n//\t\t\t(!selected_item ||\n//\t\t\t\t( selected_item && (selected_item[field] || (!selected_item.id && !selected_item.hasOwnProperty( field )) ) ) ) ) {\n//\t\t\treturn true;\n//\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, permission_name ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditChildPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( !PermissionManager.validate( p_id, 'enabled' ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'edit' ) ||\n\t\t\tthis.ownerOrChildPermissionValidate( p_id, 'edit_child', selected_item ) ) {\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\teditPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'edit' ) || this.ownerOrChildPermissionValidate( p_id, 'edit_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'edit_own', selected_item ) ) {\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcopyPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.viewPermissionValidate( p_id, selected_item ) && this.addPermissionValidate( p_id, selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tcopyAsNewPermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( this.viewPermissionValidate( p_id, selected_item ) && this.addPermissionValidate( p_id, selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tviewPermissionValidate( p_id, selected_item ) {\n\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'view' ) || this.ownerOrChildPermissionValidate( p_id, 'view_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'view_own', selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdeletePermissionValidate( p_id, selected_item ) {\n\t\tif ( !Global.isSet( p_id ) ) {\n\t\t\tp_id = this.permission_id;\n\t\t}\n\n\t\tif ( !Global.isSet( selected_item ) ) {\n\t\t\tselected_item = this.getSelectedItem();\n\t\t}\n\n\t\tif ( p_id === 'report' ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif ( PermissionManager.validate( p_id, 'delete' ) || this.ownerOrChildPermissionValidate( p_id, 'delete_child', selected_item ) || this.ownerOrChildPermissionValidate( p_id, 'delete_own', selected_item ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tsaveValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t}\n\t}\n\n\tsaveAndCopyValidate( context_btn, p_id ) {\n\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) || !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsaveAndContinueValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) || !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t} else if ( ( ( !this.current_edit_record || !this.current_edit_record.id ) && this.is_mass_editing ) || this.current_edit_record.id ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsaveAndNewValidate( context_btn, p_id ) {\n\t\tif ( ( !this.current_edit_record || !this.current_edit_record.id ) && !this.is_mass_editing ) {\n\t\t\tif ( !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t} else if ( ( !Global.isSet( this.current_edit_record.id ) && this.is_mass_editing ) || Global.isSet( this.current_edit_record.id ) ) {\n\n\t\t\tif ( !this.editPermissionValidate( p_id ) || !this.addPermissionValidate( p_id ) ) {\n\t\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t\t}\n\t\t}\n\n\t\tif ( this.edit_only_mode ) {\n\t\t\tcontext_btn.addClass( 'invisible-image' );\n\t\t}\n\t}\n\n\tsetSubLogViewFilter() {\n\t\t// #2761 Refactor of setSubLogViewController and setSubViewFilterFunction into setSubLogViewFilter\n\t\t// This refactor is because the key value attributes are linked with the filter.\n\t\t// In general, it was found that either the key value are set, or the filters, but not both. So makes sense to be in the same function. Not confirmed that this is the case in all views, so its not been made into an 'either or' function.\n\n\t\tif ( !this.sub_log_view_controller ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Option #1: filter on single criteria (default)\n\t\tthis.sub_log_view_controller.parent_key = 'object_id';\n\t\tthis.sub_log_view_controller.parent_value = this.uniformVariable( this.current_edit_record ).id;\n\t\tthis.sub_log_view_controller.table_name_key = this.table_name_key;\n\n\t\t// Option #2: filter on multiple criteria.\n\n\t\t// #2761: Filter function appears to only work if parent_key, value and table are null or not set.\n\t\t// Filter structure works similar to pseudo code: WHERE ( table_name = 'punch' AND object_id = '$punch_id') OR ( table_name = 'punch_control' AND object_id = '$punch_control_id' )\n\t\t// key, value, table lines can just be ommitted, as default state is null. Included here for emphasis in example.\n\t\t// this.sub_log_view_controller.parent_key = null;\n\t\t// this.sub_log_view_controller.parent_value = null;\n\t\t// this.sub_log_view_controller.table_name_key = null;\n\t\t// this.sub_log_view_controller.getSubViewFilter = function ( filter ) {\n\t\t// \tfilter['table_name_object_id'] = {\n\t\t// \t\t'punch': [this.parent_edit_record.id],\n\t\t// \t\t'punch_control': [this.parent_edit_record.punch_control_id]\n\t\t// \t};\n\t\t//\n\t\t// \treturn filter;\n\t\t// };\n\n\t\treturn true;\n\t}\n\n\tinitSubLogView( tab_id ) {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id || this.current_edit_record.id == TTUUID.zero_id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_log_view_controller ) {\n\t\t\t// If the Audit tab has already been opened before in this edit view.\n\t\t\tthis.sub_log_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_log_view_controller.setDefaultMenu();\n\t\t\tthis.sub_log_view_controller.parent_edit_record = this.current_edit_record;\n\t\t\tthis.setSubLogViewFilter(); // triggers the setting of the filter function for views that need it.\n\t\t\t// $this.sub_log_view_controller.parent_key = 'object_id';\n\t\t\t// $this.sub_log_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t// $this.sub_log_view_controller.table_name_key = $this.table_name_key;\n\n\t\t\tthis.sub_log_view_controller.search();\n\t\t} else {\n\t\t\t// If the Audit tab has NOT yet been opened before in this edit view.\n\t\t\tGlobal.loadScript( 'views/core/log/LogViewController.js', function() {\n\t\t\t\tif ( !$this.edit_view_tab ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar tab = $this.edit_view_tab.find( '#' + tab_id );\n\t\t\t\tvar firstColumn = tab.find( '.first-column-sub-view' );\n\n\t\t\t\tTTPromise.add( 'initSubAudit', 'init' );\n\t\t\t\tTTPromise.wait( 'initSubAudit', 'init', function() {\n\t\t\t\t\tfirstColumn.css( 'opacity', '1' );\n\t\t\t\t} );\n\n\t\t\t\tfirstColumn.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\n\t\t\t\tGlobal.trackView( 'Sub' + 'Log' + 'View', LocalCacheData.current_doing_context_action );\n\t\t\t\tLogViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\t\t\t} );\n\t\t}\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_log_view_controller = subViewController;\n\t\t\t$this.sub_log_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_log_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.setSubLogViewFilter(); // triggers the setting of the filter function for views that need it.\n\t\t\t// $this.sub_log_view_controller.parent_key = 'object_id';\n\t\t\t// $this.sub_log_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t// $this.sub_log_view_controller.table_name_key = $this.table_name_key;\n\n\t\t\t$this.sub_log_view_controller.postInit = function() {\n\t\t\t\tthis.initData();\n\t\t\t};\n\n\t\t}\n\t}\n\n\tshowNoResultCover( show_new_btn ) {\n\t\tif ( !show_new_btn ) {\n\t\t\tshow_new_btn = this.ifContextButtonExist( ContextMenuIconName.add );\n\t\t}\n\n\t\tthis.removeNoResultCover();\n\t\tthis.no_result_box = Global.loadWidgetByName( WidgetNamesDic.NO_RESULT_BOX );\n\t\tthis.no_result_box.NoResultBox( { related_view_controller: this, is_new: show_new_btn } );\n\t\tthis.no_result_box.attr( 'id', this.ui_id + '_no_result_box' );\n\n\t\tvar grid_div = $( this.el ).find( '.grid-div' );\n\n\t\tgrid_div.append( this.no_result_box );\n\n\t\tthis.initRightClickMenu( RightClickMenuType.NORESULTBOX );\n\t}\n\n\tremoveNoResultCover() {\n\n\t\tif ( this.no_result_box && this.no_result_box.length > 0 ) {\n\t\t\tthis.no_result_box.remove();\n\t\t}\n\t\tthis.no_result_box = null;\n\t}\n\n\tcleanWhenUnloadView( callBack ) {\n\n\t\tthis.removeContentMenuByName();\n\t\tif ( Global.isSet( callBack ) ) {\n\t\t\tcallBack();\n\t\t}\n\t}\n\n\tgridScrollTop() {\n\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().scrollTop( 0 );\n\t}\n\n\tgridScrollDown() {\n\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().scrollTop( 10000 );\n\t}\n\n\tselectAll() {\n\t\tif ( this.viewId === 'TimeSheet' || this.viewId === 'Schedule' ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !this.grid ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.grid.grid.resetSelection();\n\t\tvar source_data = this.grid.getData();\n\t\tvar len = source_data.length;\n\t\tfor ( var i = 0; i < len; i++ ) {\n\t\t\tvar item = source_data[i];\n\t\t\tif ( Global.isSet( item.id ) ) {\n\t\t\t\tthis.grid.grid.setSelection( item.id, false );\n\t\t\t} else {\n\t\t\t\tthis.grid.grid.setSelection( i + 1, false );\n\t\t\t}\n\n\t\t}\n\n\t\tthis.grid.grid.parent().parent().parent().find( '.cbox-header' ).prop( 'checked', true );\n\t\tthis.setDefaultMenu();\n\t}\n\n\tdetachElement( key ) {\n\t\t//Error: Uncaught TypeError: Cannot read property 'detach' of undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150824-110300 line 6441\n\t\tif ( !this.edit_view_form_item_dic || !this.edit_view_form_item_dic[key] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar place_holder = $( '<p style=\"display: none\">' );\n\t\tplace_holder.addClass( '.edit-view:visible place_holder_' + key );\n\t\tplace_holder.insertBefore( this.edit_view_form_item_dic[key] );\n\t\tthis.edit_view_form_item_dic[key].detach();\n\t}\n\n\tattachElement( key ) {\n\t\t//Error: Uncaught TypeError: Cannot read property 'insertBefore' of undefined in interface/html5/views/BaseViewController.js?v=9.0.0-20150822-210544 line 6439\n\t\tif ( !this.edit_view_form_item_dic || !this.edit_view_form_item_dic[key] ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//var place_holder = $( '.edit-view:visible .edit-view-tab:visible .place_holder_' + key);\n\t\tvar place_holder = $( '.edit-view:visible .place_holder_' + key );\n\t\tthis.edit_view_form_item_dic[key].insertBefore( place_holder );\n\t\tplace_holder.remove();\n\t}\n\n\tgetBalanceHandler( result, last_date_stamp ) {\n\t\tvar $this = this;\n\t\tvar available_balance_value, current_time_value, remaining_balance_value, summary_available_value;\n\n\t\t//Error: TypeError: this.edit_view_ui_dic.available_balance is undefined in /interface/html5/framework/jquery.min.js?v=8.0.0-20141117-091433 line 2 > eval line 6570\n\t\tif ( !$this.edit_view_ui_dic || !$this.edit_view_ui_dic['available_balance'] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( Global.isObject( result ) ) {\n\t\t\tvar result_data = result.getResult();\n\t\t\tif ( !result_data ) {\n\t\t\t\t$this.detachElement( 'available_balance' );\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\t$this.detachElement( 'available_balance' );\n\t\t\treturn;\n\t\t}\n\t\t$this.attachElement( 'available_balance' );\n\n\t\tavailable_balance_value = Global.getTimeUnit( result_data.available_balance );\n\t\tcurrent_time_value = Global.getTimeUnit( result_data.current_time );\n\t\tremaining_balance_value = Global.getTimeUnit( result_data.remaining_balance );\n\t\tsummary_available_value = Global.getTimeUnit( result_data.projected_remaining_balance );\n\t\tif ( result_data.hasOwnProperty( 'remaining_dollar_balance' ) ) {\n\t\t\tavailable_balance_value = available_balance_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.available_dollar_balance;\n\t\t\tcurrent_time_value = current_time_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.current_dollar_amount;\n\t\t\tremaining_balance_value = remaining_balance_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.remaining_dollar_balance;\n\t\t\tsummary_available_value = summary_available_value + ' / ' + LocalCacheData.getCurrentCurrencySymbol() + result_data.remaining_dollar_balance;\n\t\t}\n\t\t$this.edit_view_ui_dic['available_balance'].setValue( summary_available_value );\n\n\t\t//If available balance is negative, change font color to red so its more noticable.\n\t\tif ( result_data.projected_remaining_balance < 0 ) {\n\t\t\t$this.edit_view_ui_dic['available_balance'].css( 'color', 'red' ); //Font color to red.\n\t\t} else {\n\t\t\t$this.edit_view_ui_dic['available_balance'].css( 'color', 'black' );\n\t\t}\n\n\t\t$this.available_balance_info.qtip(\n\t\t\t{\n\t\t\t\tshow: {\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tdelay: 10,\n\t\t\t\t\teffect: true\n\t\t\t\t},\n\n\t\t\t\thide: {\n\t\t\t\t\tevent: 'unfocus'\n\t\t\t\t},\n\n\t\t\t\tstyle: {\n\t\t\t\t\t//classes: 'cream',\n\t\t\t\t\twidth: 340 //Dynamically changing the width causes display bugs when switching between Absence Policies and thereby widths.\n\t\t\t\t},\n\t\t\t\tcontent: '<div style=\"width:100%;\">' +\n\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Available Balance' ) + ': </span><span style=\"float:right;\">' + available_balance_value + '</span></div>' +\n\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Current Time' ) + ': </span><span style=\"float:right;\">' + current_time_value + '</span></div>' +\n\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Remaining Balance' ) + ': </span><span style=\"float:right;\">' + remaining_balance_value + '</span></div>' +\n\t\t\t\t\t'<div style=\"width:100%; height: 20px; clear: both;\"></div>' +\n\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Projected Balance by' ) + ' ' + last_date_stamp + ': </span><span style=\"float:right;\">' + Global.getTimeUnit( result_data.projected_balance ) + '</span></div>' +\n\t\t\t\t\t'<div style=\"width:100%; clear: both;\"><span style=\"float:left;\">' + $.i18n._( 'Projected Remaining Balance' ) + ':</span><span style=\"float:right;\">' + Global.getTimeUnit( result_data.projected_remaining_balance ) + '</span></div>' +\n\t\t\t\t\t'</div>'\n\t\t\t} );\n\t}\n\n\tonExportClick( method ) {\n\t\tProgressBar.showOverlay();\n\t\tif ( method == undefined ) {\n\t\t\tmethod = this.api['export' + this.api.key_name];\n\t\t}\n\n\t\t//Debug.Text('Exporting Grid To CSV: '+method, 'BaseViewController.js', 'BaseViewController', 'onExportClick', 10);\n\n\t\tvar args = {};\n\t\targs.filter_columns = this._getFilterColumnsFromDisplayColumns( null, false );\n\t\targs.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\tif ( Global.isSet( this.sort_by_selector ) ) {\n\t\t\targs.filter_sort = this.getSearchPanelSortFilter();\n\t\t}\n\t\tvar post_data = { 0: 'csv', 1: args, 2: true };\n\n\t\tGlobal.APIFileDownload( this.api.className, method, post_data );\n\t}\n\n\thighLightGridRowById( id ) {\n\t\tif ( this.grid && this.grid.grid ) {\n\t\t\tthis.grid.grid.find( 'tr#' + id ).addClass( 'flashBackground' );\n\t\t\tthis.gridScrollDown();\n\t\t}\n\t}\n\n\tsetConversionRateExampleText( conversion_rate, iso_code, currency_id ) {\n\t\tvar data = {};\n\t\tdata.filter_data = Global.convertLayoutFilterToAPIFilter( this.select_layout );\n\t\tvar api = TTAPI.APICurrency;\n\t\tvar my_currencies = api.getCurrency( data, { async: false } ).getResult();\n\t\tvar base_currency_iso_code = '';\n\t\tif ( this.edit_view_ui_dic.round_decimal_places ) {\n\t\t\tvar decimal_places = this.edit_view_ui_dic.round_decimal_places.getValue();\n\t\t}\n\t\tfor ( var i = 0; i < my_currencies.length; i++ ) {\n\t\t\tif ( my_currencies[i].is_base ) {\n\t\t\t\tbase_currency_iso_code = my_currencies[i].iso_code;\n\n\t\t\t}\n\t\t\tif ( currency_id && !iso_code && my_currencies[i].id == currency_id ) {\n\t\t\t\tiso_code = my_currencies[i].iso_code;\n\t\t\t\tif ( !decimal_places ) {\n\t\t\t\t\tdecimal_places = my_currencies[i].round_decimal_places;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//need different id on the subview for rate.\n\t\tif ( iso_code != base_currency_iso_code ) {\n\t\t\tif ( this.sub_view_mode ) {\n\t\t\t\t$( '#rate_conversion_rate_clarification_box' ).html( '&nbsp;&nbsp;1.00 ' + base_currency_iso_code + ' = ' + Global.removeTrailingZeros( conversion_rate, decimal_places ) + ' ' + iso_code );\n\t\t\t} else {\n\t\t\t\t$( '#conversion_rate_clarification_box' ).html( '&nbsp;&nbsp;1.00 ' + base_currency_iso_code + ' = ' + Global.removeTrailingZeros( conversion_rate, decimal_places ) + ' ' + iso_code );\n\t\t\t}\n\t\t} else {\n\t\t\t$( '#conversion_rate_clarification_box' ).hide();\n\t\t}\n\t}\n\n\t/**\n\t * gets default coordinates object for maps.\n\t */\n\tstartMapCoordinates() {\n\t\tvar lat = 39.50;\n\t\tvar lng = -98.35;\n\n\t\tif ( LocalCacheData.getCurrentCompany().latitude != 0 && LocalCacheData.getCurrentCompany().longitude != 0 ) {\n\t\t\tlat = LocalCacheData.getCurrentCompany().latitude;\n\t\t\tlng = LocalCacheData.getCurrentCompany().longitude;\n\t\t\tDebug.Text( 'Using company coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t} else if ( LocalCacheData.getLoginUser().latitude != 0 && LocalCacheData.getLoginUser().longitude != 0 ) {\n\t\t\tlat = LocalCacheData.getLoginUser().latitude;\n\t\t\tlng = LocalCacheData.getLoginUser().longitude;\n\t\t\tDebug.Text( 'Using user coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t} else {\n\t\t\tvar company_api = TTAPI.APICompany;\n\t\t\tvar country_arr = company_api.getOptions( 'country', { async: false } ).getResult();\n\t\t\tvar province_arr = company_api.getOptions( 'province', LocalCacheData.getCurrentCompany().country, { async: false } ).getResult();\n\n\t\t\tif ( APIGlobal.pre_login_data.map_geocode_url && province_arr && country_arr && province_arr[LocalCacheData.getCurrentCompany().province] && country_arr[LocalCacheData.getCurrentCompany().country] ) {\n\t\t\t\tvar query = LocalCacheData.getCurrentCompany().city + ' ' + province_arr[LocalCacheData.getCurrentCompany().province] + ', ' + country_arr[LocalCacheData.getCurrentCompany().country];\n\t\t\t\tvar url = APIGlobal.pre_login_data.map_geocode_url + '?q=' + query + '&format=json&tt_key=' + APIGlobal.pre_login_data.registration_key;\n\t\t\t\tvar result = jQuery.ajax( { url: url, async: false } );\n\t\t\t\tDebug.Arr( 'Geocoding address: ' + query, result, 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t}\n\n\t\t\tif ( result && result.responseJSON && result.responseJSON[0] && result.responseJSON[0].lat && result.responseJSON[0].lon ) {\n\t\t\t\tlat = result.responseJSON[0].lat;\n\t\t\t\tlng = result.responseJSON[0].lon;\n\t\t\t\tDebug.Text( 'Using company address coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t} else {\n\t\t\t\tDebug.Text( 'Using default coordinates.', 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\t\t}\n\t\t}\n\n\t\tDebug.Text( 'Coordinates (lat,long): ' + lat + ',' + lng, 'BaseViewController.js', 'BaseViewController', 'startMapCoordinates', 10 );\n\t\treturn new L.LatLng( lat, lng );\n\t}\n\n\tinitSubDocumentView() {\n\t\tvar $this = this;\n\n\t\tif ( !this.current_edit_record.id ) {\n\t\t\tTTPromise.resolve( 'BaseViewController', 'onTabShow' ); //Since search() isn't called in this case, and we just display the \"Please Save This Record ...\" message, resolve the promise.\n\t\t\treturn;\n\t\t}\n\n\t\tif ( this.sub_document_view_controller ) {\n\t\t\tthis.sub_document_view_controller.buildContextMenu( true );\n\t\t\tthis.sub_document_view_controller.setDefaultMenu();\n\t\t\t$this.sub_document_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_document_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_document_view_controller.initData();\n\t\t\treturn;\n\t\t}\n\n\t\tGlobal.loadScript( 'views/document/DocumentViewController.js', function() {\n\t\t\tif ( !$this.edit_view_tab ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar tab_contact_info = $this.edit_view_tab.find( '#tab_attachment' );\n\t\t\tvar firstColumn = tab_contact_info.find( '.first-column-sub-view' );\n\n\t\t\tTTPromise.add( 'initSubDocumentView', 'init' );\n\t\t\tTTPromise.wait( 'initSubDocumentView', 'init', function() {\n\t\t\t\tfirstColumn.css( 'opacity', '1' );\n\t\t\t} );\n\n\t\t\tfirstColumn.css( 'opacity', '0' ); //Hide the grid while its loading/sizing.\n\n\t\t\tGlobal.trackView( 'SubDocumentView' );\n\t\t\tDocumentViewController.loadSubView( firstColumn, beforeLoadView, afterLoadView );\n\n\t\t} );\n\n\t\tfunction beforeLoadView() {\n\n\t\t}\n\n\t\tfunction afterLoadView( subViewController ) {\n\t\t\t$this.sub_document_view_controller = subViewController;\n\t\t\t$this.sub_document_view_controller.parent_key = 'object_id';\n\t\t\t$this.sub_document_view_controller.parent_value = $this.current_edit_record.id;\n\t\t\t$this.sub_document_view_controller.document_object_type_id = $this.document_object_type_id;\n\t\t\t$this.sub_document_view_controller.parent_edit_record = $this.current_edit_record;\n\t\t\t$this.sub_document_view_controller.parent_view_controller = $this;\n\t\t\t$this.sub_document_view_controller.initData();\n\t\t}\n\t}\n\n\tonDeleteImage( callback ) {\n\t\tvar $this = this;\n\t\tthis.api.deleteImage( this.current_edit_record.id, {\n\t\t\tonResult: function( result ) {\n\t\t\t\t$this.onEditClick( $this.current_edit_record.id, true );\n\t\t\t}\n\t\t} );\n\t}\n\n\tonTreeGridNavigationRowSelect( id ) {\n\t\tif ( !id ) {\n\t\t\treturn;\n\t\t}\n\n\t\t//don't close on collapse of tree mode element\n\t\tif ( LocalCacheData.currently_collapsing_navigation_tree_element != true ) {\n\t\t\tthis.onEditClick( id );\n\t\t\t$( '.a-dropdown-div' ).remove();\n\t\t\tLocalCacheData.openAwesomeBox = null;\n\t\t} else {\n\t\t\tLocalCacheData.currently_collapsing_navigation_tree_element = false;\n\t\t\tthis.onEditClick( id, true );\n\t\t\tthis.setNavigation();\n\t\t}\n\t}\n\n\tparserDatesRange( date ) {\n\t\tvar dates = date.split( \" - \" );\n\t\tvar resultArray = [];\n\t\tvar beginDate = Global.strToDate( dates[0] );\n\t\tvar endDate = Global.strToDate( dates[1] );\n\n\t\tvar nextDate = beginDate;\n\n\t\twhile ( nextDate.getTime() < endDate.getTime() ) {\n\t\t\tresultArray.push( nextDate.format() );\n\t\t\tnextDate = new Date( new Date( nextDate.getTime() ).setDate( nextDate.getDate() + 1 ) );\n\t\t}\n\n\t\tresultArray.push( dates[1] );\n\n\t\treturn resultArray;\n\t}\n\n\tbaseViewSubTabGridResize( id ) {\n\t\tif ( !id ) {\n\t\t\tid = '.edit-view-tab-outside-sub-view';\n\t\t} else if ( id.indexOf( '#' ) === -1 && id.indexOf( '.' ) != 0 ) {\n\t\t\tid = '#' + id;\n\t\t}\n\n\t\tif ( this.grid.grid.parents( id ).length > 0 ) {\n\t\t\tvar offset = 53;\n\t\t\tif ( this.grid.grid.parents( id ).find( '.audit-info' ).length > 0 ) {\n\t\t\t\t//audit info div height\n\t\t\t\toffset += this.grid.grid.parents( id ).find( '.audit-info' ).height() + 20;\n\t\t\t}\n\n\t\t\tif ( this.grid.grid.parents( id ).parents( '.wizard' ).length > 0 ) {\n\t\t\t\t//Wizard view.\n\t\t\t\toffset += this.getDefaultHeightOffset() - 90;\n\t\t\t}\n\n\t\t\tif ( this.paging_widget && this.paging_widget.getPagerData() && ( this.paging_widget.getPagerData().total_rows == false || this.paging_widget.getPagerData().total_rows >= LocalCacheData.getLoginUserPreference().items_per_page ) ) {\n\t\t\t\toffset += 25;\n\t\t\t}\n\n\t\t\tif ( this.grid.grid.parents( '.ui-jqgrid-bdiv' ).width() > this.grid.grid.parents( '.ui-jqgrid-jquery-ui' ).width() ) {\n\t\t\t\toffset += 24; //Scrollbar offset\n\t\t\t\tDebug.Text( 'Scrollbar offset detected: 15', 'BaseViewController.js', 'BaseViewController', 'baseViewSubTabGridResize', 10 );\n\t\t\t}\n\n\t\t\tvar height = ( this.grid.grid.parents( id ).innerHeight() - offset );\n\n\t\t\tthis.grid.setup.container_selector = id;\n\n\t\t\tDebug.Text( 'Special SubView ID: ' + id + ' Height: ' + height + ' Offset: ' + offset, 'TTGrid.js', 'TTGrid', 'baseViewSubTabGridResize', 10 );\n\t\t} else {\n\t\t\tvar offset = this.getDefaultHeightOffset();\n\t\t\tvar height = ( this.grid.grid.parents( '.edit-view-tab' ).innerHeight() - offset );\n\n\t\t\tDebug.Text( 'Normal SubView ID: ' + id + ' Height: ' + height + ' Offset: ' + offset, 'TTGrid.js', 'TTGrid', 'baseViewSubTabGridResize', 10 );\n\t\t}\n\n\t\tthis.setGridHeight( height );\n\t\tthis.setGridWidth();\n\t}\n\n\t/**\n\t * Sets the grid's height.\n\t * @param ui_id\n\t * @param sub_view_mode\n\t * @param sub_view_grid_autosize\n\t * @param pager_data\n\t */\n\tsetGridSize( ui_id, sub_view_mode, sub_view_grid_autosize, pager_data ) {\n\t\tif ( this.grid && this.grid.setup && this.grid.setup.setGridSize && typeof this.grid.setup.setGridSize == 'function' ) {\n\t\t\tthis.grid.setup.setGridSize();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ( !ui_id && !this.ui_id ) || !this.grid ) {\n\t\t\tDebug.Text( 'ERROR: You must provide at least a ui_id for setGridSize()', 'TTGrid.js', 'TTGrid', 'setGridSize', 10 );\n\t\t\treturn;\n\t\t}\n\n\t\tif ( !ui_id && this.ui_id ) {\n\t\t\tui_id = this.ui_id;\n\t\t}\n\n\t\tif ( !sub_view_mode && this.sub_view_mode ) {\n\t\t\tsub_view_mode = this.sub_view_mode;\n\t\t}\n\n\t\tif ( !sub_view_grid_autosize && this.sub_view_grid_autosize ) {\n\t\t\tsub_view_grid_autosize = this.sub_view_grid_autosize;\n\t\t}\n\n\t\t//this.setGridWidth ( this.setGridColumnsWidth() );\n\n\t\tvar height = 100;\n\n\t\tif ( sub_view_mode &&\n\t\t\tthis.grid.grid.parents( '.grid-div' ).find( '.no-result-div:visible' ).length > 0 &&\n\t\t\tthis.grid.grid.parents( '#tab_history, #tab_qualifications' ).length > 0\n\t\t) {\n\t\t\theight = 100;\n\t\t} else if ( this.grid.setup.static_height ) {\n\t\t\theight = this.grid.setup.static_height;\n\t\t} else if ( this.grid.setup.verticalResize && this.grid.setup.verticalResize === true ) {\n\n\t\t\tvar header_table = $( 'table[aria-labelledby=gbox_' + ui_id + '_grid]' );\n\t\t\tvar header_size = header_table.height();\n\t\t\tif ( this.grid.setup.tree_mode ) {\n\t\t\t\theader_size = 0;\n\t\t\t}\n\t\t\tif ( sub_view_mode ) {\n\t\t\t\tDebug.Text( 'SubView resize triggered', 'BaseViewController.js', 'BaseViewController', 'setGridSize', 10 );\n\t\t\t\tif ( sub_view_grid_autosize && sub_view_grid_autosize === true ) {\n\n\t\t\t\t\tvar length = this.grid.getRecordCount();\n\n\t\t\t\t\tvar cell_height = this.grid.grid.find( 'tr:last td:first' ).height();\n\t\t\t\t\tif ( cell_height < 18 ) {\n\t\t\t\t\t\tcell_height = 22;\n\t\t\t\t\t}\n\t\t\t\t\tvar height;\n\t\t\t\t\tif ( length == 0 ) {\n\t\t\t\t\t\theight = 1; //lower bound\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( length > 10 ) {\n\t\t\t\t\t\t\theight = 10 * cell_height; //upper bound\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\theight = length * cell_height;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( height < 100 ) {\n\t\t\t\t\t\theight += 32;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar edit_view_height = this.grid.grid.parents( '.edit-view-tab-outside-sub-view' ).height();\n\t\t\t\t\tif ( pager_data && pager_data.last_page_number > 1 ) {\n\t\t\t\t\t\theight = ( edit_view_height - header_size - 56 );\n\t\t\t\t\t} else {\n\t\t\t\t\t\theight = ( edit_view_height - header_size - 22 ); //fixing wage inset in employee edit view\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar offset = this.getDefaultHeightOffset();\n\n\t\t\t\theight = this.grid.grid.parents( '#contentContainer' ).height() - offset;\n\t\t\t\tDebug.Text( 'NEW GRID HEIGHT: this.grid.grid.parents(\\'.view\\').height() - offset: (' + this.grid.grid.parents( '.view' ).height() + ' - ' + offset + ') ' + ( this.grid.grid.parents( '.view' ).height() - offset ), 'BaseViewController.js', 'BaseViewController', 'setGridSize', 10 );\n\t\t\t}\n\t\t}\n\n\t\t//if ( $('.grid-top-border:visible').length > 0 && this.grid.width() > $('.grid-top-border:visible').width() ) {\n\t\t// if ( this.grid.parents('.ui-jqgrid-bdiv').width() < this.grid.parents('.ui-jqgrid-bdiv')[0].scrollWidth ) {\n\t\t// \theight -= 15;\n\t\t// }\n\n\t\tthis.grid.grid.setGridHeight( height );\n\n\t\t//this looks odd, but css does not have a has selector.\n\t\t$( '.sub-view .bottom-div:has(.paging-2-div:visible)' ).css( 'height', '20px' );\n\t\t$( '.sub-view .bottom-div:has(.paging-2-div:hidden)' ).css( 'height', 'auto' );\n\t\t//this.reloadGrid(); //slows down awesomeboxes\n\t}\n\n\tgetDefaultHeightOffset() {\n\t\t//protect against NaNs\n\n\t\tvar offset = this.grid.grid.parents( '.ui-jqgrid-jquery-ui' ).find( '.ui-jqgrid-hbox' ).height() - 22; // 22 is default cell height. we just want the overage here.\n\t\tDebug.Text( 'Initial offset: ' + offset, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\n\t\t//getting these selectors right for every grid was a lot of trial and error.\n\t\tif ( this.grid.grid.parents( '.ui-jqgrid-bdiv' ).width() > this.grid.grid.parents( '.ui-jqgrid-jquery-ui' ).width() ) {\n\t\t\toffset += 15; //scrollbar offset\n\t\t\tDebug.Text( 'Scrollbar offset detected: 15', 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tif ( this.search_panel && this.search_panel.is( ':visible' ) == true ) {\n\t\t\toffset += this.search_panel.height();\n\t\t\tDebug.Text( 'Search panel detected: ' + this.search_panel.height(), 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar total_number_div_height = ( $( '.total-number-div:visible' ).length > 0 ) ? $( '.total-number-div:visible' ).height() : 0;\n\t\tif ( total_number_div_height || total_number_div_height === 0 ) {\n\t\t\toffset += total_number_div_height;\n\t\t\tDebug.Text( 'Total number DIV height offset detected: ' + $( '.total-number-div:visible' ).height(), 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar footer_height = $( '.bottom-div' ).height() + 5;\n\t\tif ( footer_height || footer_height === 0 ) {\n\t\t\toffset += footer_height;\n\t\t\tDebug.Text( 'Footer height offset detected: ' + footer_height, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\tvar red_border_height = $( '.grid-top-border' ).height() * 2;\n\t\tif ( red_border_height || red_border_height === 0 ) {\n\t\t\toffset += red_border_height;\n\t\t\tDebug.Text( 'Red border height offset detected: ' + red_border_height, 'BaseViewController.js', 'BaseViewController', 'getDefaultHeightOffset', 10 );\n\t\t}\n\n\t\treturn offset;\n\t}\n\n}\n\n//Don't check the file for now. Too many issues\n/* jshint ignore:end */\n\nBaseViewController.loadView = function( view_id ) {\n\tGlobal.loadViewSource( view_id, view_id + 'View.html', function( result ) {\n\t\tvar args = {};\n\t\tswitch ( view_id ) {\n\t\t\tcase 'TimeSheet':\n\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'View.css' );\n\t\t\t\targs = {\n\t\t\t\t\taccumulated_time: $.i18n._( 'Accumulated Time' ),\n\t\t\t\t\tverify: $.i18n._( 'Verify' ),\n\t\t\t\t\ttimesheet_verification: $.i18n._( 'TimeSheet Verification' )\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'Login':\n\t\t\t\t$( 'body' ).addClass( 'login-bg' );\n\t\t\t\t$( 'body' ).removeClass( 'application-bg' );\n\t\t\t\t// Global.loadViewSource( view_id, view_id + 'View.css' ); // #2833 Login CSS was being loaded twice. Now only loaded in the index.php file for speed.\n\t\t\t\targs = {\n\t\t\t\t\tsecure_login: $.i18n._( 'Secure Login' ),\n\t\t\t\t\tuser_name: $.i18n._( 'User Name' ),\n\t\t\t\t\tpassword: $.i18n._( 'Password' ),\n\t\t\t\t\tforgot_your_password: $.i18n._( 'Forgot Your Password' ),\n\t\t\t\t\tquick_punch: $.i18n._( 'Quick Punch' ),\n\t\t\t\t\tlogin: $.i18n._( 'Login' ),\n\t\t\t\t\tlanguage: $.i18n._( 'Language' )\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'PortalJobVacancyDetail':\n\t\t\t\targs = {\n\t\t\t\t\tsearch_label: $.i18n._( 'Search' )\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'PortalJobVacancy':\n\t\t\t\targs = {\n\t\t\t\t\tsearch_label: $.i18n._( 'Search' ),\n\t\t\t\t\tload_more: $.i18n._( 'Loading' ) + '...'\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'MyJobApplication':\n\t\t\tcase 'MyProfile':\n\t\t\t\tbreak;\n\t\t\tcase 'Schedule':\n\t\t\t\tGlobal.loadViewSource( view_id, view_id + 'View.css' );\n\t\t\t\tbreak;\n\t\t}\n\t\tIndexViewController.instance.router.removeCurrentView();\n\t\tvar template = _.template( result );\n\t\tGlobal.contentContainer().html( template( args ) );\n\t\tLocalCacheData.current_open_view_id = view_id;\n\t\tGlobal.trackView( view_id, LocalCacheData.current_doing_context_action );\n\t} );\n\n};\n\nBaseViewController.default_layout_name = $.i18n._( '-- Default --' );\n"],"sourceRoot":""}